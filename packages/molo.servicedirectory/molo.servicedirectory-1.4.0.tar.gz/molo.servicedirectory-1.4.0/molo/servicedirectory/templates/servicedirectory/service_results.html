{% extends 'servicedirectory/content_base.html' %}

{% block inner_content %}

    <form action="{% url 'service-results' %}" method="get" class="sd-search-form">

        <input type="text" name="search" value="{{ search_term }}" />
        <input type="submit" value="Search" />

        <input type="hidden" name="location" value="{{ location_term }}" />
        <input type="hidden" name="place_id" value="{{ place_id }}" />

        {% if place_latlng %}
        <input type="hidden" name="place_latlng" value="{{ place_latlng }}">
        {% endif %}

        {% if place_formatted_address %}
        <input type="hidden" name="place_formatted_address" value="{{ place_formatted_address }}">
        {% endif %}

    </form>

    <span class="sd-location">
        {{ place_formatted_address }} <a href="{{ change_location_url }}">Change area</a>
    </span>
    <br/>

    <span class="sd-num-results">{{ search_results | length }} Services</span>
    <br/>

    <hr/>

    {% for service in search_results %}

        <a href="{% url 'service-detail' service.id %}">
            <h1 class="sd-heading svc-org-name">
                {{ service.name }} - {{ service.organisation.name }}
            </h1>
        </a>

        <p class="sd-service-keywords">
            {{ service.keywords|join:", " }}
        </p>

        <p class="sd-service-location">
            {{ service.organisation.address }} | {{ service.distance }}
        </p>

        <hr/>

    {% empty %}

        <div class="sd-no-search-results">
            <p>
                We couldn't find any services for <strong>"{{ search_term }}"</strong>
            </p>
            <p>
                Try one of the following things:
                <ul>
                    <li>
                        Check your spelling
                    </li>
                    <li>
                        <a href="{% url 'home' %}">Search for something else</a>
                    </li>
                    <li>
                        Search a category:
                        {% for category in categories_keywords %}
                            <a href="{% url 'service-results' %}?search={{ category.name }}&location={{ location_term }}&place_id={{ place_id }}{% if place_latlng %}&place_latlng={{ place_latlng }}{% endif %}{% if place_formatted_address %}&place_formatted_address={{ place_formatted_address }}{% endif %}">
                                {{ category.name }}
                            </a>{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    </li>
                </ul>
            </p>
        </div>

    {% endfor %}

{% endblock %}
