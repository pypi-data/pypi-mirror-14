{% extends "_layout.html" %}
{% set active_page = 'income_statement' %}

{% block content %}
    <h1>Income Statement</h1>
    {% set income = api.balances(options['name_income']) %}
    {% set expenses = api.balances(options['name_expenses']) %}

    {% set income_monthly_totals = api.interval_totals('month', options['name_income']) %}
    {% set expenses_monthly_totals = api.interval_totals('month', options['name_expenses']) %}
    {% set ie_totals = api.interval_totals('month', [options['name_income'], options['name_expenses']]) %}

    {% include "charts/_chart_skeleton.html" %}

    {% with label="Monthly changes (Income/Expenses)", monthly_totals=ie_totals %}
        {% include "charts/_chart_monthly_totals.html" %}
    {% endwith %}

    {% with label="Monthly income", monthly_totals=income_monthly_totals %}
        {% include "charts/_chart_monthly_totals.html" %}
    {% endwith %}

    {% with label="Monthly expenses", monthly_totals=expenses_monthly_totals %}
        {% include "charts/_chart_monthly_totals.html" %}
    {% endwith %}

    {% with label="Income", rows=income, modifier=-1 %}
        {% include "charts/_chart_treemap.html" %}
    {% endwith %}

    {% with label="Expenses", rows=expenses %}
        {% include "charts/_chart_treemap.html" %}
    {% endwith %}

    <div class="halfleft">
        {% with table_title="Income", table_data=income, totals=True %}
            {% include "_tree_table.html" %}
        {% endwith %}
    </div>
    <div class="halfright">
        {% with table_title="Expenses", table_data=expenses, totals=True %}
            {% include "_tree_table.html" %}
        {% endwith %}
    </div>
{% endblock %}
