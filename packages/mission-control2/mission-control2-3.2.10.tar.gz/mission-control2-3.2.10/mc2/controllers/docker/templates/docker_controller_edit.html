{% extends "skins/base.html" %}
 {% load i18n admin_urls admin_static %}

{% block navbar %}
<ul class="nav" id="main-menu-left">
<li><a href="{% url 'home' %}">Home</a></li>
<li class="active"><a href="#">New</a></li>
</ul>
{% endblock %}

{% block script %}
    <script type="text/javascript">
      $(function() {
          $(".inline.env").formset({
              prefix: "env",
              addCssClass: "add-row btn btn-primary",
              deleteCssClass: "delete-row btn btn-danger btn-xs",
          })
      })
      $(function() {
          $(".inline.label").formset({
              prefix: "label",
              addCssClass: "add-row btn btn-primary",
              deleteCssClass: "delete-row btn btn-danger btn-xs",
          })
      })

    </script>
{% endblock %}

{% block content %}
<div class="row">
<div class="col-md-6">
  <!-- general form elements -->
  <div class="box box-primary">
    <div class="box-header with-border">
      <h3 class="box-title">Edit your app</h3>
    </div>

    <form role="form" method="POST">
    {% with form=form.controller_form %}
    <div class="box-body">
      {% if form.errors %}
          <div class="alert alert-error">
              Please correct the errors below
          </div>
      {% endif %}
      {% if form.non_field_errors %}
          <div class="alert alert-error">
              {{ form.non_field_errors|join:", " }}
          </div>
      {% endif %}

      {% include "form_field.html" with field=form.name %}
      {% include "form_field.html" with field=form.domain_urls %}
      {% include "form_field.html" with field=form.docker_image %}
      <div class="row">
      <div class="col-xs-3">
      {% include "form_field.html" with field=form.port %}
      </div>
      </div>

      {% include "form_field.html" with field=form.volume_needed %}
      {% include "form_field.html" with field=form.volume_path %}

      {% endwith %}

      <fieldset class="input-xxlarge" id="env-variables">
        <legend>Environment Variables</legend>
          {{ form.env_formset.management_form }}
          {{ form.non_form_errors }}
          {% for form in form.env_formset %}
              {{ form.id }}
              <div class="row inline env">
                  <div class="col-xs-4">
                  {% include "form_field.html" with field=form.key %}
                  </div>
                  <div class="col-xs-4">
                  {% include "form_field.html" with field=form.value %}
                  </div>
              </div>
          {% endfor %}
      </fieldset>

      <fieldset class="input-xxlarge" id="label-variables">
        <legend>Application Labels</legend>
          {{ form.label_formset.management_form }}
          {{ form.non_form_errors }}
          {% for form in form.label_formset %}
              {{ form.id }}
              <div class="row inline label">
                  <div class="col-xs-4">
                  {% include "form_field.html" with field=form.name %}
                  </div>
                  <div class="col-xs-4">
                  {% include "form_field.html" with field=form.value %}
                  </div>
              </div>
          {% endfor %}
      </fieldset>


      {% with form=form.controller_form %}
      <fieldset class="input-xxlarge">
          <legend>Marathon</legend>
          {% include "form_field.html" with field=form.marathon_cmd %}
          <div class="row">
          <div class="col-xs-3">
          {% include "form_field.html" with field=form.marathon_cpus %}
          </div>
          <div class="col-xs-3">
          {% include "form_field.html" with field=form.marathon_mem %}
          </div>
          <div class="col-xs-4">
          {% include "form_field.html" with field=form.marathon_instances %}
          </div>
          </div>
          <div class="row">
          <div class="col-xs-6">
          {% include "form_field.html" with field=form.marathon_health_check_path %}
          </div>
          </div>
      </fieldset>
      {% endwith %}

      {% csrf_token %}
      <br/>
      <p><input type="submit" value="Submit" class="btn btn-primary"/></p>
      </div>
    </form>

  </div>
</div>
</div>
{% endblock %}
