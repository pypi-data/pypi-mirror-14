{% extends 'template.html' %}

{% set styles=['sidebar'] %}



{% block content %}

{% include 'sidebar.html' %}

<div id='update' class='column-left'>
    <h2>Update</h2>
    
    
    <p id='pub-date'>Accessing PyPI's JSON API...</p>
    
    <p id='current-version'></p>
    </br>
    <div id='python-img' style='text-align:center'>
        <img src={{url_for('static',filename='img/python.png')}}>
    </div>


</div>
{% endblock %}



{% block scripts %}
<script src='{{ url_for("static", filename="js/jquery.min.js") }}'></script>
<script type='text/javascript'>
// Grab the publishing date of the latest release from GitHub's API and log it to the console:

String.prototype.format = function() {
    var s = this,
        i = arguments.length;
    while (i--) {s = s.replace(new RegExp('\\{' + i + '\\}', 'gm'), arguments[i]);}
    return s;
};

$.getJSON('https://pypi.python.org/pypi/SCRY/json', function(data) {
    var ver = data['info']['version'];
    var pub = data['releases'][ver][0]['upload_time'].split('T');
    $('#pub-date')[0].innerText = "SCRY's latest release (v{0}) was uploaded to PyPI on {1} at {2}.".format(ver, pub[0], pub[1]);
    if (ver == '{{version}}') {
    $('#current-version')[0].innerHTML = 'Your version is up to date!';
    } else {
    $('#current-version')[0].innerHTML = 'You are currently running version {{version}}. Click the image below to update.';
    $('#python-img')[0].innerHTML = '<form action="update" method="post"><input type="image" src="{{url_for('static',filename='img/python.png')}}" alt="Update!" /></form>';
    } ;
})
</script>
{% endblock %}