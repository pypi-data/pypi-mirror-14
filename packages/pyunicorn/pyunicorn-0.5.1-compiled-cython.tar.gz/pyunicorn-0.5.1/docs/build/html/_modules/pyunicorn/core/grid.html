<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyunicorn.core.grid &mdash; pyunicorn 0.5.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.5.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyunicorn 0.5.1 documentation" href="../../../sitemap.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../../index.html"><img src="../../../_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../sitemap.html">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../sitemap.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../methods.html">Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_doc.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contact.html">Contact</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pyunicorn.core.grid</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c">#</span>
<span class="c"># This file is part of pyunicorn.</span>
<span class="c"># Copyright (C) 2008--2015 Jonathan F. Donges and pyunicorn authors</span>
<span class="c"># URL: &lt;http://www.pik-potsdam.de/members/donges/software&gt;</span>
<span class="c"># License: BSD (3-clause)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Provides classes for analyzing spatially embedded complex networks, handling</span>
<span class="sd">multivariate data and generating time series surrogates.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c">#</span>
<span class="c">#  Import essential packages</span>
<span class="c">#</span>

<span class="c">#  Import cPickle for loading and saving Python objects</span>
<span class="kn">import</span> <span class="nn">cPickle</span>

<span class="c">#  array object and fast numerics</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># Import package to calculate points inside a polygon</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">path</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;An error occurred when importing matplotlib.path! </span><span class="se">\</span>
<span class="s">Some functionality in Grid class might not be available.&quot;</span>

<span class="c">#  C++ inline code</span>
<span class="kn">from</span> <span class="nn">.network</span> <span class="kn">import</span> <span class="n">weave_inline</span>


<span class="c">#</span>
<span class="c">#  Define class Grid</span>
<span class="c">#</span>

<div class="viewcode-block" id="Grid"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid">[docs]</a><span class="k">class</span> <span class="nc">Grid</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encapsulates a horizontal spatio-temporal grid on the sphere.</span>

<span class="sd">    The spatial grid points can be arbitrarily distributed, which is useful</span>
<span class="sd">    for representing station data or geodesic grids.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#</span>
    <span class="c">#  Definitions of internal methods</span>
    <span class="c">#</span>

<div class="viewcode-block" id="Grid.__init__"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_seq</span><span class="p">,</span> <span class="n">lat_seq</span><span class="p">,</span> <span class="n">lon_seq</span><span class="p">,</span> <span class="n">silence_level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an instance of Grid.</span>

<span class="sd">        :type time_seq: 1D Numpy array [time]</span>
<span class="sd">        :arg time_seq: The increasing sequence of temporal sampling points.</span>

<span class="sd">        :type lat_seq: 1D Numpy array [index]</span>
<span class="sd">        :arg lat_seq: The sequence of latitudinal sampling points.</span>

<span class="sd">        :type lon_seq: 1D Numpy array [index]</span>
<span class="sd">        :arg lon_seq: The sequence of longitudinal sampling points.</span>

<span class="sd">        :type silence_level: number (int)</span>
<span class="sd">        :arg silence_level: The inverse level of verbosity of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#  Set basic dictionaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;time&quot;</span><span class="p">:</span> <span class="n">time_seq</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&quot;float32&quot;</span><span class="p">),</span>
                      <span class="s">&quot;lat&quot;</span><span class="p">:</span> <span class="n">lat_seq</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&quot;float32&quot;</span><span class="p">),</span>
                      <span class="s">&quot;lon&quot;</span><span class="p">:</span> <span class="n">lon_seq</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&quot;float32&quot;</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid_size</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;time&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_seq</span><span class="p">),</span>
                           <span class="s">&quot;space&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">lat_seq</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;time_min&quot;</span><span class="p">:</span> <span class="n">time_seq</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                            <span class="s">&quot;time_max&quot;</span><span class="p">:</span> <span class="n">time_seq</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                            <span class="s">&quot;lat_min&quot;</span><span class="p">:</span> <span class="n">lat_seq</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                            <span class="s">&quot;lat_max&quot;</span><span class="p">:</span> <span class="n">lat_seq</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                            <span class="s">&quot;lon_min&quot;</span><span class="p">:</span> <span class="n">lon_seq</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                            <span class="s">&quot;lon_max&quot;</span><span class="p">:</span> <span class="n">lon_seq</span><span class="o">.</span><span class="n">max</span><span class="p">()}</span>

        <span class="c">#  Set silence level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">silence_level</span> <span class="o">=</span> <span class="n">silence_level</span>
        <span class="sd">&quot;&quot;&quot;(number (int)) - The inverse level of verbosity of the object.&quot;&quot;&quot;</span>

        <span class="c">#  Defines the number of spatial grid points / nodes at one instant</span>
        <span class="c">#  of time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid_size</span><span class="p">[</span><span class="s">&quot;space&quot;</span><span class="p">]</span>
        <span class="sd">&quot;&quot;&quot;(number (int)) - The number of spatial grid points / nodes.&quot;&quot;&quot;</span>

        <span class="c">#  Defines the total number of data points / grid points / samples of</span>
        <span class="c">#  the corresponding data set.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_grid_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid_size</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
        <span class="sd">&quot;&quot;&quot;(number (int)) - The total number of data points / samples.&quot;&quot;&quot;</span>

        <span class="c">#  Cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_angular_distance</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_angular_distance_cached</span> <span class="o">=</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="Grid.__str__"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a string representation of the Grid object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s">&#39;Grid: </span><span class="si">%i</span><span class="s"> grid points, </span><span class="si">%i</span><span class="s"> timesteps.&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid_size</span><span class="p">[</span><span class="s">&#39;space&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid_size</span><span class="p">[</span><span class="s">&#39;time&#39;</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Grid.clear_cache"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.clear_cache">[docs]</a>    <span class="k">def</span> <span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clean up cache.</span>

<span class="sd">        Is reversible, since all cached information can be recalculated from</span>
<span class="sd">        basic data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angular_distance_cached</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angular_distance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_angular_distance_cached</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c">#</span>
    <span class="c">#  Functions for loading and saving the Grid object</span>
    <span class="c">#</span>
</div>
<div class="viewcode-block" id="Grid.save"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the Grid object to a cPickle file.</span>

<span class="sd">        :arg str filename: The name of the file where Grid object is stored</span>
<span class="sd">            (including ending).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">cPickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;An error occurred while saving Grid instance to </span><span class="se">\</span>
<span class="s">                   cPickle file&quot;</span><span class="p">,</span> <span class="n">filename</span>
</div>
<div class="viewcode-block" id="Grid.save_txt"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.save_txt">[docs]</a>    <span class="k">def</span> <span class="nf">save_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the Grid object to text files.</span>

<span class="sd">        The latitude, longitude and time sequences are stored in three separate</span>
<span class="sd">        text files.</span>

<span class="sd">        :arg str filename: The name of the files where Grid object is stored</span>
<span class="sd">            (excluding ending).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#  Gather sequences</span>
        <span class="n">lat_seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_sequence</span><span class="p">()</span>
        <span class="n">lon_seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_sequence</span><span class="p">()</span>
        <span class="n">time_seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">()[</span><span class="s">&quot;time&quot;</span><span class="p">]</span>

        <span class="c">#  Store as text files</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_lat.txt&quot;</span><span class="p">,</span> <span class="n">lat_seq</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_lon.txt&quot;</span><span class="p">,</span> <span class="n">lon_seq</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_time.txt&quot;</span><span class="p">,</span> <span class="n">time_seq</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;An error occurred while saving Grid instance to </span><span class="se">\</span>
<span class="s">text files&quot;</span><span class="p">,</span> <span class="n">filename</span>
</div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="Grid.Load"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.Load">[docs]</a>    <span class="k">def</span> <span class="nf">Load</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a Grid object stored in a cPickle file.</span>

<span class="sd">        :arg str filename: The name of the file where Grid object is stored</span>
<span class="sd">            (including ending).</span>
<span class="sd">        :rtype: Grid object</span>
<span class="sd">        :return: :class:`Grid` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">grid</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;An error occurred while loading Grid instance from </span><span class="se">\</span>
<span class="s">cPickle file&quot;</span><span class="p">,</span> <span class="n">filename</span>
</div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="Grid.LoadTXT"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.LoadTXT">[docs]</a>    <span class="k">def</span> <span class="nf">LoadTXT</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a Grid object stored in text files.</span>

<span class="sd">        The latitude, longitude and time sequences are loaded from three</span>
<span class="sd">        separate text files.</span>

<span class="sd">        :arg str filename: The name of the files where Grid object is stored</span>
<span class="sd">            (excluding endings).</span>
<span class="sd">        :rtype: Grid object</span>
<span class="sd">        :return: :class:`Grid` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lat_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_lat.txt&quot;</span><span class="p">)</span>
            <span class="n">lon_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_lon.txt&quot;</span><span class="p">)</span>
            <span class="n">time_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_time.txt&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;An error occurred while loading Grid instance from </span><span class="se">\</span>
<span class="s">text files&quot;</span><span class="p">,</span> <span class="n">filename</span>

        <span class="k">return</span> <span class="n">Grid</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">lat_seq</span><span class="p">,</span> <span class="n">lon_seq</span><span class="p">)</span>

    <span class="c">#</span>
    <span class="c">#  Alternative constructors and Grid generation methods</span>
    <span class="c">#</span>
</div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="Grid.SmallTestGrid"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.SmallTestGrid">[docs]</a>    <span class="k">def</span> <span class="nf">SmallTestGrid</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return test grid of 6 spatial grid points with 10 temporal sampling</span>
<span class="sd">        points each.</span>

<span class="sd">        :rtype: Grid instance</span>
<span class="sd">        :return: a Grid instance for testing purposes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Grid</span><span class="p">(</span><span class="n">time_seq</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                    <span class="n">lat_seq</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">]),</span>
                    <span class="n">lon_seq</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mf">15.</span><span class="p">]),</span>
                    <span class="n">silence_level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="Grid.RegularGrid"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.RegularGrid">[docs]</a>    <span class="k">def</span> <span class="nf">RegularGrid</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">lat_grid</span><span class="p">,</span> <span class="n">lon_grid</span><span class="p">,</span> <span class="n">silence_level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an instance of a regular grid.</span>

<span class="sd">        **Examples:**</span>

<span class="sd">        &gt;&gt;&gt; Grid.RegularGrid(</span>
<span class="sd">        ...     time_seq=np.arange(2), lat_grid=np.array([0.,5.]),</span>
<span class="sd">        ...     lon_grid=np.array([1.,2.]), silence_level=2).lat_sequence()</span>
<span class="sd">        array([ 0.,  0.,  5.,  5.], dtype=float32)</span>
<span class="sd">        &gt;&gt;&gt; Grid.RegularGrid(</span>
<span class="sd">        ...     time_seq=np.arange(2), lat_grid=np.array([0.,5.]),</span>
<span class="sd">        ...     lon_grid=np.array([1.,2.]), silence_level=2).lon_sequence()</span>
<span class="sd">        array([ 1.,  2.,  1.,  2.], dtype=float32)</span>

<span class="sd">        :type time_seq: 1D Numpy array [time]</span>
<span class="sd">        :arg time_seq: The increasing sequence of temporal sampling points.</span>

<span class="sd">        :type lat_grid: 1D Numpy array [n_lat]</span>
<span class="sd">        :arg lat_grid: The latitudinal grid.</span>

<span class="sd">        :type lon_grid: 1D Numpy array [n_lon]</span>
<span class="sd">        :arg lon_grid: The longitudinal grid.</span>

<span class="sd">        :type silence_level: number (int)</span>
<span class="sd">        :arg silence_level: The inverse level of verbosity of the object.</span>

<span class="sd">        :rtype: Grid object</span>
<span class="sd">        :return: :class:`Grid` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#  Generate sequence of latitudes and longitudes for all nodes</span>
        <span class="n">lat_seq</span><span class="p">,</span> <span class="n">lon_seq</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">coord_sequence_from_rect_grid</span><span class="p">(</span><span class="n">lat_grid</span><span class="p">,</span>
                                                              <span class="n">lon_grid</span><span class="p">)</span>

        <span class="c">#  Return instance of Grid</span>
        <span class="k">return</span> <span class="n">Grid</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">lat_seq</span><span class="p">,</span> <span class="n">lon_seq</span><span class="p">,</span> <span class="n">silence_level</span><span class="p">)</span>

    <span class="c">#</span>
    <span class="c">#  Definitions of grid related functions</span>
    <span class="c">#</span>
</div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="Grid.coord_sequence_from_rect_grid"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.coord_sequence_from_rect_grid">[docs]</a>    <span class="k">def</span> <span class="nf">coord_sequence_from_rect_grid</span><span class="p">(</span><span class="n">lat_grid</span><span class="p">,</span> <span class="n">lon_grid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the sequences of latitude and longitude for a regular and</span>
<span class="sd">        rectangular grid.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; Grid.coord_sequence_from_rect_grid(</span>
<span class="sd">        ...     lat_grid=np.array([0.,5.]), lon_grid=np.array([1.,2.]))</span>
<span class="sd">        (array([ 0.,  0.,  5.,  5.]), array([ 1.,  2.,  1.,  2.]))</span>

<span class="sd">        :type lat_grid: 1D Numpy array [lat]</span>
<span class="sd">        :arg lat_grid: The grid&#39;s latitudinal sampling points.</span>

<span class="sd">        :type lon_grid: 1D Numpy array [lon]</span>
<span class="sd">        :arg lon_grid: The grid&#39;s longitudinal sampling points.</span>

<span class="sd">        :rtype: tuple of two 1D Numpy arrays [index]</span>
<span class="sd">        :return: the coordinates of all nodes in the grid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#  Get grid size</span>
        <span class="n">n_lat</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lat_grid</span><span class="p">)</span>
        <span class="n">n_lon</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lon_grid</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n_lat</span> <span class="o">*</span> <span class="n">n_lon</span>

        <span class="c">#  Initialize sequences</span>
        <span class="n">lat_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">lon_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n_lat</span><span class="p">):</span>
            <span class="n">lat_seq</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">n_lon</span><span class="p">:(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n_lon</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_lon</span><span class="p">)</span>
            <span class="n">lon_seq</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">n_lon</span><span class="p">:(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n_lon</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon_grid</span>

        <span class="c">#  Return results as a tuple</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">lat_seq</span><span class="p">,</span> <span class="n">lon_seq</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Grid.lat_sequence"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.lat_sequence">[docs]</a>    <span class="k">def</span> <span class="nf">lat_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the sequence of latitudes for all nodes.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; Grid.SmallTestGrid().lat_sequence()</span>
<span class="sd">        array([  0.,   5.,  10.,  15.,  20.,  25.], dtype=float32)</span>

<span class="sd">        :rtype: 1D Numpy array [index]</span>
<span class="sd">        :return: the sequence of latitudes for all nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="s">&quot;lat&quot;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Grid.lon_sequence"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.lon_sequence">[docs]</a>    <span class="k">def</span> <span class="nf">lon_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the sequence of longitudes for all nodes.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; Grid.SmallTestGrid().lon_sequence()</span>
<span class="sd">        array([  2.5,   5. ,   7.5,  10. ,  12.5,  15. ], dtype=float32)</span>

<span class="sd">        :rtype: 1D Numpy array [index]</span>
<span class="sd">        :return: the sequence of longitudes for all nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="s">&quot;lon&quot;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Grid.convert_lon_coordinates"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.convert_lon_coordinates">[docs]</a>    <span class="k">def</span> <span class="nf">convert_lon_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lon_seq</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return longitude coordinates in the system</span>
<span class="sd">        -180 deg W &lt;= lon &lt;= +180 deg O for all nodes.</span>

<span class="sd">        Accepts longitude coordinates in the system 0 deg &lt;= lon &lt;= 360 deg.</span>
<span class="sd">        0 deg corresponds to Greenwich, England.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; Grid.SmallTestGrid().convert_lon_coordinates(</span>
<span class="sd">        ...     np.array([10.,350.,20.,340.,170.,190.]))</span>
<span class="sd">        array([  10.,  -10.,   20.,  -20.,  170., -170.])</span>

<span class="sd">        :type lon_seq: 1D Numpy array [index]</span>
<span class="sd">        :arg lon_seq: Sequence of longitude coordinates.</span>

<span class="sd">        :rtype: 1D Numpy array [index]</span>
<span class="sd">        :return: the converted longitude coordinates for all nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_lon_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">lon_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">180.</span><span class="p">:</span>
                <span class="n">new_lon_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">360.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_lon_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">new_lon_grid</span>
</div>
<div class="viewcode-block" id="Grid.node_coordinates"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.node_coordinates">[docs]</a>    <span class="k">def</span> <span class="nf">node_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the geographical latitude and longitude of node ``index``.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; Grid.SmallTestGrid().node_coordinates(3)</span>
<span class="sd">        (15.0, 10.0)</span>

<span class="sd">        :type index: number (int)</span>
<span class="sd">        :arg index: The node index as used in node sequences.</span>

<span class="sd">        :rtype: tuple of number (float)</span>
<span class="sd">        :return: the node&#39;s latitude and longitude coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lat_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_sequence</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">lon_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_sequence</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">lat_node</span><span class="p">,</span> <span class="n">lon_node</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Grid.node_number"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.node_number">[docs]</a>    <span class="k">def</span> <span class="nf">node_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat_node</span><span class="p">,</span> <span class="n">lon_node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the index of the closest node given geographical coordinates.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; Grid.SmallTestGrid().node_number(lat_node=14., lon_node=9.)</span>
<span class="sd">        3</span>

<span class="sd">        :type lat_node: number (float)</span>
<span class="sd">        :arg lat_node: The latitude coordinate.</span>

<span class="sd">        :type lon_node: number (float)</span>
<span class="sd">        :arg lon_node: The longitude coordinate.</span>

<span class="sd">        :rtype: number (int)</span>
<span class="sd">        :return: the closest node&#39;s index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#  Get sequences of cosLat, sinLat, cosLon and sinLon for all nodes</span>
        <span class="n">cos_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cos_lat</span><span class="p">()</span>
        <span class="n">sin_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sin_lat</span><span class="p">()</span>
        <span class="n">cos_lon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cos_lon</span><span class="p">()</span>
        <span class="n">sin_lon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sin_lon</span><span class="p">()</span>

        <span class="n">sin_lat_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat_node</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
        <span class="n">cos_lat_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_node</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
        <span class="n">sin_lon_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lon_node</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
        <span class="n">cos_lon_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lon_node</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

        <span class="c">#  Calculate angular distance from the given coordinate to all</span>
        <span class="c">#  other nodes</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="n">sin_lat</span><span class="o">*</span><span class="n">sin_lat_v</span> <span class="o">+</span> <span class="n">cos_lat</span><span class="o">*</span><span class="n">cos_lat_v</span> <span class="o">*</span> <span class="p">(</span><span class="n">sin_lon</span><span class="o">*</span><span class="n">sin_lon_v</span>
                                                        <span class="o">+</span> <span class="n">cos_lon</span><span class="o">*</span><span class="n">cos_lon_v</span><span class="p">)</span>

        <span class="c">#  Correct for rounding errors</span>
        <span class="n">expr</span><span class="p">[</span><span class="n">expr</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
        <span class="n">expr</span><span class="p">[</span><span class="n">expr</span> <span class="o">&gt;</span> <span class="mf">1.</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

        <span class="n">angdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

        <span class="c">#  Get index of closest node</span>
        <span class="n">n_node</span> <span class="o">=</span> <span class="n">angdist</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">n_node</span>
</div>
<div class="viewcode-block" id="Grid.cos_lat"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.cos_lat">[docs]</a>    <span class="k">def</span> <span class="nf">cos_lat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the sequence of cosines of latitude for all nodes.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; r(Grid.SmallTestGrid().cos_lat()[:2])</span>
<span class="sd">        array([ 1. , 0.9962])</span>

<span class="sd">        :rtype: 1D Numpy array [index]</span>
<span class="sd">        :return: the cosine of latitudes for all nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_sequence</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Grid.sin_lat"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.sin_lat">[docs]</a>    <span class="k">def</span> <span class="nf">sin_lat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the sequence of sines of latitude for all nodes.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; r(Grid.SmallTestGrid().sin_lat()[:2])</span>
<span class="sd">        array([ 0. , 0.0872])</span>

<span class="sd">        :rtype: 1D Numpy array [index]</span>
<span class="sd">        :return: the sine of latitudes for all nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_sequence</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Grid.cos_lon"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.cos_lon">[docs]</a>    <span class="k">def</span> <span class="nf">cos_lon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the sequence of cosines of longitude for all nodes.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; r(Grid.SmallTestGrid().cos_lon()[:2])</span>
<span class="sd">        array([ 0.999 , 0.9962])</span>

<span class="sd">        :rtype: 1D Numpy array [index]</span>
<span class="sd">        :return: the cosine of longitudes for all nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_sequence</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Grid.sin_lon"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.sin_lon">[docs]</a>    <span class="k">def</span> <span class="nf">sin_lon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the sequence of sines of longitude for all nodes.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; r(Grid.SmallTestGrid().sin_lon()[:2])</span>
<span class="sd">        array([ 0.0436, 0.0872])</span>

<span class="sd">        :rtype: 1D Numpy array [index]</span>
<span class="sd">        :return: the sine of longitudes for all nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_sequence</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Grid._calculate_angular_distance"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid._calculate_angular_distance">[docs]</a>    <span class="k">def</span> <span class="nf">_calculate_angular_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate and return the angular great circle distance matrix.</span>

<span class="sd">        **No normalization applied anymore!** Return values are in the range</span>
<span class="sd">        0 to Pi.</span>

<span class="sd">        :rtype: 2D Numpy array [index, index]</span>
<span class="sd">        :return: the angular great circle distance matrix (unit radians).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">silence_level</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Calculating angular great circle distance using Weave...&quot;</span>

        <span class="c">#  Get number of nodes</span>
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>

        <span class="c">#  Get sequences of cosLat, sinLat, cosLon and sinLon for all nodes</span>
        <span class="n">cos_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cos_lat</span><span class="p">()</span>
        <span class="n">sin_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sin_lat</span><span class="p">()</span>
        <span class="n">cos_lon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cos_lon</span><span class="p">()</span>
        <span class="n">sin_lon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sin_lon</span><span class="p">()</span>

        <span class="c">#  Initialize weave angular distance matrix</span>
        <span class="n">weave_angdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&quot;float32&quot;</span><span class="p">)</span>

        <span class="n">code</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">        float expr;</span>

<span class="s">        for (int i = 0; i &lt; N; i++) {</span>
<span class="s">            for (int j = 0; j &lt;= i; j++) {</span>
<span class="s">                expr = sin_lat(i)*sin_lat(j) + cos_lat(i)*cos_lat(j)</span>
<span class="s">                       * (sin_lon(i)*sin_lon(j) + cos_lon(i)*cos_lon(j));</span>

<span class="s">                if (expr &gt; 1) {</span>
<span class="s">                    expr = 1.;</span>
<span class="s">                }</span>
<span class="s">                else if (expr &lt; -1) {</span>
<span class="s">                    expr = -1.;</span>
<span class="s">                }</span>
<span class="s">                weave_angdist(i,j) = weave_angdist(j,i) = acos(expr);</span>
<span class="s">            }</span>
<span class="s">        }</span>
<span class="s">        &quot;&quot;&quot;</span>
        <span class="n">weave_inline</span><span class="p">(</span><span class="nb">locals</span><span class="p">(),</span> <span class="n">code</span><span class="p">,</span>
                     <span class="p">[</span><span class="s">&#39;cos_lat&#39;</span><span class="p">,</span> <span class="s">&#39;sin_lat&#39;</span><span class="p">,</span> <span class="s">&#39;cos_lon&#39;</span><span class="p">,</span> <span class="s">&#39;sin_lon&#39;</span><span class="p">,</span>
                      <span class="s">&#39;weave_angdist&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">weave_angdist</span>
</div>
<div class="viewcode-block" id="Grid.angular_distance"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.angular_distance">[docs]</a>    <span class="k">def</span> <span class="nf">angular_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the angular great circle distance matrix.</span>

<span class="sd">        **No normalization applied anymore!** Return values are in the range</span>
<span class="sd">        0 to Pi.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; rr(Grid.SmallTestGrid().angular_distance())</span>
<span class="sd">        [[&#39;0&#39;      &#39;0.0975&#39; &#39;0.1949&#39; &#39;0.292&#39;  &#39;0.3887&#39; &#39;0.4847&#39;]</span>
<span class="sd">         [&#39;0.0975&#39; &#39;0&#39;      &#39;0.0974&#39; &#39;0.1945&#39; &#39;0.2911&#39; &#39;0.3872&#39;]</span>
<span class="sd">         [&#39;0.1949&#39; &#39;0.0974&#39; &#39;0.0003&#39; &#39;0.0971&#39; &#39;0.1938&#39; &#39;0.2898&#39;]</span>
<span class="sd">         [&#39;0.292&#39;  &#39;0.1945&#39; &#39;0.0971&#39; &#39;0.0005&#39; &#39;0.0967&#39; &#39;0.1928&#39;]</span>
<span class="sd">         [&#39;0.3887&#39; &#39;0.2911&#39; &#39;0.1938&#39; &#39;0.0967&#39; &#39;0&#39;      &#39;0.0961&#39;]</span>
<span class="sd">         [&#39;0.4847&#39; &#39;0.3872&#39; &#39;0.2898&#39; &#39;0.1928&#39; &#39;0.0961&#39; &#39;0.0005&#39;]]</span>

<span class="sd">        :rtype: 2D Numpy array [index, index]</span>
<span class="sd">        :return: the angular great circle distance matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angular_distance_cached</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_angular_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_angular_distance</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_angular_distance_cached</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angular_distance</span>
</div>
<div class="viewcode-block" id="Grid.euclidean_distance"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.euclidean_distance">[docs]</a>    <span class="k">def</span> <span class="nf">euclidean_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the euclidean distance matrix between grid points.</span>

<span class="sd">        So far assumes that the given latitude and longitude coordinates are</span>
<span class="sd">        planar, euclidean coordinates. Approximates great circle distance well</span>
<span class="sd">        for points with a separation much smaller than the Earth&#39;s radius.</span>

<span class="sd">        :rtype: 2D Numpy array [index, index]</span>
<span class="sd">        :return: the euclidean distance matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#  Get number of nodes</span>
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>

        <span class="c">#  Get sequences of coordinates</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_sequence</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_sequence</span><span class="p">()</span>

        <span class="c">#  Initialize distance matrix</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&quot;float32&quot;</span><span class="p">)</span>

        <span class="n">code</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">        float expr;</span>

<span class="s">        for (int i = 0; i &lt; N; i++) {</span>
<span class="s">            for (int j = 0; j &lt;= i; j++) {</span>
<span class="s">                expr = pow(x(i) - x(j), 2) + pow(y(i) - y(j), 2);</span>
<span class="s">                distance(i,j) = distance(j,i) = sqrt(expr);</span>
<span class="s">            }</span>
<span class="s">        }</span>
<span class="s">        &quot;&quot;&quot;</span>
        <span class="n">weave_inline</span><span class="p">(</span><span class="nb">locals</span><span class="p">(),</span> <span class="n">code</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;distance&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">distance</span>
</div>
<div class="viewcode-block" id="Grid.boundaries"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.boundaries">[docs]</a>    <span class="k">def</span> <span class="nf">boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the spatio-temporal grid boundaries.</span>

<span class="sd">        Structure of the returned dictionary:</span>
<span class="sd">          - self._boundaries = {&quot;time_min&quot;: time_seq.min(),</span>
<span class="sd">                                &quot;time_max&quot;: time_seq.max(),</span>
<span class="sd">                                &quot;lat_min&quot;: lat_seq.min(),</span>
<span class="sd">                                &quot;lat_max&quot;: lat_seq.max(),</span>
<span class="sd">                                &quot;lon_min&quot;: lon_seq.min(),</span>
<span class="sd">                                &quot;lon_max&quot;: lon_seq.max()}</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; print Grid.SmallTestGrid().print_boundaries()</span>
<span class="sd">                 time     lat     lon</span>
<span class="sd">           min    0.0    0.00    2.50</span>
<span class="sd">           max    9.0   25.00   15.00</span>

<span class="sd">        :rtype: dictionary</span>
<span class="sd">        :return: the spatio-temporal grid boundaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span>
</div>
<div class="viewcode-block" id="Grid.print_boundaries"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.print_boundaries">[docs]</a>    <span class="k">def</span> <span class="nf">print_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pretty print the spatio-temporal grid boundaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="s">&quot;         time     lat     lon&quot;</span> <span class="o">+</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="s">   min {time_min:6.1f} {lat_min: 7.2f} {lon_min: 7.2f}&quot;</span> <span class="o">+</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="s">   max {time_max:6.1f} {lat_max: 7.2f} {lon_max: 7.2f}&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="Grid.grid"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.grid">[docs]</a>    <span class="k">def</span> <span class="nf">grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the grid&#39;s spatio-temporal sampling points.</span>

<span class="sd">        Structure of the returned dictionary:</span>
<span class="sd">          - self._grid = {&quot;time&quot;: time_seq.astype(&quot;float32&quot;),</span>
<span class="sd">                          &quot;lat&quot;: lat_seq.astype(&quot;float32&quot;),</span>
<span class="sd">                          &quot;lon&quot;: lon_seq.astype(&quot;float32&quot;)}</span>

<span class="sd">        **Examples:**</span>

<span class="sd">        &gt;&gt;&gt; Grid.SmallTestGrid().grid()[&quot;lat&quot;]</span>
<span class="sd">        array([  0.,   5.,  10.,  15.,  20.,  25.], dtype=float32)</span>
<span class="sd">        &gt;&gt;&gt; Grid.SmallTestGrid().grid()[&quot;lon&quot;][5]</span>
<span class="sd">        15.0</span>

<span class="sd">        :rtype: dictionary</span>
<span class="sd">        :return: the grid&#39;s spatio-temporal sampling points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span>
</div>
<div class="viewcode-block" id="Grid.grid_size"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.grid_size">[docs]</a>    <span class="k">def</span> <span class="nf">grid_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the sizes of the grid&#39;s spatial and temporal dimensions.</span>

<span class="sd">        Structure of the returned dictionary:</span>
<span class="sd">          - self._grid_size = {&quot;time&quot;: len(time_seq),</span>
<span class="sd">                               &quot;space&quot;: len(lat_seq)}</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; print Grid.SmallTestGrid().print_grid_size()</span>
<span class="sd">           space    time</span>
<span class="sd">               6      10</span>

<span class="sd">        :rtype: dictionary</span>
<span class="sd">        :return: the sizes of the grid&#39;s spatial and temporal dimensions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid_size</span>
</div>
<div class="viewcode-block" id="Grid.print_grid_size"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.print_grid_size">[docs]</a>    <span class="k">def</span> <span class="nf">print_grid_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pretty print the sizes of the grid&#39;s spatial and temporal dimensions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s">&quot;     space    time</span><span class="se">\n</span><span class="s">   {space:7} {time:7}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_size</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="Grid.geometric_distance_distribution"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.geometric_distance_distribution">[docs]</a>    <span class="k">def</span> <span class="nf">geometric_distance_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the distribution of angular great circle distances between all</span>
<span class="sd">        pairs of grid points.</span>

<span class="sd">        **Examples:**</span>

<span class="sd">        &gt;&gt;&gt; r(Grid.SmallTestGrid().geometric_distance_distribution(3)[0])</span>
<span class="sd">        array([ 0.3333, 0.4667, 0.2 ])</span>
<span class="sd">        &gt;&gt;&gt; r(Grid.SmallTestGrid().geometric_distance_distribution(3)[1])</span>
<span class="sd">        array([ 0. , 0.1616, 0.3231, 0.4847])</span>

<span class="sd">        :type n_bins: number (int)</span>
<span class="sd">        :arg n_bins: The number of histogram bins.</span>

<span class="sd">        :rtype: tuple of two 1D Numpy arrays [bin]</span>
<span class="sd">        :return: the normalized histogram and lower bin boundaries of angular</span>
<span class="sd">                 great circle distances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">silence_level</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Calculating the geometric distance distribution of the </span><span class="se">\</span>
<span class="s">grid...&quot;</span>

        <span class="c">#  Get angular distance matrix</span>
        <span class="n">D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angular_distance</span><span class="p">()</span>

        <span class="c">#  Determine range for link distance histograms</span>
        <span class="n">max_range</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_range</span><span class="p">)</span>

        <span class="c">#  Calculate geometry related factor of distributions to divide it out</span>
        <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">lbb</span><span class="p">)</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">n_bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
        <span class="c">#  Subtract self.N from first bin because of spurious links with zero</span>
        <span class="c">#  distance on the diagonal of the angular distance matrix</span>
        <span class="n">dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>

        <span class="c">#  Normalize distribution</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&quot;float&quot;</span><span class="p">)</span>
        <span class="n">dist</span> <span class="o">/=</span> <span class="n">dist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">lbb</span><span class="p">)</span>

    <span class="c">#</span>
    <span class="c">#  Methods for selecting regions</span>
    <span class="c">#</span>
</div>
<div class="viewcode-block" id="Grid.region_indices"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.region_indices">[docs]</a>    <span class="k">def</span> <span class="nf">region_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a boolean array of nodes with True values when the node</span>
<span class="sd">        is inside the region.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; Grid.SmallTestGrid().region_indices(</span>
<span class="sd">        ...     np.array([0.,0.,0.,11.,11.,11.,11.,0.]))</span>
<span class="sd">        array([False,  True,  True, False, False, False], dtype=bool)</span>

<span class="sd">        :type region: 1D Numpy array [n_polygon_nodes]</span>
<span class="sd">        :arg region: array of lon, lat, lon, lat, ...</span>
<span class="sd">                     [-80.2, 5., -82.4, 5.3, ...] as copied from Google Earth</span>
<span class="sd">                     Polygon file</span>
<span class="sd">        :rtype: 1D bool array [index]</span>
<span class="sd">        :return: bool array with True for nodes inside region</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Reshape Google Earth array  into (n,2) array</span>
        <span class="n">remapped_region</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">region</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c"># Remap from East-West to 360 degree map if the longitudes are [0, 360]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="s">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">remapped_region</span><span class="p">[</span><span class="n">remapped_region</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> \
                <span class="mi">360</span> <span class="o">+</span> <span class="n">remapped_region</span><span class="p">[</span><span class="n">remapped_region</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">lat_lon_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="s">&quot;lon&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="s">&quot;lat&quot;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">remapped_region</span><span class="p">)</span><span class="o">.</span><span class="n">contains_points</span><span class="p">(</span><span class="n">lat_lon_map</span><span class="p">)</span>
</div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="Grid.region"><a class="viewcode-back" href="../../../api/core/grid.html#pyunicorn.core.grid.Grid.region">[docs]</a>    <span class="k">def</span> <span class="nf">region</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return some standard regions.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&#39;ENSO&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">79.28273150749884</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.49311965331937</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">79.29849791038734</span><span class="p">,</span> <span class="mf">10.12527300655218</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">174.9221853596061</span><span class="p">,</span> <span class="mf">10.07293121423917</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">174.8362810586096</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.46407198776264</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">80.13229308153623</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.36724072894785</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">79.28273150749884</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.49311965331937</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&#39;NINO34&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">118.6402427933005</span><span class="p">,</span> <span class="mf">7.019906838300821</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">171.0067408177714</span><span class="p">,</span> <span class="mf">6.215022481004243</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">171.0364908514962</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.768616252424354</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">119.245702264066</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.836385150138187</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">118.6402427933005</span><span class="p">,</span> <span class="mf">7.019906838300821</span><span class="p">])</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2008-2015, Jonathan F. Donges and pyunicorn authors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>