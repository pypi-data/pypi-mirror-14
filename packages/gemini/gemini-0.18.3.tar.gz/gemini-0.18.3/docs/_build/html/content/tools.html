<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Built-in analysis tools &mdash; gemini 0.18.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/labibi.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.18.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/gemini.png"/>
    <link rel="top" title="gemini 0.18.1 documentation" href="../index.html" />
    <link rel="next" title="The GEMINI browser interface" href="browser.html" />
    <link rel="prev" title="Querying the GEMINI database" href="querying.html" />


<script src="../_static/labibi.js"></script>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', '']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="browser.html" title="The GEMINI browser interface"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="querying.html" title="Querying the GEMINI database"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">gemini v0.18.1</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
  <div class="section" id="built-in-analysis-tools">
<h1>Built-in analysis tools<a class="headerlink" href="#built-in-analysis-tools" title="Permalink to this headline">¶</a></h1>
<p>As of version 0.14, the tools have a standardized output that is different
from previous versions.
Requested <cite>&#8211;columns</cite> will come first followed by a standard set of columns:</p>
<blockquote>
<div><ul class="simple">
<li>variant_id - unique id from the databse</li>
<li>family_id - family id for this row</li>
<li>family_members - which family members were tested</li>
<li>family_genotypes - genotypes of this family</li>
<li>samples - samples contributing to this row appearing in the results</li>
<li>family_count - number of families with this effect</li>
</ul>
</div></blockquote>
<p>Other tools such as <cite>mendel_errors</cite> additional columns at the end.</p>
<p>When queries are limited to variants in genes, the output will be in
<cite>gene</cite>, <cite>chrom</cite> order as opposed to the usual <cite>gene</cite>, <cite>position</cite> order.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>As of version 0.16.0, the inheritance tools (autosomal_dominant,
autosomal_recessive, comp_het, mendel_errors, de_novo) are now
more strict by default.</p>
<p>A &#8211;lenient flag allows, e.g. allows some samples to be of unknown
phenotype or to not have both parents of known phenotype.</p>
<p>The &#8211;allow-unaffected flag will result in reporting variants where
unaffected samples share the same variants. The default will only
report variants that are unique to affected samples.</p>
<p class="last">The design decisions for this change are described here:
<a class="reference external" href="https://github.com/arq5x/gemini/issues/388">https://github.com/arq5x/gemini/issues/388</a>
a visual representation is here:
<a class="reference external" href="https://github.com/arq5x/gemini/blob/master/inheritance.ipynb">https://github.com/arq5x/gemini/blob/master/inheritance.ipynb</a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Candidate variants reported by the built-in inheritance model tools
will appear in order by chromosome, then alphabetically by gene.
In other words, they will not be in strict positional order for each chromosome.
This is in an effort to group all candidate variants by gene since the gene
is typically the atomic unit of interest.</p>
<p class="last">Additionally, all current built-in tools (autosomal_dominant, comp_hets, and autosomal_recessive) only analyze autosomal (non sex chromosome) variants. Analysis of X- and Y-linked phenotypes must be done manually with <cite>&#8211;gt-filter</cite></p>
</div>
<div class="section" id="common-args-common-arguments">
<h2><code class="docutils literal"><span class="pre">common_args</span></code>: common arguments<a class="headerlink" href="#common-args-common-arguments" title="Permalink to this headline">¶</a></h2>
<p>The inheritance tools share a common set of arguments. We will
describe them here and refer to them in the corresponding sections:</p>
<div class="section" id="columns">
<h3><code class="docutils literal"><span class="pre">--columns</span></code><a class="headerlink" href="#columns" title="Permalink to this headline">¶</a></h3>
<p>This flag is followed by a comma-delimited list of columns the user is
requestin in the output.</p>
</div>
<div class="section" id="min-kindreds-1">
<h3><code class="docutils literal"><span class="pre">--min-kindreds</span> <span class="pre">1</span></code><a class="headerlink" href="#min-kindreds-1" title="Permalink to this headline">¶</a></h3>
<p>This is the number of families required to have a variant in the same gene
in order for it to be reported. For example, we may only be interested in
candidates where at least 4 families have a variant in that gene.</p>
</div>
<div class="section" id="families">
<h3><code class="docutils literal"><span class="pre">--families</span></code><a class="headerlink" href="#families" title="Permalink to this headline">¶</a></h3>
<p>By default, candidate variants are reported for all families in the database.
One can restrict the analysis to variants in specific familes with the
<code class="docutils literal"><span class="pre">--families</span></code> option.  Families should be provided as a comma-separated list</p>
</div>
<div class="section" id="filter">
<h3><code class="docutils literal"><span class="pre">--filter</span></code><a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h3>
<p>By default, each tool will report all variants regardless of their putative
functional impact. In order to apply additional constraints on the variants
returned, one can use the <code class="docutils literal"><span class="pre">--filter</span></code> option. Using SQL syntax, conditions
applied with the <code class="docutils literal"><span class="pre">--filter</span></code> options become WHERE clauses in the query issued to
the GEMINI database.</p>
</div>
<div class="section" id="d-0-depth">
<h3><code class="docutils literal"><span class="pre">-d</span> <span class="pre">[0]</span></code> (depth)<a class="headerlink" href="#d-0-depth" title="Permalink to this headline">¶</a></h3>
<p>Filter variants that do not have at least this depth for all members in a
a family. Default is 0.</p>
</div>
<div class="section" id="min-gq-0">
<h3><code class="docutils literal"><span class="pre">--min-gq</span> <span class="pre">[0]</span></code><a class="headerlink" href="#min-gq-0" title="Permalink to this headline">¶</a></h3>
<p>Filter variants that do not have at least this genotype quality for each sample in a family.
Default is 0. Higher values are more stringent.</p>
</div>
<div class="section" id="allow-unaffected">
<h3><code class="docutils literal"><span class="pre">--allow-unaffected</span></code><a class="headerlink" href="#allow-unaffected" title="Permalink to this headline">¶</a></h3>
<p>By default, candidates that also appear in unaffected samples are not reported
if this flag is specified, such variants will be reported.</p>
</div>
<div class="section" id="lenient">
<h3><code class="docutils literal"><span class="pre">--lenient</span></code><a class="headerlink" href="#lenient" title="Permalink to this headline">¶</a></h3>
<p>Loosen the restrictions on family structure. This will allow, for example,
finding compound_hets in unaffected samples.</p>
</div>
<div class="section" id="gt-pl-max">
<h3><code class="docutils literal"><span class="pre">--gt-pl-max</span></code><a class="headerlink" href="#gt-pl-max" title="Permalink to this headline">¶</a></h3>
<p>In order to eliminate less confident genotypes, it is possible to enforce a maximum PL value
for each sample. On this scale, lower values indicate more confidence that the called genotype
is correct. 10 is a reasonable value. This is applied per-family such that all
members of a family must meet this level in order to by reported in the final
results.</p>
</div>
</div>
<div class="section" id="comp-hets-identifying-potential-compound-heterozygotes">
<h2><code class="docutils literal"><span class="pre">comp_hets</span></code>: Identifying potential compound heterozygotes<a class="headerlink" href="#comp-hets-identifying-potential-compound-heterozygotes" title="Permalink to this headline">¶</a></h2>
<p>Many autosomal recessive disorders are caused by compound heterozygotes. Unlike canonical
recessive sites where the same recessive allele is inherited from both parents
at the _same_ site in the gene, compound heterozygotes occur when
the individual&#8217;s phenotype is caused by two heterozygous recessive alleles at
_different_ sites in a particular gene.</p>
<p>We are looking for two (typically loss-of-function (LoF))
heterozygous variants impacting the same gene at different loci.  The
complicating factor is that this is _recessive_ and as such, we must also
require that the consequential alleles at each heterozygous site were
inherited on different chromosomes (one from each parent).
Where possible, <cite>comp_hets</cite> will phase by transmission. Once this has been
done, the <cite>comp_hets</cite> tool will provide a report of candidate compound
heterozygotes for each sample/gene.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>As of version 0.16.0 the <code class="docutils literal"><span class="pre">comp_het</span></code> tool will perform family-based phasing
by default in order to provide better candidates even in the absence of
unphased genotypes. Any candidate that could be one element of a comp_het
will also be phaseable as long as the parents and their genotypes are known.</p>
<p>As of version 0.16.1, the &#8211;ignore-phasing option is removed and there is no
&#8211;lenient option.</p>
<p class="last">In 0.16.2, a &#8211;pattern-only flag was added to find compound hets by inheritance
pattern without regard to affection status. A priority code was also added where
variants with priority 1 are much more informative. See docs below for further
information.</p>
</div>
<div class="section" id="genotype-requirements">
<h3>Genotype Requirements<a class="headerlink" href="#genotype-requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>All affected individuals must be heterozygous at both sites.</li>
<li>No unaffected can be homozygous alterate at either site.</li>
<li>If any unphased-unaffected is het at both sites, the site will be give lower priority</li>
<li>No phased-unaffected can be heterozygous at both sites.<ol class="loweralpha">
<li><cite>&#8211;allow-unaffected</cite> keeps sites where a phased unaffected shares the het-pair</li>
<li>unphased, unaffected that share the het pair are counted and reported for each candidate pair.</li>
</ol>
</li>
<li>Remove candidates where an affected from the same family does NOT share the same het pair.</li>
<li>Sites are automatically phased by transmission when parents are present in order to remove false positive candidates.<ol class="loweralpha">
<li>If data from one or both parents are unavailable and the child&#8217;s data was not phased prior to loading into GEMINI,
all comp_het variant pairs will automatically be given priority == 2</li>
<li><cite>&#8211;max-priority x</cite> can be used to set the maximum allowed priority level at which candidate pairs are included in the output.</li>
</ol>
</li>
</ul>
<p>we prioritize with these rules:</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="4%" />
<col width="5%" />
<col width="12%" />
<col width="11%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">mom</th>
<th class="head">dad</th>
<th class="head">kid</th>
<th class="head">phaseable</th>
<th class="head">priority</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R-H</td>
<td>H-R</td>
<td>H-H</td>
<td>both</td>
<td>1</td>
<td>both sites phaseable and alts on opposite chroms</td>
</tr>
<tr class="row-odd"><td>n/a</td>
<td>n/a</td>
<td>H-H</td>
<td>NO</td>
<td>2</td>
<td>singleton (unphaseable) HETs have priority 2.</td>
</tr>
<tr class="row-even"><td>R-H</td>
<td>H-H</td>
<td>H-H</td>
<td>one</td>
<td>3</td>
<td>should be a rare occurrence</td>
</tr>
<tr class="row-odd"><td>H-H</td>
<td>H-H</td>
<td>H-H</td>
<td>NO</td>
<td>3</td>
<td>should be a rare occurrence</td>
</tr>
<tr class="row-even"><td>A-R</td>
<td>H-H</td>
<td>H-H</td>
<td>both</td>
<td>NA</td>
<td>exclude hom-alts from un-affecteds</td>
</tr>
<tr class="row-odd"><td>R-R</td>
<td>H-H</td>
<td>H-H</td>
<td>both</td>
<td>NA</td>
<td>phaseable, but alts are on the same chroms.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">candidates of priority == 3 are very unlikely (&lt; 1%) to be causal for a rare Mendelian condition
(see: <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3734130/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3734130/</a>); we report them
for completeness, but strongly recommend using priority 1 and 2 only.
Priority 2 is useful when there are multiple families, some of which consist of
only a single sequenced, affected sample.</p>
</div>
</div>
<div class="section" id="pattern-only">
<h3>Pattern Only<a class="headerlink" href="#pattern-only" title="Permalink to this headline">¶</a></h3>
<p>To find compound heterozygotes by inheritance pattern only, without regard to affections, the
following rules are used (with &#8211;pattern-only):</p>
<ul class="simple">
<li>Kid must be HET at both sites.</li>
<li>Kid must have alts on different chromosomes.</li>
<li>Neither parent can be HOM_ALT at either site.</li>
<li>If either parent is phased at both sites and matches the kid, it&#8217;s excluded.</li>
<li>If either parent is HET at both sites, priority is reduced.</li>
<li>When the above criteria are met, and both parents and kid are phased or parents are HET at different sites, the priority is 1.</li>
<li>If both parents are not phased, the priority is 2.</li>
<li>For every parent that&#8217;s a het at both sites, the priority is incremented by 1.</li>
<li>The priority in a family is the minimum found among all kids.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Each pair of consecutive lines in the output represent the two variants
for a compound heterozygote in a give sample.  The third column,
<cite>comp_het_id</cite>, tracks the distinct compound heterozygote variant pairs.</p>
</div>
<p>Example usage with a subset of columns:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini comp_hets my.db --columns <span class="s2">&quot;chrom, start, end&quot;</span> test.comp_het_default.2.db
chrom   start   end gene    alt variant_id  family_id   family_members  family_genotypes    samples family_count    comp_het_id
chr1    <span class="m">17362</span>   <span class="m">17366</span>   WASH7P  T   <span class="m">1</span>   <span class="m">3</span>   dad_3<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,mom_3<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,child_3<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> TTCT<span class="p">|</span>T,TTCT<span class="p">|</span>TTCT,TTCT<span class="p">|</span>T child_3 <span class="m">2</span>   1
chr1    <span class="m">17729</span>   <span class="m">17730</span>   WASH7P  A   <span class="m">2</span>   <span class="m">3</span>   dad_3<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,mom_3<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,child_3<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> C<span class="p">|</span>A,C<span class="p">|</span>A,A<span class="p">|</span>C child_3 <span class="m">2</span>   1
chr1    <span class="m">17362</span>   <span class="m">17366</span>   WASH7P  T   <span class="m">1</span>   <span class="m">4</span>   dad_4<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,mom_4<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,child_4<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> TTCT<span class="p">|</span>T,TTCT<span class="p">|</span>TTCT,TTCT<span class="p">|</span>T child_4 <span class="m">2</span>   1
chr1    <span class="m">17729</span>   <span class="m">17730</span>   WASH7P  A   <span class="m">2</span>   <span class="m">4</span>   dad_4<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,mom_4<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,child_4<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> C<span class="p">|</span>A,C<span class="p">|</span>A,A<span class="p">|</span>C child_4 <span class="m">2</span>   1
</pre></div>
</div>
<p>This indicates that samples child_3 and child_4 have a candidate compound heterozygotes in WASH.</p>
<p>the following command would further restrict candidate genes to those genes with a compound heterozygote in at least two families:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini comp_hets -d <span class="m">50</span> <span class="se">\</span>
      --columns <span class="s2">&quot;chrom, start, end, ref, alt&quot;</span> <span class="se">\</span>
      --filter <span class="s2">&quot;impact_severity = &#39;HIGH&#39;&quot;</span> <span class="se">\</span>
      --allow-unaffected <span class="se">\</span>
      --min-kindreds <span class="m">2</span> <span class="se">\</span>
      my.db
</pre></div>
</div>
<p>Now, this does not require that the family members are necessarily restricted to solely
those that are affected. To impose this restriction, we remove the <code class="docutils literal"><span class="pre">--allow-unaffected</span></code>
flag</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini comp_hets -d <span class="m">50</span> <span class="se">\</span>
      --columns <span class="s2">&quot;chrom, start, end, ref, alt&quot;</span> <span class="se">\</span>
      --filter <span class="s2">&quot;impact_severity = &#39;HIGH&#39;&quot;</span> <span class="se">\</span>
      --min-kindreds <span class="m">2</span> <span class="se">\</span>
      my.db
</pre></div>
</div>
<p>We may also specify the families of interest:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini comp_hets --families <span class="m">1</span> my.db
<span class="nv">$ </span>gemini comp_hets --families 1,7 my.db
</pre></div>
</div>
</div>
</div>
<div class="section" id="mendelian-error-identify-non-mendelian-transmission">
<h2><code class="docutils literal"><span class="pre">mendelian_error</span></code>: Identify non-mendelian transmission.<a class="headerlink" href="#mendelian-error-identify-non-mendelian-transmission" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This tool requires that you identify familial relationships via a PED file
when loading your VCF into gemini via:</p>
<p class="last"><code class="docutils literal"><span class="pre">gemini</span> <span class="pre">load</span> <span class="pre">-v</span> <span class="pre">my.vcf</span> <span class="pre">-p</span> <span class="pre">my.ped</span> <span class="pre">my.db</span></code></p>
</div>
<p>We can query for mendelian errors in trios including:</p>
<ul class="simple">
<li>loss of heterozygosity</li>
<li>implausible de-novo mutations</li>
<li>de-novo mutations</li>
<li>uniparental disomy</li>
</ul>
<div class="section" id="id1">
<h3>Genotype Requirements<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>(LOH) kind and one parent are opposite homozygotes; other parent is HET</li>
<li>(uniparental disomy) parents are opposite homozygotes; kid is homozygote;</li>
<li>(plausible de novo) kid is het. parents are same homozygotes</li>
<li>(implausible de novo) kid is homozygoes. parents are same homozygotes and opposite to kid.</li>
</ul>
<p>If allow <cite>&#8211;only-affected</cite> is used, then the tools will only consider samples that have parents
<strong>and</strong> are affected. The default is to consider any sample with parents.</p>
<p>This tool will report the probability of a mendelian error in the final column
that is derived from the genotype likelihoods if they are available.</p>
<p>Example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini mendel_errors --columns <span class="s2">&quot;chrom,start,end&quot;</span> test.mendel.db --gt-pl-max 1
chrom       start   end     variant_id      family_id       family_members  family_genotypes        samples family_count    violation       violation_prob
chr1        <span class="m">10670</span>   <span class="m">10671</span>   <span class="m">1</span>       CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        G/G,G/G,G/C     NA12877 <span class="m">1</span>       plausible de novo       0.962
chr1        <span class="m">28493</span>   <span class="m">28494</span>   <span class="m">2</span>       CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        T/C,T/T,C/C     NA12877 <span class="m">1</span>       loss of heterozygosity  0.660
chr1        <span class="m">28627</span>   <span class="m">28628</span>   <span class="m">3</span>       CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        C/C,C/C,C/T     NA12877 <span class="m">1</span>       plausible de novo       0.989
chr1        <span class="m">267558</span>  <span class="m">267560</span>  <span class="m">5</span>       CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        C/C,C/C,CT/C    NA12877 <span class="m">1</span>       plausible de novo       0.896
chr1        <span class="m">537969</span>  <span class="m">537970</span>  <span class="m">7</span>       CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        C/C,C/C,C/T     NA12877 <span class="m">1</span>       plausible de novo       0.928
chr1        <span class="m">547518</span>  <span class="m">547519</span>  <span class="m">11</span>      CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        G/G,G/G,G/T     NA12877 <span class="m">1</span>       plausible de novo       1.000
chr1        <span class="m">589081</span>  <span class="m">589086</span>  <span class="m">14</span>      CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        G/G,GAGAA/GAGAA,G/G     NA12877 <span class="m">1</span>       uniparental disomy      0.940
chr1        <span class="m">749688</span>  <span class="m">749689</span>  <span class="m">16</span>      CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        T/T,T/T,G/G     NA12877 <span class="m">1</span>       implausible de novo     0.959
chr1        <span class="m">788944</span>  <span class="m">788945</span>  <span class="m">17</span>      CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        C/C,G/G,G/G     NA12877 <span class="m">1</span>       uniparental disomy      0.914
chr1        <span class="m">1004248</span> <span class="m">1004249</span> <span class="m">22</span>      CEPH1463        NA12889<span class="o">(</span>dad<span class="p">;</span>unknown<span class="o">)</span>,NA12890<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,NA12877<span class="o">(</span>child<span class="p">;</span>unknown<span class="o">)</span>        G/G,G/G,G/C     NA12877 <span class="m">1</span>       plausible de novo       1.000
</pre></div>
</div>
<p>Where, here, we have required the called genotype to have at most a PL of 1 (lower is more confident).
Note that the &#8220;violation&#8221; column indicates the type of mendelian error and the final column can be used for further filtering,
with higher numbers indicating a greater probability of mendelian error. We have found &gt; 0.99 to be a reasonable
cutoff.</p>
<p>Arguments are similar to the other tools:</p>
<div class="highlight-bash"><div class="highlight"><pre>positional arguments:
  db                    The name of the database to be queried.

optional arguments:
  -h, --help            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  --columns STRING      A list of columns that you would like returned. Def. <span class="o">=</span>
                        <span class="s2">&quot;*&quot;</span>
  --filter STRING       Restrictions to apply to variants <span class="o">(</span>SQL syntax<span class="o">)</span>
  --min-kindreds MIN_KINDREDS
                        The min. number of kindreds that must have a candidate
                        variant in a gene.
  --families FAMILIES   Restrict analysis to a specific <span class="nb">set </span>of <span class="m">1</span> or more
                        <span class="o">(</span>comma<span class="o">)</span> separated<span class="o">)</span> families
  -d MIN_SAMPLE_DEPTH   The minimum aligned sequence depth required <span class="k">for</span>
                        each sample in a family <span class="o">(</span><span class="nv">default</span> <span class="o">=</span> 0<span class="o">)</span>
  --gt-pl-max GT_PHRED_LL
                        The maximum phred-scaled genotype likelihod <span class="o">(</span>PL<span class="o">)</span>
                        allowed <span class="k">for</span> each sample in a family.
  --allow-unaffected    consider candidates that also appear in unaffected samples.
</pre></div>
</div>
</div>
</div>
<div class="section" id="de-novo-identifying-potential-de-novo-mutations">
<h2><code class="docutils literal"><span class="pre">de_novo</span></code>: Identifying potential de novo mutations.<a class="headerlink" href="#de-novo-identifying-potential-de-novo-mutations" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>1. This tool requires that you identify familial relationships via a PED file
when loading your VCF into gemini via:</p>
<p class="last"><code class="docutils literal"><span class="pre">gemini</span> <span class="pre">load</span> <span class="pre">-v</span> <span class="pre">my.vcf</span> <span class="pre">-p</span> <span class="pre">my.ped</span> <span class="pre">my.db</span></code></p>
</div>
<div class="section" id="id2">
<h3>Genotype Requirements<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>all affecteds must be het</li>
<li>[affected] all unaffected must be homref or homalt</li>
<li>at least 1 affected kid must have unaffected parents</li>
<li>[strict] if an affected has affected parents, it&#8217;s not de_novo</li>
<li>[strict] all affected kids must have unaffected (or no) parents</li>
<li>[strict] warning if none of the affected samples have parents.</li>
</ul>
<p>The last 3 items, prefixed with [strict] can be turned off with <cite>&#8211;lenient</cite></p>
<p>If <cite>&#8211;allow-unaffected</cite> is specified, then the item prefixed [affected] is not
required.</p>
<p><cite>Example PED file format for GEMINI</cite></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#Family_ID      Individual_ID   Paternal_ID     Maternal_ID     Sex     Phenotype       Ethnicity</span>
<span class="m">1</span>       S173    S238    S239    <span class="m">1</span>       <span class="m">2</span>       caucasian
<span class="m">1</span>       S238    -9      -9      <span class="m">1</span>       <span class="m">1</span>       caucasian
<span class="m">1</span>       S239    -9      -9      <span class="m">2</span>       <span class="m">1</span>       caucasian
<span class="m">2</span>       S193    S230    S231    <span class="m">1</span>       <span class="m">2</span>       caucasian
<span class="m">2</span>       S230    -9      -9      <span class="m">1</span>       <span class="m">1</span>       caucasian
<span class="m">2</span>       S231    -9      -9      <span class="m">2</span>       <span class="m">1</span>       caucasian
<span class="m">3</span>       S242    S243    S244    <span class="m">1</span>       <span class="m">2</span>       caucasian
<span class="m">3</span>       S243    -9      -9      <span class="m">1</span>       <span class="m">1</span>       caucasian
<span class="m">3</span>       S244    -9      -9      <span class="m">2</span>       <span class="m">1</span>       caucasian
<span class="m">4</span>       S253    S254    S255    <span class="m">1</span>       <span class="m">2</span>       caucasianNEuropean
<span class="m">4</span>       S254    -9      -9      <span class="m">1</span>       <span class="m">1</span>       caucasianNEuropean
<span class="m">4</span>       S255    -9      -9      <span class="m">2</span>       <span class="m">1</span>       caucasianNEuropean
</pre></div>
</div>
<p>Assuming you have defined the familial relationships between samples when loading
your VCF into GEMINI, one can leverage a built-in tool for identifying de novo
(a.k.a spontaneous) mutations that arise in offspring.</p>
</div>
<div class="section" id="example">
<h3>example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini de_novo --columns <span class="s2">&quot;chrom,start,end&quot;</span> test.de_novo.db
chrom       start   end     variant_id      family_id       family_members  family_genotypes        samples family_count
chr10       <span class="m">1142207</span> <span class="m">1142208</span> <span class="m">1</span>       <span class="m">1</span>       1_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,1_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,1_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/T,T/T,T/C     1_kid   1
chr10       <span class="m">48003991</span>        <span class="m">48003992</span>        <span class="m">2</span>       <span class="m">2</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       C/C,C/C,C/T     2_kid   1
chr10       <span class="m">48004991</span>        <span class="m">48004992</span>        <span class="m">3</span>       <span class="m">3</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       C/C,C/C,C/T     3_kid   1
chr10       <span class="m">135336655</span>       <span class="m">135336656</span>       <span class="m">4</span>       <span class="m">4</span>       1_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,1_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,1_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       G/G,G/G,G/A     1_kid   2
chr10       <span class="m">135336655</span>       <span class="m">135336656</span>       <span class="m">4</span>       <span class="m">4</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       G/G,G/G,G/A     2_kid   2
chr10       <span class="m">135369531</span>       <span class="m">135369532</span>       <span class="m">5</span>       <span class="m">5</span>       1_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,1_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,1_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/T,T/T,T/C     1_kid   3
chr10       <span class="m">135369531</span>       <span class="m">135369532</span>       <span class="m">5</span>       <span class="m">5</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/T,T/T,T/C     2_kid   3
chr10       <span class="m">135369531</span>       <span class="m">135369532</span>       <span class="m">5</span>       <span class="m">5</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/T,T/T,T/C     3_kid   3
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The output will always start with the the requested columns followed by
the 5 columns enumerated at the start of this document.</p>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini de_novo -d <span class="m">50</span> --columns <span class="s2">&quot;chrom,start,end&quot;</span> test.de_novo.db
chrom       start   end     variant_id      family_id       family_members  family_genotypes        samples family_count
chr10       <span class="m">135369531</span>       <span class="m">135369532</span>       <span class="m">5</span>       <span class="m">5</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/T,T/T,T/C     3_kid   1
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3><code class="docutils literal"><span class="pre">example</span></code><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>if we wanted to restrict candidate variants
to solely those with a HIGH predicted functional consequence, we could use the
following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini de_novo <span class="se">\</span>
      --columns <span class="s2">&quot;chrom, start, end, ref, alt&quot;</span> <span class="se">\</span>
      --filter <span class="s2">&quot;impact_severity = &#39;HIGH&#39;&quot;</span> <span class="se">\</span>
      test.de_novo.db
chrom       start   end     ref     alt     variant_id      family_id       family_members  family_genotypes        samples family_count
chr10       <span class="m">1142207</span> <span class="m">1142208</span> T       C       <span class="m">1</span>       <span class="m">1</span>       1_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,1_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,1_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/T,T/T,T/C     1_kid   1
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3><code class="docutils literal"><span class="pre">example</span></code><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>the following command would further restrict candidate genes to those genes with a de novo variant in at least two families:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini de_novo <span class="se">\</span>
      --columns <span class="s2">&quot;chrom, start, end, ref, alt&quot;</span> <span class="se">\</span>
      --filter <span class="s2">&quot;impact_severity = &#39;HIGH&#39;&quot;</span> <span class="se">\</span>
      --min-kindreds <span class="m">2</span> <span class="se">\</span>
      test.de_novo.db
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3><code class="docutils literal"><span class="pre">example</span></code><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>By default, candidate de novo variants are reported for families
in the database.  One can restrict the analysis to variants in
specific familes with the <code class="docutils literal"><span class="pre">--families</span></code> option.  Families should be provided
as a comma-separated list</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini de_novo --families <span class="m">1</span> my.db
<span class="nv">$ </span>gemini de_novo --families 1,7 my.db
</pre></div>
</div>
</div>
</div>
<div class="section" id="autosomal-recessive-find-variants-meeting-an-autosomal-recessive-model">
<h2><code class="docutils literal"><span class="pre">autosomal_recessive</span></code>: Find variants meeting an autosomal recessive model.<a class="headerlink" href="#autosomal-recessive-find-variants-meeting-an-autosomal-recessive-model" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>By default, this tool requires that you identify familial relationships
via a PED file when loading your VCF into GEMINI.  For example:</p>
<p><code class="docutils literal"><span class="pre">gemini</span> <span class="pre">load</span> <span class="pre">-v</span> <span class="pre">my.vcf</span> <span class="pre">-p</span> <span class="pre">my.ped</span> <span class="pre">my.db</span></code></p>
<p class="last">However, in the absence of established parent/child relationships in the PED
file, GEMINI will issue a WARNING, yet will attempt to identify autosomal
recessive candidates for all samples marked as &#8220;affected&#8221;.</p>
</div>
<div class="section" id="id6">
<h3>Genotype Requirements<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>all affecteds must be hom_alt</li>
<li>[affected] no unaffected can be hom_alt (can be unknown)</li>
<li>[strict] if parents exist they must be unaffected and het for all affected kids</li>
<li>[strict] if there are no affecteds that have a parent, a warning is issued.</li>
</ul>
<p>if <cite>&#8211;lenient</cite> is specified, the 2 points prefixed with &#8220;[strict]&#8221; are not required.</p>
<p>if <cite>&#8211;allow-unaffected</cite> is specified, the point prefix with &#8220;[affected]&#8221; is not required.</p>
</div>
<div class="section" id="default-behavior">
<h3><code class="docutils literal"><span class="pre">default</span> <span class="pre">behavior</span></code><a class="headerlink" href="#default-behavior" title="Permalink to this headline">¶</a></h3>
<p>Assuming you have defined the familial relationships between samples when
loading your VCF into GEMINI, one can leverage a built-in tool for
identifying variants that meet an autosomal recessive inheritance pattern.
The reported variants will be restricted to those variants having the
potential to impact the function of affecting protein coding transcripts.</p>
<p>For the following examples, let&#8217;s assume we have a PED file for 3 different
families as follows (the kids are affected in each family, but the parents
are not):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>cat families.ped
<span class="m">1</span>   1_dad   <span class="m">0</span>       <span class="m">0</span>       -1      1
<span class="m">1</span>   1_mom   <span class="m">0</span>       <span class="m">0</span>       -1      1
<span class="m">1</span>   1_kid   1_dad   1_mom   -1      2
<span class="m">2</span>   2_dad   <span class="m">0</span>       <span class="m">0</span>       -1      1
<span class="m">2</span>   2_mom   <span class="m">0</span>       <span class="m">0</span>       -1      1
<span class="m">2</span>   2_kid   2_dad   2_mom   -1      2
<span class="m">3</span>   3_dad   <span class="m">0</span>       <span class="m">0</span>       -1      1
<span class="m">3</span>   3_mom   <span class="m">0</span>       <span class="m">0</span>       -1      1
<span class="m">3</span>   3_kid   3_dad   3_mom   -1      2
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini autosomal_recessive test.auto_rec.db --columns <span class="s2">&quot;chrom,start,end,gene&quot;</span>
chrom       start   end     gene    variant_id      family_id       family_members  family_genotypes        samples family_count
chr10       <span class="m">48003991</span>        <span class="m">48003992</span>        ASAH2C  <span class="m">2</span>       <span class="m">2</span>       1_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,1_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,1_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       C/T,C/T,T/T     1_kid   1
chr10       <span class="m">48004991</span>        <span class="m">48004992</span>        ASAH2C  <span class="m">3</span>       <span class="m">3</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       C/T,C/T,T/T     2_kid   1
chr10       <span class="m">135369531</span>       <span class="m">135369532</span>       SYCE1   <span class="m">5</span>       <span class="m">5</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/C,T/C,C/C     3_kid   1
chr10       <span class="m">1142207</span> <span class="m">1142208</span> WDR37   <span class="m">1</span>       <span class="m">1</span>       1_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,1_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,1_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/C,T/C,C/C     1_kid   2
chr10       <span class="m">1142207</span> <span class="m">1142208</span> WDR37   <span class="m">1</span>       <span class="m">1</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/C,T/C,C/C     2_kid   2
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The output will always start with the requested columns and end with the 5 extra columns
enumerated at the start of this document.</p>
</div>
<p>To restrict the report to genes with variants (doesn&#8217;t have
to be the _same_ variant) observed in at least two kindreds, use the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini autosomal_recessive <span class="se">\</span>
    --columns <span class="s2">&quot;gene, chrom, start, end, ref, alt, impact, impact_severity&quot;</span> <span class="se">\</span>
    --min-kindreds <span class="m">2</span> <span class="se">\</span>
    test.auto_rec.db
gene        chrom   start   end     ref     alt     impact  impact_severity variant_id      family_id       family_members  family_genotypes        samples family_count
ASAH2C      chr10   <span class="m">48003991</span>        <span class="m">48003992</span>        C       T       non_syn_coding  MED     <span class="m">2</span>       <span class="m">2</span>       1_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,1_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,1_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       C/T,C/T,T/T     1_kid   1
ASAH2C      chr10   <span class="m">48004991</span>        <span class="m">48004992</span>        C       T       non_syn_coding  MED     <span class="m">3</span>       <span class="m">3</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       C/T,C/T,T/T     2_kid   1
WDR37       chr10   <span class="m">1142207</span> <span class="m">1142208</span> T       C       stop_loss       HIGH    <span class="m">1</span>       <span class="m">1</span>       1_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,1_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,1_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/C,T/C,C/C     1_kid   2
WDR37       chr10   <span class="m">1142207</span> <span class="m">1142208</span> T       C       stop_loss       HIGH    <span class="m">1</span>       <span class="m">1</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/C,T/C,C/C     2_kid   2
</pre></div>
</div>
<p>to report only those with a HIGH predicted functional consequence, we could use the
following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini autosomal_recessive <span class="se">\</span>
    --columns <span class="s2">&quot;gene, chrom, start, end, ref, alt, impact, impact_severity&quot;</span> <span class="se">\</span>
    --min-kindreds <span class="m">2</span> <span class="se">\</span>
    --filter <span class="s2">&quot;impact_severity = &#39;HIGH&#39;&quot;</span> <span class="se">\</span>
    test.auto_rec.db
gene        chrom   start   end     ref     alt     impact  impact_severity variant_id      family_id       family_members  family_genotypes        samples family_count
WDR37       chr10   <span class="m">1142207</span> <span class="m">1142208</span> T       C       stop_loss       HIGH    <span class="m">1</span>       <span class="m">1</span>       1_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,1_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,1_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/C,T/C,C/C     1_kid   2
WDR37       chr10   <span class="m">1142207</span> <span class="m">1142208</span> T       C       stop_loss       HIGH    <span class="m">1</span>       <span class="m">1</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>unaffected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>       T/C,T/C,C/C     2_kid   2
</pre></div>
</div>
<p>To limit to confidently called genotypes:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini autosomal_dominant <span class="se">\</span>
    --columns <span class="s2">&quot;gene, chrom, start, end, ref, alt, impact, impact_severity&quot;</span> <span class="se">\</span>
    --filter <span class="s2">&quot;impact_severity = &#39;HIGH&#39;&quot;</span> <span class="se">\</span>
    --min-kindreds <span class="m">1</span> <span class="se">\</span>
    --gt-pl-max <span class="m">10</span> <span class="se">\</span>
    my.db
</pre></div>
</div>
</div>
</div>
<div class="section" id="autosomal-dominant-find-variants-meeting-an-autosomal-dominant-model">
<h2><code class="docutils literal"><span class="pre">autosomal_dominant</span></code>: Find variants meeting an autosomal dominant model.<a class="headerlink" href="#autosomal-dominant-find-variants-meeting-an-autosomal-dominant-model" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>0. version 0.16.0 changes the behavior of this tool to be more strict.
To regain more lenient behavior, specify &#8211;lenient and &#8211;allow-unaffected.</p>
<p>By default, this tool requires that you identify familial relationships
via a PED file when loading your VCF into GEMINI.  For example:</p>
<p class="last"><code class="docutils literal"><span class="pre">gemini</span> <span class="pre">load</span> <span class="pre">-v</span> <span class="pre">my.vcf</span> <span class="pre">-p</span> <span class="pre">my.ped</span> <span class="pre">my.db</span></code></p>
</div>
<div class="section" id="id7">
<h3>Genotype Requirements<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>All affecteds must be het</li>
<li>[affected] No unaffected can be het or homalt (can be unknown)</li>
<li>de_novo mutations are not auto_dom (at least not in the first generation)</li>
<li>At least 1 affected must have 1 affected parent (or have no parents).</li>
<li>If no affected has a parent, a warning is issued.</li>
<li>[strict] All affecteds must have parents with known phenotype.</li>
<li>[strict] All affected kids must have at least 1 affected parent</li>
</ul>
<p>If <cite>&#8211;lenient</cite> is specified, the items prefixed with &#8220;[strict]&#8221; are not required.</p>
<p>If <cite>&#8211;allow-unaffected</cite> is specified, the item prefix with &#8220;[affected]&#8221; is not required.</p>
<p>Note that for autosomal dominant <cite>&#8211;lenient</cite> allows singleton affecteds to be used to meet the
<cite>&#8211;min-kindreds</cite> requirement if they are HET.</p>
<p>If there is incomplete penetrance in the kindred (unaffected obligate carriers), these individuals currently must be coded as having unknown phenotype or as being affected.</p>
</div>
<div class="section" id="id8">
<h3><code class="docutils literal"><span class="pre">default</span> <span class="pre">behavior</span></code><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>For the following examples, let&#8217;s assume we have a PED file for 3 different
families as follows (the kids are affected in each family, but the parents
are not):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>cat families.ped
<span class="m">1</span>   1_dad   <span class="m">0</span>       <span class="m">0</span>       -1      1
<span class="m">1</span>   1_mom   <span class="m">0</span>       <span class="m">0</span>       -1      1
<span class="m">1</span>   1_kid   1_dad   1_mom   -1      2
<span class="m">2</span>   2_dad   <span class="m">0</span>       <span class="m">0</span>       -1      1
<span class="m">2</span>   2_mom   <span class="m">0</span>       <span class="m">0</span>       -1      2
<span class="m">2</span>   2_kid   2_dad   2_mom   -1      2
<span class="m">3</span>   3_dad   <span class="m">0</span>       <span class="m">0</span>       -1      2
<span class="m">3</span>   3_mom   <span class="m">0</span>       <span class="m">0</span>       -1      -9
<span class="m">3</span>   3_kid   3_dad   3_mom   -1      2
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini autosomal_dominant test.auto_dom.db --columns <span class="s2">&quot;chrom,start,end,gene&quot;</span>
chrom       start   end     gene    variant_id      family_id       family_members  family_genotypes        samples family_count
chr10       <span class="m">48003991</span>        <span class="m">48003992</span>        ASAH2C  <span class="m">3</span>       <span class="m">3</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>affected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> C/C,C/T,C/T     2_mom,2_kid     2
chr10       <span class="m">48004991</span>        <span class="m">48004992</span>        ASAH2C  <span class="m">4</span>       <span class="m">4</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>affected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> C/C,C/T,C/T     2_mom,2_kid     2
chr10       <span class="m">48003991</span>        <span class="m">48003992</span>        ASAH2C  <span class="m">3</span>       <span class="m">3</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>affected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>    C/T,C/C,C/T     3_dad,3_kid     2
chr10       <span class="m">48004991</span>        <span class="m">48004992</span>        ASAH2C  <span class="m">4</span>       <span class="m">4</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>affected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>    C/T,C/C,C/T     3_dad,3_kid     2
chr10       <span class="m">135336655</span>       <span class="m">135336656</span>       SPRN    <span class="m">5</span>       <span class="m">5</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>affected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>    G/A,G/G,G/A     3_dad,3_kid     1
chr10       <span class="m">1142207</span> <span class="m">1142208</span> WDR37   <span class="m">1</span>       <span class="m">1</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>affected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> T/T,T/C,T/C     2_mom,2_kid     2
chr10       <span class="m">1142207</span> <span class="m">1142208</span> WDR37   <span class="m">1</span>       <span class="m">1</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>affected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>    T/C,T/T,T/C     3_dad,3_kid     2
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini autosomal_dominant <span class="se">\</span>
    --columns <span class="s2">&quot;gene, chrom, start, end, ref, alt, impact, impact_severity&quot;</span> <span class="se">\</span>
    --min-kindreds <span class="m">2</span> <span class="se">\</span>
    test.auto_dom.db
gene        chrom   start   end     ref     alt     impact  impact_severity variant_id      family_id       family_members  family_genotypes        samples family_count
ASAH2C      chr10   <span class="m">48003991</span>        <span class="m">48003992</span>        C       T       non_syn_coding  MED     <span class="m">3</span>       <span class="m">3</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>affected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> C/C,C/T,C/T     2_mom,2_kid     2
ASAH2C      chr10   <span class="m">48004991</span>        <span class="m">48004992</span>        C       T       non_syn_coding  MED     <span class="m">4</span>       <span class="m">4</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>affected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> C/C,C/T,C/T     2_mom,2_kid     2
ASAH2C      chr10   <span class="m">48003991</span>        <span class="m">48003992</span>        C       T       non_syn_coding  MED     <span class="m">3</span>       <span class="m">3</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>affected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>    C/T,C/C,C/T     3_dad,3_kid     2
ASAH2C      chr10   <span class="m">48004991</span>        <span class="m">48004992</span>        C       T       non_syn_coding  MED     <span class="m">4</span>       <span class="m">4</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>affected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>    C/T,C/C,C/T     3_dad,3_kid     2
WDR37       chr10   <span class="m">1142207</span> <span class="m">1142208</span> T       C       stop_loss       HIGH    <span class="m">1</span>       <span class="m">1</span>       2_dad<span class="o">(</span>dad<span class="p">;</span>unaffected<span class="o">)</span>,2_mom<span class="o">(</span>mom<span class="p">;</span>affected<span class="o">)</span>,2_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span> T/T,T/C,T/C     2_mom,2_kid     2
WDR37       chr10   <span class="m">1142207</span> <span class="m">1142208</span> T       C       stop_loss       HIGH    <span class="m">1</span>       <span class="m">1</span>       3_dad<span class="o">(</span>dad<span class="p">;</span>affected<span class="o">)</span>,3_mom<span class="o">(</span>mom<span class="p">;</span>unknown<span class="o">)</span>,3_kid<span class="o">(</span>child<span class="p">;</span>affected<span class="o">)</span>    T/C,T/T,T/C     3_dad,3_kid     2
</pre></div>
</div>
</div>
</div>
<div class="section" id="gene-wise-custom-genotype-filtering-by-gene">
<h2><code class="docutils literal"><span class="pre">gene_wise</span></code>: Custom genotype filtering by gene.<a class="headerlink" href="#gene-wise-custom-genotype-filtering-by-gene" title="Permalink to this headline">¶</a></h2>
<p>The gemini query tool allows querying by variant and the inheritance tools
described above enable querying by gene for fixed inheritance patterns.
The <cite>gene_wise</cite> tool allows querying by gene with custom genotype filters
to bridge the gap between these tools.</p>
<p>With this tool, multiple <cite>&#8211;gt-filter</cite> s can be specified. Each filter can
be any valid filter; often, it will make sense to have 1 filter for each
family. For example, given this pedigree:</p>
<img alt="../_images/gene_wise_example.png" src="../_images/gene_wise_example.png" />
<p>Where only the orange samples are sequenced, we could devise a query:</p>
<div class="highlight-python"><div class="highlight"><pre>gemini gene_wise $db \
    --min-filters 3 \
    --gt-filter &quot;gt_types.fam1_kid == HET and gt_types.fam1_mom == HOM_REF and gt_types.fam1_dad == HOM_REF&quot; \
    --gt-filter &quot;gt_types.fam2_kid == HET&quot; \
    --gt-filter &quot;gt_types.fam3_kid == HET&quot; \
    --columns &quot;chrom,start,end,gene,impact,impact_severity&quot; \
    --filter &quot;max_aaf_all &lt; 0.005&quot;
</pre></div>
</div>
<p>The <cite>&#8211;min-filters</cite> option means that we want all 3 of those filters to be met in a
gene in order for variants in that gene to be reported. We can envision a scenario where
we have 6 families (and 6 filters) and we want to report genes where 4 of them meet the
filters. In that case, the query would have 6 <cite>&#8211;gt-filter</cite> s and <cite>&#8211;min-filters</cite> of 3.</p>
<p>This differs from using gemini query with a single <cite>&#8211;gt-filter</cite> that combines each of those
terms with an <em>and</em> because this allows each filter to be met <strong>in a different variant</strong> but
<strong>in the same gene</strong> while the gemini query tool applies all elements of the single filter
to each variant.</p>
<p>The output from the above query is:</p>
<div class="highlight-python"><div class="highlight"><pre>chrom  start     end       gene      impact              impact_severity  variant_filters  n_gene_variants  gene_filters
chr5   60839982  60839983  ZSWIM6    non_syn_coding      MED              1,2,3            1                1,2,3
chr6   32548031  32548032  HLA-DRB1  non_syn_coding      MED              1                4                1,2,3
chr6   32552059  32552060  HLA-DRB1  frame_shift         HIGH             2                4                1,2,3
chr6   32552131  32552132  HLA-DRB1  inframe_codon_gain  MED              3                4                1,2,3
chr6   32552136  32552137  HLA-DRB1  non_syn_coding      MED              3                4                1,2,3
</pre></div>
</div>
<p>Note that the first gene has the same variant for all 3 families, so we could have found this with
the gemini query tool. However, for the HLA gene, each of the 3 filters passed in different variant
so this would be missed by the query tool which only looks at a single variant at a time.</p>
<p>As with the other tools, this tool orders by chromosome and gene and it applies <cite>WHERE (is_exonic = 1 AND impact_severity != &#8216;LOW&#8217;)&#8221;</cite> to the query.</p>
<blockquote>
<div><ul class="simple">
<li>The <cite>variant_filters</cite> column shows which filters were passed by the variant.</li>
<li>The <cite>n_gene_variants</cite> column shows how many variants in the gene are being reported.</li>
<li>The <cite>gene_filter</cite> column shows which filters in the gene passed by any variant.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="pathways-map-genes-and-variants-to-kegg-pathways">
<h2><code class="docutils literal"><span class="pre">pathways</span></code>: Map genes and variants to KEGG pathways.<a class="headerlink" href="#pathways-map-genes-and-variants-to-kegg-pathways" title="Permalink to this headline">¶</a></h2>
<p>Mapping genes to biological pathways is useful in understanding the
function/role played by a gene. Likewise, genes involved in common pathways
is helpful in understanding heterogeneous diseases. We have integrated
the KEGG pathway mapping for gene variants, to explain/annotate variation.
This requires your VCF be annotated with either snpEff/VEP.</p>
<p>Examples:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini pathways -v <span class="m">68</span> example.db
chrom   start   end     ref     alt     impact  sample  genotype        gene    transcript      pathway
chr10   <span class="m">52004314</span>        <span class="m">52004315</span>        T       C       intron  M128215 C/C     ASAH2   ENST00000395526 hsa00600:Sphingolipid_metabolism,hsa01100:Metabolic_pathways
chr10   <span class="m">126678091</span>       <span class="m">126678092</span>       G       A       stop_gain       M128215 G/A     CTBP2   ENST00000531469 hsa05220:Chronic_myeloid_leukemia,hsa04310:Wnt_signaling_pathway,hsa04330:Notch_signaling_pathway,hsa05200:Pathways_in_cancer
chr16   <span class="m">72057434</span>        <span class="m">72057435</span>        C       T       non_syn_coding  M10475  C/T     DHODH   ENST00000219240 hsa01100:Metabolic_pathways,hsa00240:Pyrimidine_metabolism
</pre></div>
</div>
<p>Here, -v specifies the version of the Ensembl genes used to build the KEGG
pathway map. Hence, use versions that match the VEP/snpEff versions of the
annotated vcf for correctness. For e.g VEP v2.6 and snpEff v3.1 use Ensembl
68 version of the genomes.</p>
<p>We currently support versions 66 through 71 of the Ensembl genes</p>
<div class="section" id="lof">
<h3><code class="docutils literal"><span class="pre">--lof</span></code><a class="headerlink" href="#lof" title="Permalink to this headline">¶</a></h3>
<p>By default, all gene variants that map to pathways are reported.  However,
one may want to restrict the analysis to LoF variants using the <code class="docutils literal"><span class="pre">--lof</span></code> option.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini pathways --lof -v <span class="m">68</span> example.db
chrom   start   end     ref     alt     impact  sample  genotype        gene    transcript      pathway
chr10   <span class="m">126678091</span>       <span class="m">126678092</span>       G       A       stop_gain       M128215 G/A     CTBP2   ENST00000531469 hsa05220:Chronic_myeloid_leukemia,hsa04310:Wnt_signaling_pathway,hsa04330:Notch_signaling_pathway,hsa05200:Pathways_in_cancer
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactions-find-genes-among-variants-that-are-interacting-partners">
<h2><code class="docutils literal"><span class="pre">interactions</span></code>: Find genes among variants that are interacting partners.<a class="headerlink" href="#interactions-find-genes-among-variants-that-are-interacting-partners" title="Permalink to this headline">¶</a></h2>
<p>Integrating the knowledge of the known protein-protein interactions would be
useful in explaining variation data. Meaning to say that a damaging variant
in an interacting partner of a  potential protein may be equally interesting
as the protein itself. We have used the HPRD binary interaction data to build
a p-p network graph which can be explored by GEMINI.</p>
<p>Examples:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini interactions -g CTBP2 -r <span class="m">3</span> example.db
sample  gene    order_of_interaction    interacting_gene
M128215 CTBP2   0_order:        CTBP2
M128215 CTBP2   1_order:        RAI2
M128215 CTBP2   2_order:        RB1
M128215 CTBP2   3_order:        TGM2,NOTCH2NL
</pre></div>
</div>
<p>Return CTBP2 (-g) interacting gene variants till the third order (-r)</p>
<div class="section" id="lof-interactions">
<h3><code class="docutils literal"><span class="pre">lof_interactions</span></code><a class="headerlink" href="#lof-interactions" title="Permalink to this headline">¶</a></h3>
<p>Use this option to restrict your analysis to only LoF variants.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini lof_interactions -r <span class="m">3</span> example.db
sample  lof_gene        order_of_interaction    interacting_gene
M128215 TGM2    1_order:        RB1
M128215 TGM2    2_order:        none
M128215 TGM2    3_order:        NOTCH2NL,CTBP2
</pre></div>
</div>
<p>Meaning to say return all LoF gene TGM2 (in sample M128215) interacting
partners to a 3rd order of interaction.</p>
</div>
<div class="section" id="var">
<h3><code class="docutils literal"><span class="pre">--var</span></code><a class="headerlink" href="#var" title="Permalink to this headline">¶</a></h3>
<p>An extended variant information (chrom, start, end etc.) for the interacting gene
may be achieved with the &#8211;var option for both the <code class="docutils literal"><span class="pre">interactions</span></code> and the
<code class="docutils literal"><span class="pre">lof_interactions</span></code></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini interactions -g CTBP2 -r <span class="m">3</span> --var example.db
sample  gene    order_of_interaction    interacting_gene        var_id  chrom   start   end     impact  biotype in_dbsnp        clinvar_sig     clinvar_disease_name    aaf_1kg_all     aaf_esp_all
M128215 CTBP2   <span class="m">0</span>       CTBP2   <span class="m">5</span>       chr10   <span class="m">126678091</span>       <span class="m">126678092</span>       stop_gain       protein_coding  <span class="m">1</span>       None    None    None    None
M128215 CTBP2   <span class="m">1</span>       RAI2    <span class="m">9</span>       chrX    <span class="m">17819376</span>        <span class="m">17819377</span>        non_syn_coding  protein_coding  <span class="m">1</span>       None    None    <span class="m">1</span>       0.000473
M128215 CTBP2   <span class="m">2</span>       RB1     <span class="m">7</span>       chr13   <span class="m">48873834</span>        <span class="m">48873835</span>        upstream        protein_coding  <span class="m">1</span>       None    None    0.94    None
M128215 CTBP2   <span class="m">3</span>       NOTCH2NL        <span class="m">1</span>       chr1    <span class="m">145273344</span>       <span class="m">145273345</span>       non_syn_coding  protein_coding  <span class="m">1</span>       None    None    None    None
M128215 CTBP2   <span class="m">3</span>       TGM2    <span class="m">8</span>       chr20   <span class="m">36779423</span>        <span class="m">36779424</span>        stop_gain       protein_coding  <span class="m">0</span>       None    None    None    None
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini lof_interactions -r <span class="m">3</span> --var example.db
sample  lof_gene        order_of_interaction    interacting_gene        var_id  chrom   start   end     impact  biotype in_dbsnp        clinvar_sig     clinvar_disease_name    aaf_1kg_all     aaf_esp_all
M128215 TGM2    <span class="m">1</span>       RB1     <span class="m">7</span>       chr13   <span class="m">48873834</span>        <span class="m">48873835</span>        upstream        protein_coding  <span class="m">1</span>       None    None    0.94    None
M128215 TGM2    <span class="m">3</span>       NOTCH2NL        <span class="m">1</span>       chr1    <span class="m">145273344</span>       <span class="m">145273345</span>       non_syn_coding  protein_coding  <span class="m">1</span>       None    None    None    None
M128215 TGM2    <span class="m">3</span>       CTBP2   <span class="m">5</span>       chr10   <span class="m">126678091</span>       <span class="m">126678092</span>       stop_gain       protein_coding  <span class="m">1</span>       None    None    None    None
</pre></div>
</div>
</div>
</div>
<div class="section" id="lof-sieve-filter-lof-variants-by-transcript-position-and-type">
<h2><code class="docutils literal"><span class="pre">lof_sieve</span></code>: Filter LoF variants by transcript position and type<a class="headerlink" href="#lof-sieve-filter-lof-variants-by-transcript-position-and-type" title="Permalink to this headline">¶</a></h2>
<p>Not all candidate LoF variants are created equal. For e.g, a nonsense (stop gain)
variant impacting the first 5% of a polypeptide is far more likely to be deleterious
than one affecting the last 5%. Assuming you&#8217;ve annotated your VCF with snpEff v3.0+,
the lof_sieve tool reports the fractional position (e.g. 0.05 for the first 5%) of
the mutation in the amino acid sequence. In addition, it also reports the predicted
function of the transcript so that one can segregate candidate LoF variants that
affect protein_coding transcripts from processed RNA, etc.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini lof_sieve chr22.low.exome.snpeff.100samples.vcf.db
chrom   start   end ref alt highest_impact  aa_change   var_trans_pos   trans_aa_length var_trans_pct   sample  genotype    gene    transcript  trans_type
chr22   <span class="m">17072346</span>    <span class="m">17072347</span>    C   T   stop_gain   W365*   <span class="m">365</span> <span class="m">557</span> 0.655296229803  NA19327 C<span class="p">|</span>T CCT8L2  ENST00000359963 protein_coding
chr22   <span class="m">17072346</span>    <span class="m">17072347</span>    C   T   stop_gain   W365*   <span class="m">365</span> <span class="m">557</span> 0.655296229803  NA19375 T<span class="p">|</span>C CCT8L2  ENST00000359963 protein_coding
chr22   <span class="m">17129539</span>    <span class="m">17129540</span>    C   T   splice_donor    None    None    None    None    NA18964 T<span class="p">|</span>C TPTEP1  ENST00000383140 lincRNA
chr22   <span class="m">17129539</span>    <span class="m">17129540</span>    C   T   splice_donor    None    None    None    None    NA19675 T<span class="p">|</span>C TPTEP1  ENST00000383140 lincRNA
</pre></div>
</div>
</div>
<div class="section" id="amend-updating-changing-the-sample-information">
<h2><code class="docutils literal"><span class="pre">amend</span></code>: updating / changing the sample information<a class="headerlink" href="#amend-updating-changing-the-sample-information" title="Permalink to this headline">¶</a></h2>
<p>Occassionally one may need to update the sample information
stored in the <code class="docutils literal"><span class="pre">samples</span></code> table. The <code class="docutils literal"><span class="pre">amend</span></code> tool allows one
to provide an updated PED file as input and it will update
each sample_id in the PED file that matches a sample_id.</p>
<p>For example, assume you have already loaded a GEMINI database
with a <code class="docutils literal"><span class="pre">samples.ped</span></code> where mom and dad are unaffected and
kid isaffected:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>cat samples.ped
<span class="m">1</span> dad <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>  1
<span class="m">1</span> mom <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>  1
<span class="m">1</span> kid dad mom <span class="m">2</span>  2

<span class="nv">$ </span>gemini load -v my.vcf -p samples.ped -t VEP my.db
</pre></div>
</div>
<p>Now, let&#8217;s say you realized that the dad is also affected and you
want to correct the <code class="docutils literal"><span class="pre">samples</span></code> table accordingly. You would first
edit the PED file and then run the <code class="docutils literal"><span class="pre">amend</span></code> tool using the updated
PED.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>cat samples.ped
<span class="m">1</span> dad <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>  2
<span class="m">1</span> mom <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>  1
<span class="m">1</span> kid dad mom <span class="m">2</span>  2

<span class="nv">$ </span>gemini amend --sample samples.ped my.db
</pre></div>
</div>
</div>
<div class="section" id="annotate-adding-your-own-custom-annotations">
<h2><code class="docutils literal"><span class="pre">annotate</span></code>: adding your own custom annotations<a class="headerlink" href="#annotate-adding-your-own-custom-annotations" title="Permalink to this headline">¶</a></h2>
<p>It is inevitable that researchers will want to enhance the gemini framework with
their own, custom annotations. <code class="docutils literal"><span class="pre">gemini</span></code> provides a sub-command called
<code class="docutils literal"><span class="pre">annotate</span></code> for exactly this purpose. As long as you provide a <code class="docutils literal"><span class="pre">tabix</span></code>&#8216;ed
annotation file in BED or VCF format, the <code class="docutils literal"><span class="pre">annotate</span></code> tool will, for each
variant in the variants table, screen for overlaps in your annotation file and
update a one or more new column in the variants table that you may specify on the command
line. This is best illustrated by example.</p>
<p>Let&#8217;s assume you have already created a gemini database of a VCF file using
the <code class="docutils literal"><span class="pre">load</span></code> module.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini load -v my.vcf -t snpEff my.db
</pre></div>
</div>
<p>Now, let&#8217;s imagine you have an annotated file in BED format (<code class="docutils literal"><span class="pre">important.bed</span></code>)
that describes regions of the genome that are particularly relevant to your
lab&#8217;s research. You would like to annotate in the gemini database which variants
overlap these crucial regions. We want to store this knowledge in a new column
in the <code class="docutils literal"><span class="pre">variants</span></code> table called <code class="docutils literal"><span class="pre">important_variant</span></code> that tracks whether a given
variant overlapped (1) or did not overlap (0) intervals in your annotation file.</p>
<p>To do this, you must first TABIX your BED file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>bgzip important.bed
<span class="nv">$ </span>tabix -p bed important.bed.gz
</pre></div>
</div>
<div class="section" id="a-boolean-did-a-variant-overlap-a-region-or-not">
<h3><code class="docutils literal"><span class="pre">-a</span> <span class="pre">boolean</span></code> Did a variant overlap a region or not?<a class="headerlink" href="#a-boolean-did-a-variant-overlap-a-region-or-not" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Formerly, the <code class="docutils literal"><span class="pre">-a</span></code> option was the <code class="docutils literal"><span class="pre">-t</span></code> option.</p>
</div>
<p>Now, you can use this TABIX&#8217;ed file to annotate which variants overlap your
important regions.  In the example below, the results will be stored in a new
column called &#8220;important&#8221;.  The <code class="docutils literal"><span class="pre">-t</span> <span class="pre">boolean</span></code> option says that you just want to
track whether (1) or not (0) the variant overlapped one or more of your regions.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini annotate -f important.bed.gz -c important -a boolean my.db
</pre></div>
</div>
<p>Since a new columns has been created in the database, we can now directly query
the new column.  In the example results below, the first and third variants
overlapped a crucial region while the second did not.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini query <span class="se">\</span>
    -q <span class="s2">&quot;select chrom, start, end, variant_id, important from variants&quot;</span> <span class="se">\</span>
    my.db <span class="se">\</span>
    <span class="p">|</span> head -3
chr22   <span class="m">100</span>    <span class="m">101</span>    <span class="m">1</span>   1
chr22   <span class="m">200</span>    <span class="m">201</span>    <span class="m">2</span>   0
chr22   <span class="m">300</span>    <span class="m">500</span>    <span class="m">3</span>   1
</pre></div>
</div>
</div>
<div class="section" id="a-count-how-many-regions-did-a-variant-overlap">
<h3><code class="docutils literal"><span class="pre">-a</span> <span class="pre">count</span></code> How many regions did a variant overlap?<a class="headerlink" href="#a-count-how-many-regions-did-a-variant-overlap" title="Permalink to this headline">¶</a></h3>
<p>Instead of a simple yes or no, we can use the <code class="docutils literal"><span class="pre">-t</span> <span class="pre">count</span></code> option to <em>count</em>
how many important regions a variant overlapped.  It turns out that the 3rd
variant actually overlapped two important regions.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini annotate -f important.bed.gz -c important -a count my.db

<span class="nv">$ </span>gemini query <span class="se">\</span>
    -q <span class="s2">&quot;select chrom, start, end, variant_id, crucial from variants&quot;</span> <span class="se">\</span>
    my.db <span class="se">\</span>
    <span class="p">|</span> head -3
chr22   <span class="m">100</span>    <span class="m">101</span>    <span class="m">1</span>   1
chr22   <span class="m">200</span>    <span class="m">201</span>    <span class="m">2</span>   0
chr22   <span class="m">300</span>    <span class="m">500</span>    <span class="m">3</span>   2
</pre></div>
</div>
</div>
<div class="section" id="a-extract-extract-specific-values-from-a-bed-file">
<h3><code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code> Extract specific values from a BED file<a class="headerlink" href="#a-extract-extract-specific-values-from-a-bed-file" title="Permalink to this headline">¶</a></h3>
<p>Lastly, we may also extract values from specific fields in a BED
file (or from the INFO field in a VCF) and populate one or more new columns
in the database based on
overlaps with the annotation file and the values of the fields therein.
To do this, we use the <code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code> option.</p>
<p>This is best described with an example.  To set this up, let&#8217;s imagine
that we have a VCF file from a different experiment and we want to annotate
the variants in our GEMINI database with the allele frequency and depth
tags from the INFO fields for the same variants in this other VCF file.</p>
<blockquote>
<div># bgzip and tabix the vcf for use with the annotate tool.
$ bgzip other.vcf
$ tabix other.vcf.gz</div></blockquote>
<p>Now that we have a proper TABIX&#8217;ed VCF file, we can use the <code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code> option to populate new
columns in the GEMINI database.  In order to do so, we must specify:</p>
<blockquote>
<div><ol class="arabic simple">
<li>its type (e.g., text, int, float,)  (<code class="docutils literal"><span class="pre">-t</span></code>)</li>
<li>the field in the INFO column of the VCF file that we should use to extract data with which to populate the new column (<code class="docutils literal"><span class="pre">-e</span></code>)</li>
<li>what operation should be used to summarize the data in the event of multiple overlaps in the annotation file  (<code class="docutils literal"><span class="pre">-o</span></code>)</li>
<li>(optionally) the name of the column we want to add (<code class="docutils literal"><span class="pre">-c</span></code>), if this is not specified, it will use the value from <code class="docutils literal"><span class="pre">-e</span></code>.</li>
</ol>
</div></blockquote>
<p>For example, let&#8217;s imagine we want to create a new column called &#8220;other_allele_freq&#8221; using the
AF field in our VCF file to populate it.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini annotate -f other.vcf.gz <span class="se">\</span>
                  -a extract <span class="se">\</span>
                  -c other_allele_freq <span class="se">\</span>
                  -t float <span class="se">\</span>
                  -e AF <span class="se">\</span>
                  -o mean <span class="se">\</span>
                  my.db
</pre></div>
</div>
<p>This create a new column in <code class="docutils literal"><span class="pre">my.db</span></code> called <code class="docutils literal"><span class="pre">other_allele_freq</span></code> and this
new column will be a FLOAT.  In the event of multiple records in the VCF
file overlapping a variant in the database, the average (mean) of the allele
frequencies values from the VCF file will be used.</p>
<p>At this point, one can query the database based on the values of the
new <code class="docutils literal"><span class="pre">other_allele_freq</span></code> column:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini query -q <span class="s2">&quot;select * from variants where other_allele_freq &lt; 0.01&quot;</span> my.db
</pre></div>
</div>
</div>
<div class="section" id="t-type-specifying-the-column-type-s-when-using-a-extract">
<h3><code class="docutils literal"><span class="pre">-t</span> <span class="pre">TYPE</span></code> Specifying the column type(s) when using <code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code><a class="headerlink" href="#t-type-specifying-the-column-type-s-when-using-a-extract" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">annotate</span></code> tool will create three different types of columns via the <code class="docutils literal"><span class="pre">-t</span></code> option:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Floating point columns for annotations with decimal precision as above (<code class="docutils literal"><span class="pre">-t</span> <span class="pre">float</span></code>)</li>
<li>Integer columns for integral annotations (<code class="docutils literal"><span class="pre">-t</span> <span class="pre">integer</span></code>)</li>
<li>Text columns for string columns such as &#8220;valid&#8221;, &#8220;yes&#8221;, etc. (<code class="docutils literal"><span class="pre">-t</span> <span class="pre">text</span></code>)</li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">-t</span></code> option is only valid when using the <code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code> option.</p>
</div>
</div>
<div class="section" id="o-operation-specifying-the-summary-operations-when-using-a-extract">
<h3><code class="docutils literal"><span class="pre">-o</span> <span class="pre">OPERATION</span></code> Specifying the summary operations when using <code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code><a class="headerlink" href="#o-operation-specifying-the-summary-operations-when-using-a-extract" title="Permalink to this headline">¶</a></h3>
<p>In the event of multiple overlaps between a variant and records in the annotation
file, the <code class="docutils literal"><span class="pre">annotate</span></code> tool can summarize the values observed with multiple options:</p>
<blockquote>
<div><ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">mean</span></code>.  Compute the average of the values.  <strong>They must be numeric</strong>.</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">median</span></code>. Compute the median of the values.  <strong>They must be numeric</strong>.</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">min</span></code>. Compute the minimum of the values.  <strong>They must be numeric</strong>.</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">max</span></code>. Compute the maximum of the values.  <strong>They must be numeric</strong>.</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">mode</span></code>. Compute the maximum of the values.  <strong>They must be numeric</strong>.</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">first</span></code>. Use the value from the <strong>first</strong> record in the annotation file.</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">last</span></code>. Use the value from the <strong>last</strong> record in the annotation file.</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">list</span></code>. Create a comma-separated list of the observed values.  <strong>-t must be text</strong></li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">uniq_list</span></code>. Create a comma-separated list of the <strong>distinct</strong> (i.e., non-redundant) observed values.  <strong>-t must be text</strong></li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">sum</span></code>. Compute the sum of the values. <strong>They must be numeric</strong>.</li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">-o</span></code> option is only valid when using the <code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code> option.</p>
</div>
</div>
<div class="section" id="annotating-with-vcf">
<h3>Annotating with VCF<a class="headerlink" href="#annotating-with-vcf" title="Permalink to this headline">¶</a></h3>
<p>Most of the examples to this point have pulled a column from a <cite>tabix</cite> indexed bed file.
It is likewise possible to pull from the INFO field  of a <cite>tabix</cite> index VCF. The syntax
is identical but the <code class="docutils literal"><span class="pre">-e</span></code> operation will specify the names of fields in the INFO column
to pull. By default, those names will be used, but that can still be specified with the
<cite>-c</cite> column.
Here are some example uses</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># put a DP column in the db:</span>
gemini annotate -f anno.vcf.gz -o list -e DP -t integer my.db

<span class="c"># ... and name it &#39;depth&#39;</span>
gemini annotate -f anno.vcf.gz -o list -e DP -c depth -t integer my.db

<span class="c"># use multiple columns</span>
gemini annotate -f anno.vcf.gz -o list,mean -e DP,Qmeter -c depth,qmeter -t integer my.db
</pre></div>
</div>
<p>Missing values are allowed since we expect that in some cases an annotation VCF will not
have all INFO fields specified for all variants.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We recommend decomposing and normalizing variants before annotating.
See <a class="reference internal" href="preprocessing.html#preprocess"><span>Step 1. split, left-align, and trim variants</span></a> for a detailed explanation of how to do this.</p>
</div>
</div>
<div class="section" id="extracting-and-populating-multiple-columns-at-once">
<h3>Extracting and populating multiple columns at once.<a class="headerlink" href="#extracting-and-populating-multiple-columns-at-once" title="Permalink to this headline">¶</a></h3>
<p>One can also extract and populate multiple columns at once by providing
comma-separated lists (no spaces) of column names (<code class="docutils literal"><span class="pre">-c</span></code>), types (<code class="docutils literal"><span class="pre">-t</span></code>), numbers (<code class="docutils literal"><span class="pre">-e</span></code>),
and summary operations (<code class="docutils literal"><span class="pre">-o</span></code>).  For example, recall that in the VCF example above,
we created a TABIX&#8217;ed BED file containg the allele frequency and depth values from
the INFO field as the 4th and 5th columns in the BED, respectively.</p>
<p>Instead of running the <code class="docutils literal"><span class="pre">annotate</span></code> tool twice (once for eaxh column), we can
run the tool once and load both columns in the same run.  For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini annotate -f other.bed.gz <span class="se">\</span>
                  -a extract <span class="se">\</span>
                  -c other_allele_freq,other_depth <span class="se">\</span>
                  -t float,integer <span class="se">\</span>
                  -e 4,5 <span class="se">\</span>
                  -o mean,max <span class="se">\</span>
                  my.db
</pre></div>
</div>
<p>We can then use each of the new columns to filter variants with a GEMINI query:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini query -q <span class="s2">&quot;select * from variants \</span>
<span class="s2">                   where other_allele_freq &lt; 0.01 \</span>
<span class="s2">                   and other_depth &gt; 100&quot;</span> my.db
</pre></div>
</div>
</div>
</div>
<div class="section" id="region-extracting-variants-from-specific-regions-or-genes">
<h2><code class="docutils literal"><span class="pre">region</span></code>: Extracting variants from specific regions or genes<a class="headerlink" href="#region-extracting-variants-from-specific-regions-or-genes" title="Permalink to this headline">¶</a></h2>
<p>One often is concerned with variants found solely in a particular gene or
genomic region. <code class="docutils literal"><span class="pre">gemini</span></code> allows one to extract variants that fall within
specific genomic coordinates as follows:</p>
<div class="section" id="reg">
<h3><code class="docutils literal"><span class="pre">--reg</span></code><a class="headerlink" href="#reg" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini region --reg chr1:100-200 my.db
</pre></div>
</div>
</div>
<div class="section" id="gene">
<h3><code class="docutils literal"><span class="pre">--gene</span></code><a class="headerlink" href="#gene" title="Permalink to this headline">¶</a></h3>
<p>Or, one can extract variants based on a specific gene name.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini region --gene PTPN22 my.db
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3><code class="docutils literal"><span class="pre">--columns</span></code><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>By default, this tool reports all columns in the <code class="docutils literal"><span class="pre">variants</span></code> table. One may
choose to report only a subset of the columns using the <code class="docutils literal"><span class="pre">--columns</span></code> option.  For
example, to report just the <code class="docutils literal"><span class="pre">gene,</span> <span class="pre">chrom,</span> <span class="pre">start,</span> <span class="pre">end,</span> <span class="pre">ref,</span> <span class="pre">alt,</span> <span class="pre">impact</span></code>, and <code class="docutils literal"><span class="pre">impact_severity</span></code> columns, one
would use the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini region --gene DHODH <span class="se">\</span>
                --columns <span class="s2">&quot;chrom, start, end, ref, alt, gene, impact&quot;</span> <span class="se">\</span>
                my.db

chr16   <span class="m">72057281</span>    <span class="m">72057282</span>    A   G   DHODH   intron
chr16   <span class="m">72057434</span>    <span class="m">72057435</span>    C   T   DHODH   non_syn_coding
chr16   <span class="m">72059268</span>    <span class="m">72059269</span>    T   C   DHODH   downstream
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h3><code class="docutils literal"><span class="pre">--filter</span></code><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>By default, this tool will report all variants regardless of their putative
functional impact.  In order to apply additional constraints on the variants
returned, one can use the <code class="docutils literal"><span class="pre">--filter</span></code> option.  Using SQL syntax, conditions
applied with the <a href="#id11"><span class="problematic" id="id12">``</span></a>&#8211;filter option become WHERE clauses in the query issued to
the GEMINI database.  For example, if we wanted to restrict candidate variants
to solely those with a HIGH predicted functional consequence, we could use the
following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini region --gene DHODH <span class="se">\</span>
                --columns <span class="s2">&quot;chrom, start, end, ref, alt, gene, impact&quot;</span> <span class="se">\</span>
                --filter <span class="s2">&quot;alt=&#39;G&#39;&quot;</span>
                my.db

chr16   <span class="m">72057281</span>    <span class="m">72057282</span>    A   G   DHODH   intron
</pre></div>
</div>
</div>
<div class="section" id="json">
<h3><code class="docutils literal"><span class="pre">--json</span></code><a class="headerlink" href="#json" title="Permalink to this headline">¶</a></h3>
<p>Reporting query output in JSON format may enable
HTML/Javascript apps to query GEMINI and retrieve
the output in a format that is amenable to web development protocols.</p>
<p>To report in JSON format, use the <code class="docutils literal"><span class="pre">--json</span></code> option. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini region --gene DHODH <span class="se">\</span>
                --columns <span class="s2">&quot;chrom, start, end, ref, alt, gene, impact&quot;</span> <span class="se">\</span>
                --filter <span class="s2">&quot;alt=&#39;G&#39;&quot;</span>
                --json
                my.db

<span class="o">{</span><span class="s2">&quot;chrom&quot;</span>: <span class="s2">&quot;chr16&quot;</span>, <span class="s2">&quot;start&quot;</span>: 72057281, <span class="s2">&quot;end&quot;</span>: 72057282, <span class="s2">&quot;ref&quot;</span>: <span class="s2">&quot;A&quot;</span>, <span class="s2">&quot;alt&quot;</span>: <span class="s2">&quot;G&quot;</span>, <span class="s2">&quot;gene&quot;</span>: <span class="s2">&quot;DHODH&quot;</span><span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="windower-conducting-analyses-on-genome-windows">
<h2><code class="docutils literal"><span class="pre">windower</span></code>: Conducting analyses on genome &#8220;windows&#8221;.<a class="headerlink" href="#windower-conducting-analyses-on-genome-windows" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">gemini</span></code> includes a convenient tool for computing variation metrics across
genomic windows (both fixed and sliding). Here are a few examples to whet your
appetite.  If you&#8217;re still hungry, contact us.</p>
<p>Compute the average nucleotide diversity for all variants found in
non-overlapping, 50Kb windows.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini windower -w <span class="m">50000</span> -s <span class="m">0</span> -t nucl_div -o mean my.db
</pre></div>
</div>
<p>Compute the average nucleotide diversity for all variants found in 50Kb windows
that overlap by 10kb.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini windower -w <span class="m">50000</span> -s <span class="m">10000</span> -t nucl_div -o mean my.db
</pre></div>
</div>
<p>Compute the max value for HWE statistic for all variants in a window of size
10kb</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini windower  -w <span class="m">10000</span> -t hwe -o max my.db
</pre></div>
</div>
</div>
<div class="section" id="stats-compute-useful-variant-statistics">
<h2><code class="docutils literal"><span class="pre">stats</span></code>: Compute useful variant statistics.<a class="headerlink" href="#stats-compute-useful-variant-statistics" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">stats</span></code> tool computes some useful variant statistics like</p>
<p>Compute the transition and transversion ratios for the snps</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini stats --tstv my.db
ts      tv      ts/tv
<span class="m">4</span>       <span class="m">5</span>       0.8
</pre></div>
</div>
<div class="section" id="tstv-coding">
<h3><code class="docutils literal"><span class="pre">--tstv-coding</span></code><a class="headerlink" href="#tstv-coding" title="Permalink to this headline">¶</a></h3>
<p>Compute the transition/transversion ratios for the snps in the coding
regions.</p>
</div>
<div class="section" id="tstv-noncoding">
<h3><code class="docutils literal"><span class="pre">--tstv-noncoding</span></code><a class="headerlink" href="#tstv-noncoding" title="Permalink to this headline">¶</a></h3>
<p>Compute the transition/transversion ratios for the snps in the non-coding
regions.</p>
<p>Compute the type and count of the snps.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini stats --snp-counts my.db
<span class="nb">type    </span>count
A-&gt;G    2
C-&gt;T    1
G-&gt;A    1
</pre></div>
</div>
<p>Calculate the site frequency spectrum of the variants.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini stats --sfs my.db
aaf     count
0.125   2
0.375   1
</pre></div>
</div>
<p>Compute the pair-wise genetic distance between each sample</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini stats --mds my.db
sample1 sample2 distance
M10500  M10500  0.0
M10475  M10478  1.25
M10500  M10475  2.0
M10500  M10478  0.5714
</pre></div>
</div>
<p>Return a count of the types of genotypes per sample</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini stats --gts-by-sample my.db
sample  num_hom_ref     num_het num_hom_alt     num_unknown     total
M10475  <span class="m">4</span>       <span class="m">1</span>       <span class="m">3</span>       <span class="m">1</span>       9
M10478  <span class="m">2</span>       <span class="m">2</span>       <span class="m">4</span>       <span class="m">1</span>       9
</pre></div>
</div>
<p>Return the total variants per sample (sum of homozygous
and heterozygous variants)</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini stats --vars-by-sample my.db
sample  total
M10475  4
M10478  6
</pre></div>
</div>
</div>
<div class="section" id="summarize">
<h3><code class="docutils literal"><span class="pre">--summarize</span></code><a class="headerlink" href="#summarize" title="Permalink to this headline">¶</a></h3>
<p>If none of these tools are exactly what you want, you can summarize the variants
per sample of an arbitrary query using the &#8211;summarize flag. For example, if you
wanted to know, for each sample, how many variants are on chromosome 1 that are also
in dbSNP:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini stats --summarize <span class="s2">&quot;select * from variants where in_dbsnp=1 and chrom=&#39;chr1&#39;&quot;</span> my.db
sample  total   num_het num_hom_alt
M10475  <span class="m">1</span>       <span class="m">1</span>       0
M128215 <span class="m">1</span>       <span class="m">1</span>       0
M10478  <span class="m">2</span>       <span class="m">2</span>       0
M10500  <span class="m">2</span>       <span class="m">1</span>       1
</pre></div>
</div>
</div>
</div>
<div class="section" id="burden-perform-sample-wise-gene-level-burden-calculations">
<h2><code class="docutils literal"><span class="pre">burden</span></code>: perform sample-wise gene-level burden calculations<a class="headerlink" href="#burden-perform-sample-wise-gene-level-burden-calculations" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">burden</span></code> tool provides a set of utilities to perform burden
summaries on a per-gene, per sample basis. By default, it outputs
a table of gene-wise counts of all high impact variants in coding regions for
each sample:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini burden test.burden.db
gene    M10475  M10478  M10500  M128215
WDR37   <span class="m">2</span>       <span class="m">2</span>       <span class="m">2</span>       2
CTBP2   <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>       1
DHODH   <span class="m">1</span>       <span class="m">0</span>       <span class="m">0</span>       0
</pre></div>
</div>
<div class="section" id="nonsynonymous">
<h3><code class="docutils literal"><span class="pre">--nonsynonymous</span></code><a class="headerlink" href="#nonsynonymous" title="Permalink to this headline">¶</a></h3>
<p>If you want to be a little bit less restrictive, you can include all
non-synonymous variants instead:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini burden --nonsynonymous test.burden.db
gene    M10475  M10478  M10500  M128215
SYCE1   <span class="m">0</span>       <span class="m">1</span>       <span class="m">1</span>       0
WDR37   <span class="m">2</span>       <span class="m">2</span>       <span class="m">2</span>       2
CTBP2   <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>       1
ASAH2C  <span class="m">2</span>       <span class="m">1</span>       <span class="m">1</span>       0
DHODH   <span class="m">1</span>       <span class="m">0</span>       <span class="m">0</span>       0
</pre></div>
</div>
</div>
<div class="section" id="calpha">
<h3><code class="docutils literal"><span class="pre">--calpha</span></code><a class="headerlink" href="#calpha" title="Permalink to this headline">¶</a></h3>
<p>If your database has been loaded with a PED file describing case and
control samples, you can calculate the
<a class="reference external" href="http://www.plosgenetics.org/article/info%3Adoi%2F10.1371%2Fjournal.pgen.1001322">c-alpha</a>
statistic for cases vs. control:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini burden --calpha test.burden.db
gene    T       c       Z       p_value
SYCE1   -0.5    0.25    -1.0    0.841344746069
WDR37   -1.0    1.5     -0.816496580928 0.792891910879
CTBP2   0.0     0.0     nan     nan
ASAH2C  -0.5    0.75    -0.57735026919  0.718148569175
DHODH   0.0     0.0     nan     nan
</pre></div>
</div>
<p>To calculate the P-value using a permutation test, use the <code class="docutils literal"><span class="pre">--permutations</span></code> option,
specifying the number of permutations of the case/control labels you want to use.</p>
</div>
<div class="section" id="min-aaf-and-max-aaf-for-calpha">
<h3><code class="docutils literal"><span class="pre">--min-aaf</span></code> and <code class="docutils literal"><span class="pre">--max-aaf</span></code> for <code class="docutils literal"><span class="pre">--calpha</span></code><a class="headerlink" href="#min-aaf-and-max-aaf-for-calpha" title="Permalink to this headline">¶</a></h3>
<p>By default, all variants affecting a given gene will be included in the
C-alpha computation.  However, one may establish alternate allele frequency
boundaries for the variants included using the <code class="docutils literal"><span class="pre">--min-aaf</span></code> and
<code class="docutils literal"><span class="pre">--max-aaf</span></code> options.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini burden --calpha test.burden.db --min-aaf 0.0 --max-aaf 0.01
</pre></div>
</div>
</div>
<div class="section" id="cases-and-controls-for-calpha">
<h3><code class="docutils literal"><span class="pre">--cases</span></code> and <code class="docutils literal"><span class="pre">--controls</span> <span class="pre">for</span> <span class="pre">``--calpha</span></code><a class="headerlink" href="#cases-and-controls-for-calpha" title="Permalink to this headline">¶</a></h3>
<p>If you do not have a PED file loaded, or your PED file does not follow the
standard <a class="reference external" href="http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml">PED phenotype encoding format</a>
you can still perform the c-alpha test, but you have to specify which samples
are the control samples and which are the case samples:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini burden --controls M10475 M10478 --cases M10500 M128215 --calpha test.burden.db
gene    T       c       Z       p_value
SYCE1   -0.5    0.25    -1.0    0.841344746069
WDR37   -1.0    1.5     -0.816496580928 0.792891910879
CTBP2   0.0     0.0     nan     nan
ASAH2C  -0.5    0.75    -0.57735026919  0.718148569175
DHODH   0.0     0.0     nan     nan
</pre></div>
</div>
</div>
<div class="section" id="nonsynonymous-calpha">
<h3><code class="docutils literal"><span class="pre">--nonsynonymous</span></code> <code class="docutils literal"><span class="pre">--calpha</span></code><a class="headerlink" href="#nonsynonymous-calpha" title="Permalink to this headline">¶</a></h3>
<p>If you would rather consider all nonsynonymous variants for the C-alpha test rather
than just the medium and high impact variants, add the <code class="docutils literal"><span class="pre">--nonsynonymous</span></code> flag.</p>
</div>
</div>
<div class="section" id="roh-identifying-runs-of-homozygosity">
<h2><code class="docutils literal"><span class="pre">ROH</span></code>: Identifying runs of homozygosity<a class="headerlink" href="#roh-identifying-runs-of-homozygosity" title="Permalink to this headline">¶</a></h2>
<p>Runs of homozygosity are long stretches of homozygous genotypes that reflect
segments shared identically by descent and are a result of consanguinity or
natural selection. Consanguinity elevates the occurrence of rare recessive
diseases (e.g. cystic fibrosis) that represent homozygotes for strongly deleterious
mutations. Hence, the identification of these runs holds medical value.</p>
<p>The &#8216;roh&#8217; tool in GEMINI returns runs of homozygosity identified in whole genome data.
The tool basically looks at every homozygous position on the chromosome as a possible
start site for the run and looks for those that could give rise to a potentially long
stretch of homozygous genotypes.</p>
<p>For e.g. for the given example allowing <code class="docutils literal"><span class="pre">1</span> <span class="pre">HET</span></code> genotype (h) and <code class="docutils literal"><span class="pre">2</span> <span class="pre">UKW</span></code> genotypes (u)
the possible roh runs (H) would be:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">genotype_run</span> <span class="o">=</span> H H H H h H H H H u H H H H H u H H H H H H H h H H H H H h H H H H H
<span class="nv">roh_run1</span>     <span class="o">=</span> H H H H h H H H H u H H H H H u H H H H H H H
<span class="nv">roh_run2</span>     <span class="o">=</span>           H H H H u H H H H H u H H H H H H H h H H H H H
<span class="nv">roh_run3</span>     <span class="o">=</span>                     H H H H H u H H H H H H H h H H H H H
<span class="nv">roh_run4</span>     <span class="o">=</span>                                 H H H H H H H h H H H H H
</pre></div>
</div>
<p>roh returned for &#8211;min-snps = 20 would be:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">roh_run1</span>     <span class="o">=</span> H H H H h H H H H u H H H H H u H H H H H H H
<span class="nv">roh_run2</span>     <span class="o">=</span>           H H H H u H H H H H u H H H H H H H h H H H H H
</pre></div>
</div>
<p>As you can see, the immediate homozygous position right of a break (h or u) would be the possible
start of a new roh run and genotypes to the left of a break are pruned since they cannot
be part of a longer run than we have seen before.</p>
<p>Return <code class="docutils literal"><span class="pre">roh</span></code> with minimum of 50 snps, a minimum run length of 1 mb and a minimum sample depth of 20
for sample S138 (with default values for allowed number of HETS, UNKS and total depth).</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini roh --min-snps <span class="m">50</span> <span class="se">\</span>
           --min-gt-depth <span class="m">20</span> <span class="se">\</span>
                   --min-size <span class="m">1000000</span> <span class="se">\</span>
                   -s S138 <span class="se">\</span>
                   roh_run.db
chrom   start   end     sample  num_of_snps     density_per_kb  run_length_in_bp
chr2 <span class="m">233336080</span> <span class="m">234631638</span> S138 <span class="m">2583</span> 1.9953 1295558
chr2    <span class="m">238341281</span>       <span class="m">239522281</span>       S138    <span class="m">2899</span>    2.4555  1181000
</pre></div>
</div>
</div>
<div class="section" id="set-somatic-flag-somatic-variants">
<h2><code class="docutils literal"><span class="pre">set_somatic</span></code>: Flag somatic variants<a class="headerlink" href="#set-somatic-flag-somatic-variants" title="Permalink to this headline">¶</a></h2>
<p>Somatic mutations in a tumor-normal pair are variants that are present in
the tumor but not in the normal sample.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>1. This tool requires that you specify the sample layout via a PED file
when loading your VCF into GEMINI via:</p>
<p class="last"><code class="docutils literal"><span class="pre">gemini</span> <span class="pre">load</span> <span class="pre">-v</span> <span class="pre">my.vcf</span> <span class="pre">-p</span> <span class="pre">my.ped</span> <span class="pre">my.db</span></code></p>
</div>
<p><cite>Example PED file format for GEMINI</cite></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#Family_ID      Individual_ID   Paternal_ID     Maternal_ID     Sex     Phenotype       Ethnicity</span>
<span class="m">1</span>       Normal  -9      -9      <span class="m">0</span>       <span class="m">1</span>       -9
<span class="m">1</span>       Tumor   -9      -9      <span class="m">0</span>       <span class="m">2</span>       -9
</pre></div>
</div>
<div class="section" id="id13">
<h3><code class="docutils literal"><span class="pre">default</span> <span class="pre">behavior</span></code><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>By default, <code class="docutils literal"><span class="pre">set_somatic</span></code> simply marks variants that are genotyped as
homozygous reference in the normal sample and non-reference in the tumor.
More stringent somatic filtering criteria are available through tunable
command line parameters.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini set_somatic <span class="se">\</span>
    --min-depth <span class="m">30</span> <span class="se">\</span>
    --min-qual <span class="m">20</span> <span class="se">\</span>
    --min-somatic-score <span class="m">18</span> <span class="se">\</span>
    --min-tumor-depth <span class="m">10</span> <span class="se">\</span>
    --min-norm-depth <span class="m">10</span> <span class="se">\</span>
    tumor_normal.db
tum_name        tum_gt  tum_alt_freq    tum_alt_depth   tum_depth       nrm_name        nrm_gt  nrm_alt_freq    nrm_alt_depth   nrm_depth       chrom   start   end     ref     alt     gene
tumor   GAAAAAAAAAAAAAGGTGAAAATT/GAAAAAAAAAAAAGGTGAAAATT        0.217391304348  <span class="m">5</span>       <span class="m">23</span>      normal  GAAAAAAAAAAAAAGGTGAAAATT/GAAAAAAAAAAAAAGGTGAAAATT       0.0     <span class="m">0</span>       <span class="m">25</span>      chrX    <span class="m">132838304</span>       <span class="m">132838328</span>       GAAAAAAAAAAAAAGGTGAAAATT        GAAAAAAAAAAAAGGTGAAAATT GPC3
tumor   CTGCTATTTTG/CG  0.22    <span class="m">11</span>      <span class="m">50</span>      normal  CTGCTATTTTG/CTGCTATTTTG 0.0     <span class="m">0</span>       <span class="m">70</span>      chr17   <span class="m">59861630</span>        <span class="m">59861641</span>        CTGCTATTTTG     CG      BRIP1
tumor   C/A     0.555555555556  <span class="m">10</span>      <span class="m">18</span>      normal  C/C     0.0     <span class="m">0</span>       <span class="m">17</span>      chr17   <span class="m">7578460</span> <span class="m">7578461</span> C       A       TP53
tumor   C/T     0.1875  <span class="m">12</span>      <span class="m">64</span>      normal  C/C     0.0     <span class="m">0</span>       <span class="m">30</span>      chr2    <span class="m">128046288</span>       <span class="m">128046289</span>       C       T       ERCC3
Identified and <span class="nb">set </span><span class="m">4</span> somatic mutations
</pre></div>
</div>
</div>
<div class="section" id="min-depth-none">
<h3><code class="docutils literal"><span class="pre">--min-depth</span> <span class="pre">[None]</span></code><a class="headerlink" href="#min-depth-none" title="Permalink to this headline">¶</a></h3>
<p>The minimum required combined depth for tumor and normal samples.</p>
</div>
<div class="section" id="min-qual-none">
<h3><code class="docutils literal"><span class="pre">--min-qual</span> <span class="pre">[None]</span></code><a class="headerlink" href="#min-qual-none" title="Permalink to this headline">¶</a></h3>
<p>The minimum required variant quality score.</p>
</div>
<div class="section" id="min-somatic-score-none">
<h3><code class="docutils literal"><span class="pre">--min-somatic-score</span> <span class="pre">[None]</span></code><a class="headerlink" href="#min-somatic-score-none" title="Permalink to this headline">¶</a></h3>
<p>The minimum required somatic score (SSC). This score is produced by various
somatic variant detection algorithms including SpeedSeq, SomaticSniper,
and VarScan 2.</p>
</div>
<div class="section" id="max-norm-alt-freq-none">
<h3><code class="docutils literal"><span class="pre">--max-norm-alt-freq</span> <span class="pre">[None]</span></code><a class="headerlink" href="#max-norm-alt-freq-none" title="Permalink to this headline">¶</a></h3>
<p>The maximum frequency of the alternate allele allowed in the normal sample.</p>
</div>
<div class="section" id="max-norm-alt-count-none">
<h3><code class="docutils literal"><span class="pre">--max-norm-alt-count</span> <span class="pre">[None]</span></code><a class="headerlink" href="#max-norm-alt-count-none" title="Permalink to this headline">¶</a></h3>
<p>The maximum count of the alternate allele allowed in the normal sample.</p>
</div>
<div class="section" id="min-norm-depth-none">
<h3><code class="docutils literal"><span class="pre">--min-norm-depth</span> <span class="pre">[None]</span></code><a class="headerlink" href="#min-norm-depth-none" title="Permalink to this headline">¶</a></h3>
<p>The minimum depth required in the normal sample.</p>
</div>
<div class="section" id="min-tumor-alt-freq-none">
<h3><code class="docutils literal"><span class="pre">--min-tumor-alt-freq</span> <span class="pre">[None]</span></code><a class="headerlink" href="#min-tumor-alt-freq-none" title="Permalink to this headline">¶</a></h3>
<p>The minimum frequency of the alternate allele required in the tumor sample.</p>
</div>
<div class="section" id="min-tumor-alt-count-none">
<h3><code class="docutils literal"><span class="pre">--min-tumor-alt-count</span> <span class="pre">[None]</span></code><a class="headerlink" href="#min-tumor-alt-count-none" title="Permalink to this headline">¶</a></h3>
<p>The minimum count of the alternate allele required in the tumor sample.</p>
</div>
<div class="section" id="min-tumor-depth-none">
<h3><code class="docutils literal"><span class="pre">--min-tumor-depth</span> <span class="pre">[None]</span></code><a class="headerlink" href="#min-tumor-depth-none" title="Permalink to this headline">¶</a></h3>
<p>The minimum depth required in the tumor sample.</p>
</div>
<div class="section" id="chrom-none">
<h3><code class="docutils literal"><span class="pre">--chrom</span> <span class="pre">[None]</span></code><a class="headerlink" href="#chrom-none" title="Permalink to this headline">¶</a></h3>
<p>A specific chromosome on which to flag somatic mutations.</p>
</div>
<div class="section" id="dry-run">
<h3><code class="docutils literal"><span class="pre">--dry-run</span></code><a class="headerlink" href="#dry-run" title="Permalink to this headline">¶</a></h3>
<p>Don&#8217;t set the is_somatic flag, just report what _would_ be set. For testing
purposes.</p>
</div>
</div>
<div class="section" id="actionable-mutations-report-actionable-somatic-mutations-and-drug-gene-interactions">
<h2><code class="docutils literal"><span class="pre">actionable_mutations</span></code>: Report actionable somatic mutations and drug-gene interactions<a class="headerlink" href="#actionable-mutations-report-actionable-somatic-mutations-and-drug-gene-interactions" title="Permalink to this headline">¶</a></h2>
<p>Actionable mutations are somatic variants in COSMIC cancer census genes with
medium or high impact severity predictions. This tool reports actionable
mutations as well as their known drug interactions (if any) from DGIdb.
Current functionality is only for SNVs and indels.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic">
<li><dl class="first docutils">
<dt>This tool requires somatic variants to have been flagged using</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">set_somatic</span></code></p>
</dd>
</dl>
</li>
</ol>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini actionable_mutations tumor_normal.db
tum_name        chrom   start   end     ref     alt     gene    impact  is_somatic      in_cosmic_census        dgidb_info
tumor   chr2    <span class="m">128046288</span>       <span class="m">128046289</span>       C       T       ERCC3   non_syn_coding  <span class="m">1</span>       <span class="m">1</span>       None
tumor   chr17   <span class="m">7578460</span> <span class="m">7578461</span> C       A       TP53    non_syn_coding  <span class="m">1</span>       <span class="m">1</span>       <span class="o">{</span><span class="s1">&#39;searchTerm&#39;</span>: <span class="s1">&#39;TP53&#39;</span>, <span class="s1">&#39;geneCategories&#39;</span>: <span class="o">[</span><span class="s1">&#39;CLINICALLY ACTIONABLE&#39;</span>, <span class="s1">&#39;DRUGGABLE GENOME&#39;</span>, <span class="s1">&#39;TUMOR SUPPRESSOR&#39;</span>, <span class="s1">&#39;TRANSCRIPTION FACTOR COMPLEX&#39;</span>, <span class="s1">&#39;DRUG RESISTANCE&#39;</span>, <span class="s1">&#39;HISTONE MODIFICATION&#39;</span>, <span class="s1">&#39;DNA REPAIR&#39;</span>, <span class="s1">&#39;TRANSCRIPTION FACTOR BINDING&#39;</span><span class="o">]</span>, <span class="s1">&#39;geneName&#39;</span>: <span class="s1">&#39;TP53&#39;</span>, <span class="s1">&#39;geneLongName&#39;</span>: <span class="s1">&#39;tumor protein p53&#39;</span>, <span class="s1">&#39;interactions&#39;</span>: <span class="o">[{</span><span class="s1">&#39;source&#39;</span>: <span class="s1">&#39;DrugBank&#39;</span>, <span class="s1">&#39;interactionId&#39;</span>: <span class="s1">&#39;711cbe42-4930-4b46-963e-79ab35bbbd0f&#39;</span>, <span class="s1">&#39;interactionType&#39;</span>: <span class="s1">&#39;n/a&#39;</span>, <span class="s1">&#39;drugName&#39;</span>: <span class="s1">&#39;1-(9-ETHYL-9H-CARBAZOL-3-YL)-N-METHYLMETHANAMINE&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;source&#39;</span>: <span class="s1">&#39;PharmGKB&#39;</span>, <span class="s1">&#39;interactionId&#39;</span>: <span class="s1">&#39;8234d9b9-085d-49b1-aac2-cf5375d91477&#39;</span>, <span class="s1">&#39;interactionType&#39;</span>: <span class="s1">&#39;n/a&#39;</span>, <span class="s1">&#39;drugName&#39;</span>: <span class="s1">&#39;FLUOROURACIL&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;source&#39;</span>: <span class="s1">&#39;PharmGKB&#39;</span>, <span class="s1">&#39;interactionId&#39;</span>: <span class="s1">&#39;605d7bca-7ed9-428e-aa7c-f76aafd66b54&#39;</span>, <span class="s1">&#39;interactionType&#39;</span>: <span class="s1">&#39;n/a&#39;</span>, <span class="s1">&#39;drugName&#39;</span>: <span class="s1">&#39;PACLITAXEL&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;source&#39;</span>: <span class="s1">&#39;TTD&#39;</span>, <span class="s1">&#39;interactionId&#39;</span>: <span class="s1">&#39;1fe9db63-3581-435b-b22a-12d45c8c9864&#39;</span>, <span class="s1">&#39;interactionType&#39;</span>: <span class="s1">&#39;activator&#39;</span>, <span class="s1">&#39;drugName&#39;</span>: <span class="s1">&#39;CURAXIN CBLC102&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;source&#39;</span>: <span class="s1">&#39;TALC&#39;</span>, <span class="s1">&#39;interactionId&#39;</span>: <span class="s1">&#39;8f8f6822-cb9e-40aa-8360-5532e059f1e7&#39;</span>, <span class="s1">&#39;interactionType&#39;</span>: <span class="s1">&#39;vaccine&#39;</span>, <span class="s1">&#39;drugName&#39;</span>: <span class="s1">&#39;EP-2101&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;source&#39;</span>: <span class="s1">&#39;TALC&#39;</span>, <span class="s1">&#39;interactionId&#39;</span>: <span class="s1">&#39;d59e14bc-b9a5-4c9f-a5aa-7ba322f0fa0e&#39;</span>, <span class="s1">&#39;interactionType&#39;</span>: <span class="s1">&#39;vaccine&#39;</span>, <span class="s1">&#39;drugName&#39;</span>: <span class="s1">&#39;MUTANT P53 PEPTIDE PULSED DENDRITIC CELL&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;source&#39;</span>: <span class="s1">&#39;TALC&#39;</span>, <span class="s1">&#39;interactionId&#39;</span>: <span class="s1">&#39;79256b6e-9a16-4fbe-a237-28dbca28bc2a&#39;</span>, <span class="s1">&#39;interactionType&#39;</span>: <span class="s1">&#39;vaccine&#39;</span>, <span class="s1">&#39;drugName&#39;</span>: <span class="s1">&#39;AD.P53-DC&#39;</span><span class="o">}]}</span>
tumor   chr17   <span class="m">59861630</span>        <span class="m">59861641</span>        CTGCTATTTTG     CG      BRIP1   inframe_codon_loss      <span class="m">1</span>       <span class="m">1</span>       None
tumor   chrX    <span class="m">132838304</span>       <span class="m">132838328</span>       GAAAAAAAAAAAAAGGTGAAAATT        GAAAAAAAAAAAAGGTGAAAATT GPC3    splice_region   <span class="m">1</span>       <span class="m">1</span>       None
</pre></div>
</div>
</div>
<div class="section" id="fusions-report-putative-gene-fusions">
<h2><code class="docutils literal"><span class="pre">fusions</span></code>: Report putative gene fusions<a class="headerlink" href="#fusions-report-putative-gene-fusions" title="Permalink to this headline">¶</a></h2>
<p>Report putative somatic gene fusions from structural variants in a tumor-normal
pair. Putative fusions join two genes and preserve transcript strand
orientation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic">
<li><dl class="first docutils">
<dt>This tool requires somatic variants to have been flagged using</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">set_somatic</span></code></p>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="id14">
<h3><code class="docutils literal"><span class="pre">default</span> <span class="pre">behavior</span></code><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>By default, <code class="docutils literal"><span class="pre">fusions</span></code> reports structural variants that are flagged as
somatic, join two different genes, and preserve transcript strand orientation.
These may be further filtered using tunable command line parameters.</p>
<div class="highlight-bash"><div class="highlight"><pre>    <span class="nv">$ </span>gemini fusions <span class="se">\</span>
        --min_qual <span class="m">5</span> <span class="se">\</span>
        --in_cosmic_census <span class="se">\</span>
        tumor_normal.db
    chromA   breakpointA_start  breakpointA_end     chromB  breakpointB_start   breakpointB_end var_id  qual    strandA strandB sv_type geneA   geneB   tool    evidence_type   is_precise  sample
chr3        <span class="m">176909953</span>       <span class="m">176909982</span>       chr3    <span class="m">178906001</span>       <span class="m">178906030</span>       <span class="m">1233</span>    9.58    -       +       complex TBL1XR1 PIK3CA  LUMPY   PE      <span class="m">0</span>       tumor
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h3><code class="docutils literal"><span class="pre">--min_qual</span> <span class="pre">[None]</span></code><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>The minimum required variant quality score.</p>
</div>
<div class="section" id="evidence-type-string">
<h3><code class="docutils literal"><span class="pre">--evidence_type</span> <span class="pre">STRING</span></code><a class="headerlink" href="#evidence-type-string" title="Permalink to this headline">¶</a></h3>
<p>The required supporting evidence types for the variant from
LUMPY (&#8220;PE&#8221;, &#8220;SR&#8221;, or &#8220;PE,SR&#8221;).</p>
</div>
<div class="section" id="in-cosmic-census">
<h3><code class="docutils literal"><span class="pre">--in_cosmic_census</span></code><a class="headerlink" href="#in-cosmic-census" title="Permalink to this headline">¶</a></h3>
<p>Require at least one of the affected genes to be in the
COSMIC cancer gene census.</p>
</div>
</div>
<div class="section" id="db-info-list-the-gemini-database-tables-and-columns">
<h2><code class="docutils literal"><span class="pre">db_info</span></code>: List the gemini database tables and columns<a class="headerlink" href="#db-info-list-the-gemini-database-tables-and-columns" title="Permalink to this headline">¶</a></h2>
<p>Because of the sheer number of annotations that are stored in gemini, there are
admittedly too many columns to remember by rote.  If you can&#8217;t recall the name of
particular column, just use the <code class="docutils literal"><span class="pre">db_info</span></code> tool.  It will report all of the
tables and all of the columns / types in each table:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>gemini db_info test.db
table_name          column_name                   <span class="nb">type</span>
variants            chrom                         text
variants            start                         integer
variants            end                           integer
variants            variant_id                    integer
variants            anno_id                       integer
variants            ref                           text
variants            alt                           text
variants            qual                          float
variants            filter                        text
variants            <span class="nb">type                          </span>text
variants            sub_type                      text
variants            gts                           blob
variants            gt_types                      blob
variants            gt_phases                     blob
variants            gt_depths                     blob
variants            call_rate                     float
variants            in_dbsnp                      bool
variants            rs_ids                        text
variants            in_omim                       bool
variants            clin_sigs                     text
variants            cyto_band                     text
variants            rmsk                          text
variants            in_cpg_island                 bool
variants            in_segdup                     bool
variants            is_conserved                  bool
variants            num_hom_ref                   integer
variants            num_het                       integer
variants            num_hom_alt                   integer
variants            num_unknown                   integer
variants            aaf                           float
variants            hwe                           float
variants            inbreeding_coeff              float
variants            pi                            float
variants            recomb_rate                   float
variants            gene                          text
variants            transcript                    text
variants            is_exonic                     bool
variants            is_coding                     bool
variants            is_lof                        bool
variants            exon                          text
variants            codon_change                  text
variants            aa_change                     text
variants            aa_length                     text
variants            biotype                       text
variants            impact                        text
variants            impact_severity               text
variants            polyphen_pred                 text
variants            polyphen_score                float
variants            sift_pred                     text
variants            sift_score                    float
variants            anc_allele                    text
variants            rms_bq                        float
variants            cigar                         text
variants            depth                         integer
variants            strand_bias                   float
variants            rms_map_qual                  float
variants            in_hom_run                    integer
variants            num_mapq_zero                 integer
variants            num_alleles                   integer
variants            num_reads_w_dels              float
variants            haplotype_score               float
variants            qual_depth                    float
variants            allele_count                  integer
variants            allele_bal                    float
variants            in_hm2                        bool
variants            in_hm3                        bool
variants            is_somatic
variants            in_esp                        bool
variants            aaf_esp_ea                    float
variants            aaf_esp_aa                    float
variants            aaf_esp_all                   float
variants            exome_chip                    bool
variants            in_1kg                        bool
variants            aaf_1kg_amr                   float
variants            aaf_1kg_asn                   float
variants            aaf_1kg_afr                   float
variants            aaf_1kg_eur                   float
variants            aaf_1kg_all                   float
variants            grc                           text
variants            gms_illumina                  float
variants            gms_solid                     float
variants            gms_iontorrent                float
variants            encode_tfbs
variants            encode_consensus_gm12878      text
variants            encode_consensus_h1hesc       text
variants            encode_consensus_helas3       text
variants            encode_consensus_hepg2        text
variants            encode_consensus_huvec        text
variants            encode_consensus_k562         text
variants            encode_segway_gm12878         text
variants            encode_segway_h1hesc          text
variants            encode_segway_helas3          text
variants            encode_segway_hepg2           text
variants            encode_segway_huvec           text
variants            encode_segway_k562            text
variants            encode_chromhmm_gm12878       text
variants            encode_chromhmm_h1hesc        text
variants            encode_chromhmm_helas3        text
variants            encode_chromhmm_hepg2         text
variants            encode_chromhmm_huvec         text
variants            encode_chromhmm_k562          text
variant_impacts     variant_id                    integer
variant_impacts     anno_id                       integer
variant_impacts     gene                          text
variant_impacts     transcript                    text
variant_impacts     is_exonic                     bool
variant_impacts     is_coding                     bool
variant_impacts     is_lof                        bool
variant_impacts     exon                          text
variant_impacts     codon_change                  text
variant_impacts     aa_change                     text
variant_impacts     aa_length                     text
variant_impacts     biotype                       text
variant_impacts     impact                        text
variant_impacts     impact_severity               text
variant_impacts     polyphen_pred                 text
variant_impacts     polyphen_score                float
variant_impacts     sift_pred                     text
variant_impacts     sift_score                    float
samples             sample_id                     integer
samples             name                          text
samples             family_id                     integer
samples             paternal_id                   integer
samples             maternal_id                   integer
samples             sex                           text
samples             phenotype                     text
samples             ethnicity                     text
</pre></div>
</div>
</div>
</div>




  

<div id="disqus_thread"></div>
 <script type="text/javascript">
     /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
     var disqus_shortname = 'geminidocs'; // required: replace example with your forum shortname

     /* * * DON'T EDIT BELOW THIS LINE * * */
     (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
 </script>
 <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>






          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/gemini.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Built-in analysis tools</a><ul>
<li><a class="reference internal" href="#common-args-common-arguments"><code class="docutils literal"><span class="pre">common_args</span></code>: common arguments</a><ul>
<li><a class="reference internal" href="#columns"><code class="docutils literal"><span class="pre">--columns</span></code></a></li>
<li><a class="reference internal" href="#min-kindreds-1"><code class="docutils literal"><span class="pre">--min-kindreds</span> <span class="pre">1</span></code></a></li>
<li><a class="reference internal" href="#families"><code class="docutils literal"><span class="pre">--families</span></code></a></li>
<li><a class="reference internal" href="#filter"><code class="docutils literal"><span class="pre">--filter</span></code></a></li>
<li><a class="reference internal" href="#d-0-depth"><code class="docutils literal"><span class="pre">-d</span> <span class="pre">[0]</span></code> (depth)</a></li>
<li><a class="reference internal" href="#min-gq-0"><code class="docutils literal"><span class="pre">--min-gq</span> <span class="pre">[0]</span></code></a></li>
<li><a class="reference internal" href="#allow-unaffected"><code class="docutils literal"><span class="pre">--allow-unaffected</span></code></a></li>
<li><a class="reference internal" href="#lenient"><code class="docutils literal"><span class="pre">--lenient</span></code></a></li>
<li><a class="reference internal" href="#gt-pl-max"><code class="docutils literal"><span class="pre">--gt-pl-max</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#comp-hets-identifying-potential-compound-heterozygotes"><code class="docutils literal"><span class="pre">comp_hets</span></code>: Identifying potential compound heterozygotes</a><ul>
<li><a class="reference internal" href="#genotype-requirements">Genotype Requirements</a></li>
<li><a class="reference internal" href="#pattern-only">Pattern Only</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mendelian-error-identify-non-mendelian-transmission"><code class="docutils literal"><span class="pre">mendelian_error</span></code>: Identify non-mendelian transmission.</a><ul>
<li><a class="reference internal" href="#id1">Genotype Requirements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#de-novo-identifying-potential-de-novo-mutations"><code class="docutils literal"><span class="pre">de_novo</span></code>: Identifying potential de novo mutations.</a><ul>
<li><a class="reference internal" href="#id2">Genotype Requirements</a></li>
<li><a class="reference internal" href="#example">example</a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal"><span class="pre">example</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal"><span class="pre">example</span></code></a></li>
<li><a class="reference internal" href="#id5"><code class="docutils literal"><span class="pre">example</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#autosomal-recessive-find-variants-meeting-an-autosomal-recessive-model"><code class="docutils literal"><span class="pre">autosomal_recessive</span></code>: Find variants meeting an autosomal recessive model.</a><ul>
<li><a class="reference internal" href="#id6">Genotype Requirements</a></li>
<li><a class="reference internal" href="#default-behavior"><code class="docutils literal"><span class="pre">default</span> <span class="pre">behavior</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#autosomal-dominant-find-variants-meeting-an-autosomal-dominant-model"><code class="docutils literal"><span class="pre">autosomal_dominant</span></code>: Find variants meeting an autosomal dominant model.</a><ul>
<li><a class="reference internal" href="#id7">Genotype Requirements</a></li>
<li><a class="reference internal" href="#id8"><code class="docutils literal"><span class="pre">default</span> <span class="pre">behavior</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gene-wise-custom-genotype-filtering-by-gene"><code class="docutils literal"><span class="pre">gene_wise</span></code>: Custom genotype filtering by gene.</a></li>
<li><a class="reference internal" href="#pathways-map-genes-and-variants-to-kegg-pathways"><code class="docutils literal"><span class="pre">pathways</span></code>: Map genes and variants to KEGG pathways.</a><ul>
<li><a class="reference internal" href="#lof"><code class="docutils literal"><span class="pre">--lof</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#interactions-find-genes-among-variants-that-are-interacting-partners"><code class="docutils literal"><span class="pre">interactions</span></code>: Find genes among variants that are interacting partners.</a><ul>
<li><a class="reference internal" href="#lof-interactions"><code class="docutils literal"><span class="pre">lof_interactions</span></code></a></li>
<li><a class="reference internal" href="#var"><code class="docutils literal"><span class="pre">--var</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#lof-sieve-filter-lof-variants-by-transcript-position-and-type"><code class="docutils literal"><span class="pre">lof_sieve</span></code>: Filter LoF variants by transcript position and type</a></li>
<li><a class="reference internal" href="#amend-updating-changing-the-sample-information"><code class="docutils literal"><span class="pre">amend</span></code>: updating / changing the sample information</a></li>
<li><a class="reference internal" href="#annotate-adding-your-own-custom-annotations"><code class="docutils literal"><span class="pre">annotate</span></code>: adding your own custom annotations</a><ul>
<li><a class="reference internal" href="#a-boolean-did-a-variant-overlap-a-region-or-not"><code class="docutils literal"><span class="pre">-a</span> <span class="pre">boolean</span></code> Did a variant overlap a region or not?</a></li>
<li><a class="reference internal" href="#a-count-how-many-regions-did-a-variant-overlap"><code class="docutils literal"><span class="pre">-a</span> <span class="pre">count</span></code> How many regions did a variant overlap?</a></li>
<li><a class="reference internal" href="#a-extract-extract-specific-values-from-a-bed-file"><code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code> Extract specific values from a BED file</a></li>
<li><a class="reference internal" href="#t-type-specifying-the-column-type-s-when-using-a-extract"><code class="docutils literal"><span class="pre">-t</span> <span class="pre">TYPE</span></code> Specifying the column type(s) when using <code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code></a></li>
<li><a class="reference internal" href="#o-operation-specifying-the-summary-operations-when-using-a-extract"><code class="docutils literal"><span class="pre">-o</span> <span class="pre">OPERATION</span></code> Specifying the summary operations when using <code class="docutils literal"><span class="pre">-a</span> <span class="pre">extract</span></code></a></li>
<li><a class="reference internal" href="#annotating-with-vcf">Annotating with VCF</a></li>
<li><a class="reference internal" href="#extracting-and-populating-multiple-columns-at-once">Extracting and populating multiple columns at once.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#region-extracting-variants-from-specific-regions-or-genes"><code class="docutils literal"><span class="pre">region</span></code>: Extracting variants from specific regions or genes</a><ul>
<li><a class="reference internal" href="#reg"><code class="docutils literal"><span class="pre">--reg</span></code></a></li>
<li><a class="reference internal" href="#gene"><code class="docutils literal"><span class="pre">--gene</span></code></a></li>
<li><a class="reference internal" href="#id9"><code class="docutils literal"><span class="pre">--columns</span></code></a></li>
<li><a class="reference internal" href="#id10"><code class="docutils literal"><span class="pre">--filter</span></code></a></li>
<li><a class="reference internal" href="#json"><code class="docutils literal"><span class="pre">--json</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#windower-conducting-analyses-on-genome-windows"><code class="docutils literal"><span class="pre">windower</span></code>: Conducting analyses on genome &#8220;windows&#8221;.</a></li>
<li><a class="reference internal" href="#stats-compute-useful-variant-statistics"><code class="docutils literal"><span class="pre">stats</span></code>: Compute useful variant statistics.</a><ul>
<li><a class="reference internal" href="#tstv-coding"><code class="docutils literal"><span class="pre">--tstv-coding</span></code></a></li>
<li><a class="reference internal" href="#tstv-noncoding"><code class="docutils literal"><span class="pre">--tstv-noncoding</span></code></a></li>
<li><a class="reference internal" href="#summarize"><code class="docutils literal"><span class="pre">--summarize</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#burden-perform-sample-wise-gene-level-burden-calculations"><code class="docutils literal"><span class="pre">burden</span></code>: perform sample-wise gene-level burden calculations</a><ul>
<li><a class="reference internal" href="#nonsynonymous"><code class="docutils literal"><span class="pre">--nonsynonymous</span></code></a></li>
<li><a class="reference internal" href="#calpha"><code class="docutils literal"><span class="pre">--calpha</span></code></a></li>
<li><a class="reference internal" href="#min-aaf-and-max-aaf-for-calpha"><code class="docutils literal"><span class="pre">--min-aaf</span></code> and <code class="docutils literal"><span class="pre">--max-aaf</span></code> for <code class="docutils literal"><span class="pre">--calpha</span></code></a></li>
<li><a class="reference internal" href="#cases-and-controls-for-calpha"><code class="docutils literal"><span class="pre">--cases</span></code> and <code class="docutils literal"><span class="pre">--controls</span> <span class="pre">for</span> <span class="pre">``--calpha</span></code></a></li>
<li><a class="reference internal" href="#nonsynonymous-calpha"><code class="docutils literal"><span class="pre">--nonsynonymous</span></code> <code class="docutils literal"><span class="pre">--calpha</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#roh-identifying-runs-of-homozygosity"><code class="docutils literal"><span class="pre">ROH</span></code>: Identifying runs of homozygosity</a></li>
<li><a class="reference internal" href="#set-somatic-flag-somatic-variants"><code class="docutils literal"><span class="pre">set_somatic</span></code>: Flag somatic variants</a><ul>
<li><a class="reference internal" href="#id13"><code class="docutils literal"><span class="pre">default</span> <span class="pre">behavior</span></code></a></li>
<li><a class="reference internal" href="#min-depth-none"><code class="docutils literal"><span class="pre">--min-depth</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#min-qual-none"><code class="docutils literal"><span class="pre">--min-qual</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#min-somatic-score-none"><code class="docutils literal"><span class="pre">--min-somatic-score</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#max-norm-alt-freq-none"><code class="docutils literal"><span class="pre">--max-norm-alt-freq</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#max-norm-alt-count-none"><code class="docutils literal"><span class="pre">--max-norm-alt-count</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#min-norm-depth-none"><code class="docutils literal"><span class="pre">--min-norm-depth</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#min-tumor-alt-freq-none"><code class="docutils literal"><span class="pre">--min-tumor-alt-freq</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#min-tumor-alt-count-none"><code class="docutils literal"><span class="pre">--min-tumor-alt-count</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#min-tumor-depth-none"><code class="docutils literal"><span class="pre">--min-tumor-depth</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#chrom-none"><code class="docutils literal"><span class="pre">--chrom</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#dry-run"><code class="docutils literal"><span class="pre">--dry-run</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#actionable-mutations-report-actionable-somatic-mutations-and-drug-gene-interactions"><code class="docutils literal"><span class="pre">actionable_mutations</span></code>: Report actionable somatic mutations and drug-gene interactions</a></li>
<li><a class="reference internal" href="#fusions-report-putative-gene-fusions"><code class="docutils literal"><span class="pre">fusions</span></code>: Report putative gene fusions</a><ul>
<li><a class="reference internal" href="#id14"><code class="docutils literal"><span class="pre">default</span> <span class="pre">behavior</span></code></a></li>
<li><a class="reference internal" href="#id15"><code class="docutils literal"><span class="pre">--min_qual</span> <span class="pre">[None]</span></code></a></li>
<li><a class="reference internal" href="#evidence-type-string"><code class="docutils literal"><span class="pre">--evidence_type</span> <span class="pre">STRING</span></code></a></li>
<li><a class="reference internal" href="#in-cosmic-census"><code class="docutils literal"><span class="pre">--in_cosmic_census</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#db-info-list-the-gemini-database-tables-and-columns"><code class="docutils literal"><span class="pre">db_info</span></code>: List the gemini database tables and columns</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="querying.html"
                        title="previous chapter">Querying the GEMINI database</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="browser.html"
                        title="next chapter">The GEMINI browser interface</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/content/tools.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="browser.html" title="The GEMINI browser interface"
             >next</a> |</li>
        <li class="right" >
          <a href="querying.html" title="Querying the GEMINI database"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">gemini v0.18.1</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2012,2013,2014,2015.
      Last updated on Feb 03, 2016.
    <a href="http://www.gnu.org/licenses/gpl-3.0.txt"><p>GPL3 licensed</p></a>
    </div>

<!-- 
<div id="editor-trap">
      <h3>Edit and improve this document!</h3>

      <p>
        This file can be edited directly through the Web. Anyone can
        update and fix errors in this document with few clicks --
        no downloads needed.
      <p>

      <ol>

        <li>
          Go to
        <a href="https://github.com/arq5x/gemini/blob/master/docs/content/tools.rst">
          Built-in analysis tools
        </a> on GitHub.
      </li>

        <li>
        <b>Edit</b> files using GitHub's text editor in your web browser (see the 'Edit' tab on the top right of the file)
      </li>

      <li>
        Fill in the <b>Commit message</b> text box at the bottom of the page describing <i>why</i>
        you made the changes. Press the <b>Propose file change</b> button next to it when done.
      </li>

      <li>
        Then click <b>Send a pull request</b>.
      </li>

      <li>
        Your changes are now queued for review under the project's <a href="https://github.com/arq5x/gemini/pulls">Pull requests</a> tab on GitHub!
      </li>
      </ol>

      <p>
        For an introduction to the documentation format please see <a href="http://docutils.sourceforge.net/docs/user/rst/quickstart.html">the reST primer</a>.
      </p>

  </div>
 -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', UA-39150563-1]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


  </body>
</html>