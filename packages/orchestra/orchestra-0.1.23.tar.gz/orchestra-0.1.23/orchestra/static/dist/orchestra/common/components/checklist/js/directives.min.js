!function(){"use strict";function t(t,e,n,o){return{restrict:"E",scope:{data:"=",author:"@?",imagePrefix:"@?"},link:function(t,n,i){var a={title:"Update the hero image (This is a sample item! Click on the text to edit or click to the right to expand.)",comments:[{author:"jane",timestamp:new Date(new Date-108e5),text:"The hero image you've chosen doesn't fit well with the color scheme. Try something less washed out?"},{author:"john",timestamp:new Date(new Date-72e5),text:"Sounds good! I swapped it out, what do you think? "},{author:"",text:"This is a sample checklist comment. You can add a new comment for each new round of iteration on your work!"}],checked:!1,expanded:!1,readonly:!0,index:0,order:0};t.data=t.data||{},t.data.items=t.data.items||[a],t.data.deletedItems=t.data.deletedItems||[],t.hideCompleted=!1,o.signals.registerSignal("submit.before",function(){t.data.items.forEach(function(e){e.comments[e.comments.length-1].text&&(e.comments[e.comments.length-1].author=t.author,e.comments[e.comments.length-1].timestamp=Date.now(),e.comments.push({author:"",text:""}))})}),o.signals.registerSignal("submit.error",function(){t.data.items.forEach(function(t){t.comments[t.comments.length-1].text&&(t.comments.pop(),t.comments[t.comments.length-1].author="",t.comments[t.comments.length-1].timestamp=void 0)})}),t.preventAction=!1;var r=n.find("ul.checklist"),s=dragula([r.get(0)],{moves:function(t,e,n){return n.className.indexOf("checklist-item")>=0||n.className.indexOf("item-title-input")>=0&&n.className.indexOf("readonly")>=0||n.className.indexOf("item-title")>=0&&n.className.indexOf("item-title-input")<0},invalid:function(e,n){return t.preventAction}});s.on("drag",function(){t.preventAction=!0,t.$apply()}),s.on("dragend",function(){c(),t.preventAction=!1,t.$apply()});var c=function(){for(var t=n.get(0).querySelectorAll(".checklist-item"),e=0;e<t.length;e++){var o=t[e];m(o.getAttribute("data-key")).order=e}},m=function(e){for(var n,o=t.data.items.length-1;o>=0;o--)if(n=t.data.items[o],n.$$hashKey===e)return n};t.addItem=function(){t.data.items.push({title:"",comments:[{author:t.author,text:""}],checked:!1,expanded:!1,readonly:!0,order:t.data.items.length})},t.removeItem=function(n,o){var i=t.data.items.indexOf(n);o&&!confirm("Are you sure you want to delete this item?")||(t.preventAction=!0,t.data.items.splice(i,1),t.data.deletedItems.push(n),e(function(){c(),t.preventAction=!1},0,!1))},t.editItem=function(e,n){e.readonly&&(n&&n.target.focus(),t.data.items.forEach(function(t){t.readonly=!0})),e.readonly=!e.readonly},t.expandItem=function(e){e.expanded=!e.expanded,t.data.items.forEach(function(t){t.readonly=!0})},t.getCommentTimestamp=function(t){return new Date(t.timestamp).toLocaleString()}},templateUrl:"/static/orchestra/common/components/checklist/partials/checklist.html"}}function e(t,e,n,o){return{restrict:"E",link:function(t,n,o){t.autosizeInput=function(t,e,n,o){function i(t){return t.replace(a,"&nbsp;").replace(r,"&lt;").replace(s,"&gt;")}var a=/\s/g,r=/>/g,s=/</g;o=o||t.value||"";var c=window.getComputedStyle(t),m="font-family:"+c.fontFamily+";font-size:"+c.fontSize;e.style.cssText+=m,e.innerHTML=i(o);var d=window.getComputedStyle(e).width;return"0px"===d&&(d=n),t.style.width=d,d},t.setupAutosizer=function(n){var o=document.createElement("div");o.className="ghost",o.style.cssText="box-sizing:content-box;display:inline-block;height:0;overflow:hidden;position:absolute;top:0;visibility:hidden;white-space:nowrap;",document.body.appendChild(o),n.style.boxSizing="content-box";var i=t.autosizeInput(n,o,0,n.getAttribute("placeholder"));n.addEventListener("input",function(){t.autosizeInput(n,o,i)}),e(function(){t.autosizeInput(n,o,i)},0)},t.setupAutosizer(n.find(".item-title input").get(0))},templateUrl:"/static/orchestra/common/components/checklist/partials/checklist-item.html"}}angular.module("orchestra.common.components.directives").directive("orchestraChecklist",["$http","$timeout","$compile","orchestraService",t]),angular.module("orchestra.common.components.directives").directive("orchestraChecklistItem",["$http","$timeout","$compile","orchestraService",e])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9yY2hlc3RyYS9jb21tb24vY29tcG9uZW50cy9jaGVja2xpc3QvanMvZGlyZWN0aXZlcy5qcyJdLCJuYW1lcyI6WyJvcmNoZXN0cmFDaGVja2xpc3QiLCIkaHR0cCIsIiR0aW1lb3V0IiwiJGNvbXBpbGUiLCJvcmNoZXN0cmFTZXJ2aWNlIiwicmVzdHJpY3QiLCJzY29wZSIsImRhdGEiLCJhdXRob3IiLCJpbWFnZVByZWZpeCIsImxpbmsiLCJlbCIsImF0dHIiLCJzYW1wbGVJdGVtIiwidGl0bGUiLCJjb21tZW50cyIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0ZXh0IiwiY2hlY2tlZCIsImV4cGFuZGVkIiwicmVhZG9ubHkiLCJpbmRleCIsIm9yZGVyIiwiaXRlbXMiLCJkZWxldGVkSXRlbXMiLCJoaWRlQ29tcGxldGVkIiwic2lnbmFscyIsInJlZ2lzdGVyU2lnbmFsIiwiZm9yRWFjaCIsIml0ZW0iLCJsZW5ndGgiLCJub3ciLCJwdXNoIiwicG9wIiwidW5kZWZpbmVkIiwicHJldmVudEFjdGlvbiIsImNoZWNrbGlzdENvbnRhaW5lciIsImZpbmQiLCJkcmFrZSIsImRyYWd1bGEiLCJnZXQiLCJtb3ZlcyIsImNvbnRhaW5lciIsImhhbmRsZSIsImNsYXNzTmFtZSIsImluZGV4T2YiLCJpbnZhbGlkIiwidGFyZ2V0Iiwib24iLCIkYXBwbHkiLCJzZXRPcmRlciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpIiwiZ2V0SXRlbUJ5S2V5IiwiZ2V0QXR0cmlidXRlIiwia2V5IiwiJCRoYXNoS2V5IiwiYWRkSXRlbSIsInJlbW92ZUl0ZW0iLCJjb25maXJtX25lZWRlZCIsImNvbmZpcm0iLCJzcGxpY2UiLCJlZGl0SXRlbSIsIiRldmVudCIsImZvY3VzIiwic2NvcGVJdGVtIiwiZXhwYW5kSXRlbSIsImdldENvbW1lbnRUaW1lc3RhbXAiLCJjb21tZW50IiwidG9Mb2NhbGVTdHJpbmciLCJ0ZW1wbGF0ZVVybCIsIm9yY2hlc3RyYUNoZWNrbGlzdEl0ZW0iLCJhdXRvc2l6ZUlucHV0IiwiZWxlbSIsImdob3N0IiwibWluV2lkdGgiLCJzdHIiLCJlc2NhcGUiLCJyZXBsYWNlIiwiU1BBQ0UiLCJMRVNTX1RIQU4iLCJNT1JFX1RIQU4iLCJ2YWx1ZSIsImVsZW1TdHlsZSIsIndpbmRvdyIsImdldENvbXB1dGVkU3R5bGUiLCJlbGVtQ3NzVGV4dCIsImZvbnRGYW1pbHkiLCJmb250U2l6ZSIsInN0eWxlIiwiY3NzVGV4dCIsImlubmVySFRNTCIsIndpZHRoIiwic2V0dXBBdXRvc2l6ZXIiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJib3hTaXppbmciLCJhZGRFdmVudExpc3RlbmVyIiwiYW5ndWxhciIsIm1vZHVsZSIsImRpcmVjdGl2ZSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDRSxZQU1BLFNBQVNBLEdBQW1CQyxFQUFPQyxFQUFVQyxFQUFVQyxHQUNyRCxPQUNFQyxTQUFVLElBQ1ZDLE9BQ0VDLEtBQVEsSUFDUkMsT0FBVSxLQUNWQyxZQUFlLE1BRWpCQyxLQUFNLFNBQVNKLEVBQU9LLEVBQUlDLEdBQ3hCLEdBQUlDLElBQ0ZDLE1BQVMsNEdBR1RDLFdBRWdCUCxPQUFVLE9BQ1ZRLFVBQWEsR0FBSUMsTUFBSyxHQUFJQSxNQUFTLE9BQ25DQyxLQUFRLHdHQUtSVixPQUFVLE9BQ1ZRLFVBQWEsR0FBSUMsTUFBSyxHQUFJQSxNQUFTLE1BQ25DQyxLQUFRLHVEQUlSVixPQUFVLEdBQ1ZVLEtBQVEsZ0hBS3hCQyxTQUFXLEVBQ1hDLFVBQVksRUFDWkMsVUFBWSxFQUNaQyxNQUFTLEVBQ1RDLE1BQVMsRUFJWGpCLEdBQU1DLEtBQU9ELEVBQU1DLFNBQ25CRCxFQUFNQyxLQUFLaUIsTUFBUWxCLEVBQU1DLEtBQUtpQixRQUFVWCxHQUN4Q1AsRUFBTUMsS0FBS2tCLGFBQWVuQixFQUFNQyxLQUFLa0IsaUJBQ3JDbkIsRUFBTW9CLGVBQWdCLEVBR3RCdEIsRUFBaUJ1QixRQUFRQyxlQUFlLGdCQUFpQixXQUN2RHRCLEVBQU1DLEtBQUtpQixN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QUdyRW1CLEdBQUswQixpQkFBaUIsUUFBUyxXQUM3QjlGLEVBQU1tRSxjQUFjQyxFQUFNQyxFQUFPQyxLQUluQzFFLEVBQVMsV0FDUEksRUFBTW1FLGNBQWNDLEVBQU1DLEVBQU9DLElBQ2hDLElBR0x0RSxFQUFNd0YsZUFBZW5GLEVBQUcyQixLQUFLLHFCQUFxQkcsSUFBSSxLQUV4RDhCLFlBQWEsOEVBL1BqQjhCLFFBQ0dDLE9BQU8sMENBQ1BDLFVBQVUsc0JBQXVCLFFBQVMsV0FBWSxXQUFZLG1CQUFvQnZHLElBb0x6RnFHLFFBQ0dDLE9BQU8sMENBQ1BDLFVBQVUsMEJBQTJCLFFBQVMsV0FBWSxXQUFZLG1CQUFvQi9CIiwiZmlsZSI6Im9yY2hlc3RyYS9jb21tb24vY29tcG9uZW50cy9jaGVja2xpc3QvanMvZGlyZWN0aXZlcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ29yY2hlc3RyYS5jb21tb24uY29tcG9uZW50cy5kaXJlY3RpdmVzJylcbiAgICAuZGlyZWN0aXZlKCdvcmNoZXN0cmFDaGVja2xpc3QnLCBbJyRodHRwJywgJyR0aW1lb3V0JywgJyRjb21waWxlJywgJ29yY2hlc3RyYVNlcnZpY2UnLCBvcmNoZXN0cmFDaGVja2xpc3RdKTtcblxuICBmdW5jdGlvbiBvcmNoZXN0cmFDaGVja2xpc3QoJGh0dHAsICR0aW1lb3V0LCAkY29tcGlsZSwgb3JjaGVzdHJhU2VydmljZSkge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgJ2RhdGEnOiAnPScsXG4gICAgICAgICdhdXRob3InOiAnQD8nLFxuICAgICAgICAnaW1hZ2VQcmVmaXgnOiAnQD8nLFxuICAgICAgfSxcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbCwgYXR0cikge1xuICAgICAgICB2YXIgc2FtcGxlSXRlbSA9IHtcbiAgICAgICAgICAndGl0bGUnOiAnVXBkYXRlIHRoZSBoZXJvIGltYWdlICcgK1xuICAgICAgICAgICAgICAgICAgICcoVGhpcyBpcyBhIHNhbXBsZSBpdGVtISBDbGljayBvbiB0aGUgdGV4dCB0byBlZGl0IG9yICcgK1xuICAgICAgICAgICAgICAgICAgICdjbGljayB0byB0aGUgcmlnaHQgdG8gZXhwYW5kLiknLFxuICAgICAgICAgICdjb21tZW50cyc6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2F1dGhvcic6ICdqYW5lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RpbWVzdGFtcCc6IG5ldyBEYXRlKG5ldyBEYXRlKCkgLSAzKjYwKjYwKjEwMDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAndGV4dCc6IFwiVGhlIGhlcm8gaW1hZ2UgeW91J3ZlIGNob3NlbiBkb2Vzbid0IGZpdCBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dlbGwgd2l0aCB0aGUgY29sb3Igc2NoZW1lLiBUcnkgc29tZXRoaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsZXNzIHdhc2hlZCBvdXQ/J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2F1dGhvcic6ICdqb2huJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RpbWVzdGFtcCc6IG5ldyBEYXRlKG5ldyBEYXRlKCkgLSAyKjYwKjYwKjEwMDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAndGV4dCc6ICdTb3VuZHMgZ29vZCEgSSBzd2FwcGVkIGl0IG91dCwgd2hhdCBkbyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAneW91IHRoaW5rPyAnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnYXV0aG9yJzogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICd0ZXh0JzogJ1RoaXMgaXMgYSBzYW1wbGUgY2hlY2tsaXN0IGNvbW1lbnQuICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdZb3UgY2FuIGFkZCBhIG5ldyBjb21tZW50IGZvciBlYWNoIG5ldyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncm91bmQgb2YgaXRlcmF0aW9uIG9uIHlvdXIgd29yayEnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAnY2hlY2tlZCc6IGZhbHNlLFxuICAgICAgICAgICdleHBhbmRlZCc6IGZhbHNlLFxuICAgICAgICAgICdyZWFkb25seSc6IHRydWUsXG4gICAgICAgICAgJ2luZGV4JzogMCxcbiAgICAgICAgICAnb3JkZXInOiAwXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBjaGVja2xpc3QgZGF0YSBmb3IgYSBmcmVzaCB0YXNrXG4gICAgICAgIHNjb3BlLmRhdGEgPSBzY29wZS5kYXRhIHx8IHt9O1xuICAgICAgICBzY29wZS5kYXRhLml0ZW1zID0gc2NvcGUuZGF0YS5pdGVtcyB8fCBbc2FtcGxlSXRlbV07XG4gICAgICAgIHNjb3BlLmRhdGEuZGVsZXRlZEl0ZW1zID0gc2NvcGUuZGF0YS5kZWxldGVkSXRlbXMgfHwgW107XG4gICAgICAgIHNjb3BlLmhpZGVDb21wbGV0ZWQgPSBmYWxzZTtcblxuICAgICAgICAvLyBQcmVwYXJlIGRhdGEgZm9yIHN1Ym1pdFxuICAgICAgICBvcmNoZXN0cmFTZXJ2aWNlLnNpZ25hbHMucmVnaXN0ZXJTaWduYWwoJ3N1Ym1pdC5iZWZvcmUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBzY29wZS5kYXRhLml0ZW1zLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgLy8gQWRkIGF1dGhvciBhbmQgZGF0ZSBpbmZvcm1hdGlvbiB0byB0aGUgbGF0ZXN0IGNvbW1lbnQuIFRoZW4sXG4gICAgICAgICAgICAvLyBjcmVhdGUgYSBuZXcgY29tbWVudCBzcGFjZSBmb3IgdGhlIG5leHQgd29ya2VyLlxuICAgICAgICAgICAgaWYgKGl0ZW0uY29tbWVudHNbaXRlbS5jb21tZW50cy5sZW5ndGggLSAxXS50ZXh0KSB7XG4gICAgICAgICAgICAgIGl0ZW0uY29tbWVudHNbaXRlbS5jb21tZW50cy5sZW5ndGggLSAxXS5hdXRob3IgPSBzY29wZS5hdXRob3I7XG4gICAgICAgICAgICAgIGl0ZW0uY29tbWVudHNbaXRlbS5jb21tZW50cy5sZW5ndGggLSAxXS50aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgICBpdGVtLmNvbW1lbnRzLnB1c2goeydhdXRob3InOiAnJywgJ3RleHQnOiAnJ30pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBvcmNoZXN0cmFTZXJ2aWNlLnNpZ25hbHMucmVnaXN0ZXJTaWduYWwoJ3N1Ym1pdC5lcnJvcicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHNjb3BlLmRhdGEuaXRlbXMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAvLyBSZXZlcnQgY29tbWVudCBjaGFuZ2VzIGZyb20gc3VibWl0LmJlZm9yZSBoYW5kbGVyXG4gICAgICAgICAgICBpZiAoaXRlbS5jb21tZW50c1tpdGVtLmNvbW1lbnRzLmxlbmd0aCAtIDFdLnRleHQpIHtcbiAgICAgICAgICAgICAgaXRlbS5jb21tZW50cy5wb3AoKTtcbiAgICAgICAgICAgICAgaXRlbS5jb21tZW50c1tpdGVtLmNvbW1lbnRzLmxlbmd0aCAtIDFdLmF1dGhvciA9ICcnO1xuICAgICAgICAgICAgICBpdGVtLmNvbW1lbnRzW2l0ZW0uY29tbWVudHMubGVuZ3RoIC0gMV0udGltZXN0YW1wID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTZXR1cCBkcmFnIHRvIHJlb3JkZXJcbiAgICAgICAgc2NvcGUucHJldmVudEFjdGlvbiA9IGZhbHNlO1xuICAgICAgICB2YXIgY2hlY2tsaXN0Q29udGFpbmVyID0gZWwuZmluZCgndWwuY2hlY2tsaXN0Jyk7XG4gICAgICAgIHZhciBkcmFrZSA9IGRyYWd1bGEoW2NoZWNrbGlzdENvbnRhaW5lci5nZXQoMCldLCB7XG4gICAgICAgICAgbW92ZXM6IGZ1bmN0aW9uIChlbCwgY29udGFpbmVyLCBoYW5kbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBoYW5kbGUuY2xhc3NOYW1lLmluZGV4T2YoJ2NoZWNrbGlzdC1pdGVtJykgPj0gMFxuICAgICAgICAgICAgICAgICAgIC8vIEl0ZW0gdGl0bGUgaW5wdXQgb25seSB3aGVuIHJlYWRvbmx5IChzbyB1c2VyIGNhbiBzZWxlY3QgdGV4dCB3aXRoaW4gaW5wdXQpXG4gICAgICAgICAgICAgICAgICAgfHwgKGhhbmRsZS5jbGFzc05hbWUuaW5kZXhPZignaXRlbS10aXRsZS1pbnB1dCcpID49IDBcbiAgICAgICAgICAgICAgICAgICAgICAgJiYgaGFuZGxlLmNsYXNzTmFtZS5pbmRleE9mKCdyZWFkb25seScpID49IDApXG4gICAgICAgICAgICAgICAgICAgLy8gSXRlbSB0aXRsZSBjb250YWluZXIgb3V0c2lkZSBvZiBpbnB1dFxuICAgICAgICAgICAgICAgICAgIHx8IChoYW5kbGUuY2xhc3NOYW1lLmluZGV4T2YoJ2l0ZW0tdGl0bGUnKSA+PSAwXG4gICAgICAgICAgICAgICAgICAgICAgICYmIGhhbmRsZS5jbGFzc05hbWUuaW5kZXhPZignaXRlbS10aXRsZS1pbnB1dCcpIDwgMCk7XG5cbiAgICAgICAgICB9LFxuICAgICAgICAgIGludmFsaWQ6IGZ1bmN0aW9uKGVsLCB0YXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybiBzY29wZS5wcmV2ZW50QWN0aW9uO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gUHJldmVudCBhbm90aGVyIGRyYWcgZnJvbSBvY2N1cmluZyB1bnRpbCB0aGUgY3VycmVudCBkcmFnIGlzXG4gICAgICAgIC8vIGNvbXBsZXRlZCBhbmQgdGhlIG5ldyBvcmRlciBpcyBzZXQuXG4gICAgICAgIGRyYWtlLm9uKCdkcmFnJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc2NvcGUucHJldmVudEFjdGlvbiA9IHRydWU7XG4gICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgIH0pO1xuICAgICAgICBkcmFrZS5vbignZHJhZ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHNldE9yZGVyKCk7XG4gICAgICAgICAgc2NvcGUucHJldmVudEFjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgIHNjb3BlLiRhcHBseSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBEZXRlcm1pbmVzIGFuZCBzYXZlcyB0aGUgb3JkZXIgY2hhbmdlZCBieSBkcmFnIGV2ZW50XG4gICAgICAgIHZhciBzZXRPcmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBpdGVtcyA9IGVsLmdldCgwKS5xdWVyeVNlbGVjdG9yQWxsKCcuY2hlY2tsaXN0LWl0ZW0nKTtcblxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNbaV07XG4gICAgICAgICAgICBnZXRJdGVtQnlLZXkoaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEta2V5JykpLm9yZGVyID0gaTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXRyaWV2ZXMgY2hlY2tsaXN0IGl0ZW0gYmFzZWQgb24gYW5ndWxhciBvYmplY3Qga2V5XG4gICAgICAgIHZhciBnZXRJdGVtQnlLZXkgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICB2YXIgbWF0Y2g7XG4gICAgICAgICAgdmFyIGl0ZW07XG4gICAgICAgICAgZm9yICh2YXIgaSA9IHNjb3BlLmRhdGEuaXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGl0ZW0gPSBzY29wZS5kYXRhLml0ZW1zW2ldO1xuICAgICAgICAgICAgaWYgKGl0ZW0uJCRoYXNoS2V5ID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBuZXcgY2hlY2tsaXN0IGl0ZW1cbiAgICAgICAgc2NvcGUuYWRkSXRlbSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHNjb3BlLmRhdGEuaXRlbXMucHVzaCh7J3RpdGxlJzogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29tbWVudHMnOiBbeydhdXRob3InOiBzY29wZS5hdXRob3IsICd0ZXh0JzogJyd9XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGVja2VkJzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZXhwYW5kZWQnOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyZWFkb25seSc6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3JkZXInOiBzY29wZS5kYXRhLml0ZW1zLmxlbmd0aH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIGNoZWNrbGlzdCBpdGVtXG4gICAgICAgIHNjb3BlLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbihpdGVtLCBjb25maXJtX25lZWRlZCkge1xuICAgICAgICAgIHZhciBpbmRleCA9IHNjb3BlLmRhdGEuaXRlbXMuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgICBpZiAoIWNvbmZpcm1fbmVlZGVkIHx8IGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBpdGVtPycpKSB7XG4gICAgICAgICAgICBzY29wZS5wcmV2ZW50QWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIHNjb3BlLmRhdGEuaXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIHNjb3BlLmRhdGEuZGVsZXRlZEl0ZW1zLnB1c2goaXRlbSk7XG5cbiAgICAgICAgICAgIC8vIFJlc2V0IG9yZGVyIGFmdGVyICRkaWdlc3QgYmxvY2sgKG9uY2UgaXRlbSBoYXMgYmVlbiByZW1vdmVkKVxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHNldE9yZGVyKCk7XG4gICAgICAgICAgICAgIHNjb3BlLnByZXZlbnRBY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH0sIDAsIGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbGxvdyBjaGVja2xpc3QgdGl0bGUgdG8gYmUgZWRpdGVkXG4gICAgICAgIHNjb3BlLmVkaXRJdGVtID0gZnVuY3Rpb24oaXRlbSwgJGV2ZW50KSB7XG4gICAgICAgICAgaWYgKGl0ZW0ucmVhZG9ubHkpIHtcbiAgICAgICAgICAgIC8vIEl0ZW0gd2lsbCBiZWNvbWUgZWRpdGFibGVcbiAgICAgICAgICAgIGlmICgkZXZlbnQpIHtcbiAgICAgICAgICAgICAgLy8gU2V0IGZvY3VzIG9uIGlucHV0XG4gICAgICAgICAgICAgICRldmVudC50YXJnZXQuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNjb3BlLmRhdGEuaXRlbXMuZm9yRWFjaChmdW5jdGlvbihzY29wZUl0ZW0pIHtzY29wZUl0ZW0ucmVhZG9ubHkgPSB0cnVlfSlcbiAgICAgICAgICB9XG4gICAgICAgICAgaXRlbS5yZWFkb25seSA9ICFpdGVtLnJlYWRvbmx5O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRXhwYW5kIGNoZWNrbGlzdCBpdGVtIHRvIHNob3cgY29tbWVudHNcbiAgICAgICAgc2NvcGUuZXhwYW5kSXRlbSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICBpdGVtLmV4cGFuZGVkID0gIWl0ZW0uZXhwYW5kZWQ7XG4gICAgICAgICAgc2NvcGUuZGF0YS5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKHNjb3BlSXRlbSkge3Njb3BlSXRlbS5yZWFkb25seSA9IHRydWV9KVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV0dXJuIGxvY2FsaXplZCBjb21tZW50IHRpbWVzdGFtcFxuICAgICAgICBzY29wZS5nZXRDb21tZW50VGltZXN0YW1wID0gZnVuY3Rpb24oY29tbWVudCkge1xuICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShjb21tZW50LnRpbWVzdGFtcCkudG9Mb2NhbGVTdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3N0YXRpYy9vcmNoZXN0cmEvY29tbW9uL2NvbXBvbmVudHMvY2hlY2tsaXN0L3BhcnRpYWxzL2NoZWNrbGlzdC5odG1sJ1xuICAgIH07XG4gIH1cblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnb3JjaGVzdHJhLmNvbW1vbi5jb21wb25lbnRzLmRpcmVjdGl2ZXMnKVxuICAgIC5kaXJlY3RpdmUoJ29yY2hlc3RyYUNoZWNrbGlzdEl0ZW0nLCBbJyRodHRwJywgJyR0aW1lb3V0JywgJyRjb21waWxlJywgJ29yY2hlc3RyYVNlcnZpY2UnLCBvcmNoZXN0cmFDaGVja2xpc3RJdGVtXSk7XG5cbiAgZnVuY3Rpb24gb3JjaGVzdHJhQ2hlY2tsaXN0SXRlbSgkaHR0cCwgJHRpbWVvdXQsICRjb21waWxlLCBvcmNoZXN0cmFTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHIpIHtcbiAgICAgICAgLy8gRHluYW1pY2FsbHkgYXV0b3NpemUgYSB0ZXh0IGlucHV0IHRvIGZpdCBpdHMgY29udGVudHMuXG4gICAgICAgIC8vIE1vZGlmaWVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL3l1YW5xaW5nL2F1dG9zaXplLWlucHV0IChNSVQgbGljZW5zZSkuXG4gICAgICAgIHNjb3BlLmF1dG9zaXplSW5wdXQgPSBmdW5jdGlvbihlbGVtLCBnaG9zdCwgbWluV2lkdGgsIHN0cikge1xuICAgICAgICAgIC8vIENvbXBpbGUgYW5kIGNhY2hlIHRoZSBuZWVkZWQgcmVndWxhciBleHByZXNzaW9ucy5cbiAgICAgICAgICB2YXIgU1BBQ0UgPSAvXFxzL2c7XG4gICAgICAgICAgdmFyIExFU1NfVEhBTiA9IC8+L2c7XG4gICAgICAgICAgdmFyIE1PUkVfVEhBTiA9IC88L2c7XG5cbiAgICAgICAgICAvLyBXZSBuZWVkIHRvIHN3YXAgb3V0IHRoZXNlIGNoYXJhY3RlcnMgd2l0aCB0aGVpciBjaGFyYWN0ZXItZW50aXR5XG4gICAgICAgICAgLy8gZXF1aXZhbGVudHMgYmVjYXVzZSB3ZSdyZSBhc3NpZ25pbmcgdGhlIHJlc3VsdGluZyBzdHJpbmcgdG9cbiAgICAgICAgICAvLyBgZ2hvc3QuaW5uZXJIVE1MYC5cbiAgICAgICAgICBmdW5jdGlvbiBlc2NhcGUoc3RyKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoU1BBQ0UsICcmbmJzcDsnKVxuICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKExFU1NfVEhBTiwgJyZsdDsnKVxuICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKE1PUkVfVEhBTiwgJyZndDsnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzdHIgPSBzdHIgfHwgZWxlbS52YWx1ZSB8fCAnJztcblxuICAgICAgICAgIC8vIEFwcGx5IHRoZSBgZm9udC1zaXplYCBhbmQgYGZvbnQtZmFtaWx5YCBzdHlsZXMgb2YgYGVsZW1gIG9uIHRoZVxuICAgICAgICAgIC8vIGBnaG9zdGAgZWxlbWVudC5cbiAgICAgICAgICB2YXIgZWxlbVN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbSk7XG4gICAgICAgICAgdmFyIGVsZW1Dc3NUZXh0ID0gJ2ZvbnQtZmFtaWx5OicgKyBlbGVtU3R5bGUuZm9udEZhbWlseSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAnO2ZvbnQtc2l6ZTonICAgKyBlbGVtU3R5bGUuZm9udFNpemU7XG5cbiAgICAgICAgICBnaG9zdC5zdHlsZS5jc3NUZXh0ICs9IGVsZW1Dc3NUZXh0O1xuICAgICAgICAgIGdob3N0LmlubmVySFRNTCA9IGVzY2FwZShzdHIpO1xuICAgICAgICAgIHZhciB3aWR0aCA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGdob3N0KS53aWR0aDtcbiAgICAgICAgICBpZiAod2lkdGggPT09ICcwcHgnKSB7XG4gICAgICAgICAgICB3aWR0aCA9IG1pbldpZHRoO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbGVtLnN0eWxlLndpZHRoID0gd2lkdGg7XG4gICAgICAgICAgcmV0dXJuIHdpZHRoO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRoYXQ6XG4gICAgICAgIC8vIDEuIENvcGllcyB0aGUgYGZvbnQtZmFtaWx5YCBhbmQgYGZvbnQtc2l6ZWAgb2Ygb3VyIGBlbGVtYCBvbnRvIGBnaG9zdGBcbiAgICAgICAgLy8gMi4gU2V0cyB0aGUgY29udGVudHMgb2YgYGdob3N0YCB0byB0aGUgc3BlY2lmaWVkIGBzdHJgXG4gICAgICAgIC8vIDMuIENvcGllcyB0aGUgd2lkdGggb2YgYGdob3N0YCBvbnRvIG91ciBgZWxlbWBcbiAgICAgICAgc2NvcGUuc2V0dXBBdXRvc2l6ZXIgPSBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgLy8gQ3JlYXRlIHRoZSBgZ2hvc3RgIGVsZW1lbnQsIHdpdGggaW5saW5lIHN0eWxlcyB0byBoaWRlIGl0IGFuZCBlbnN1cmUgdGhhdFxuICAgICAgICAgIC8vIHRoZSB0ZXh0IGlzIGFsbCBvbiBhIHNpbmdsZSBsaW5lLlxuICAgICAgICAgIHZhciBnaG9zdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgIGdob3N0LmNsYXNzTmFtZSA9ICdnaG9zdCc7XG4gICAgICAgICAgZ2hvc3Quc3R5bGUuY3NzVGV4dCA9ICdib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6aW5saW5lLWJsb2NrO2hlaWdodDowO292ZXJmbG93OmhpZGRlbjtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDt2aXNpYmlsaXR5OmhpZGRlbjt3aGl0ZS1zcGFjZTpub3dyYXA7JztcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGdob3N0KTtcblxuICAgICAgICAgIC8vIEZvcmNlIGBjb250ZW50LWJveGAgb24gdGhlIGBlbGVtYC5cbiAgICAgICAgICBlbGVtLnN0eWxlLmJveFNpemluZyA9ICdjb250ZW50LWJveCc7XG5cbiAgICAgICAgICB2YXIgbWluV2lkdGggPSBzY29wZS5hdXRvc2l6ZUlucHV0KGVsZW0sIGdob3N0LCAwLCBlbGVtLmdldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInKSk7XG5cbiAgICAgICAgICAvLyBBdXRvc2l6ZSBpbnB1dCBvbiB2YWx1ZSBjaGFuZ2VcbiAgICAgICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzY29wZS5hdXRvc2l6ZUlucHV0KGVsZW0sIGdob3N0LCBtaW5XaWR0aCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBBdXRvc2l6ZSBpbnB1dCB3aGVuIGNoZWNrbGlzdCBpdGVtIGZpcnN0IGFkZGVkIHRvIHRoZSBET01cbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNjb3BlLmF1dG9zaXplSW5wdXQoZWxlbSwgZ2hvc3QsIG1pbldpZHRoKTtcbiAgICAgICAgICB9LCAwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNjb3BlLnNldHVwQXV0b3NpemVyKGVsLmZpbmQoJy5pdGVtLXRpdGxlIGlucHV0JykuZ2V0KDApKVxuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3N0YXRpYy9vcmNoZXN0cmEvY29tbW9uL2NvbXBvbmVudHMvY2hlY2tsaXN0L3BhcnRpYWxzL2NoZWNrbGlzdC1pdGVtLmh0bWwnXG4gICAgfTtcbiAgfVxufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
