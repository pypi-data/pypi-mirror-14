!function(){"use strict";var t=angular.module("orchestra.project_management.services");t.factory("axis",["dataService","visUtils",function(t,e){return{draw:function(){if(e.parentContainer.select(".x.axis").style("opacity",0),t.timeSortedSlugs.length){var a=t.data.tasks[t.timeSortedSlugs[0]],i=new Date(a.start_datetime),r=t.timeSortedSlugs.map(function(e){return t.taskEnd(t.taskFromKey(e))}),n=i;r.forEach(function(t){var e=new Date(t);e>i&&(n=e)});var s=36e5,c=Math.ceil((n-i)/s);n=new Date(i.getTime()+c*s);var o=d3.range(0,c+1).map(function(t){return new Date(i.getTime()+t*s)});this.timeScale=d3.time.scale().domain([i,n]).range([0,e.params.scaleWidth]);var l,m=d3.svg.axis().scale(this.timeScale).tickSize(10),u=5;if(this.relativeTime)m.tickValues(o).tickFormat(function(t,e){return o.length<u||e%u==0?(t-i)/s:void 0}),l="Time (hours)";else{m.ticks(d3.time.hour,1);var d=this.timeScale.tickFormat();m.tickFormat(function(t,e){return e%u==0?d(t):""}),l="Time (local)"}e.parentContainer.select(".x.label").text(l).style("right",e.getSvgWidth()+5+"px"),e.parentContainer.select(".x.axis").transition().call(m),e.parentContainer.select(".x.axis").style("opacity",1).attr("width",e.getSvgWidth())}},getOffset:function(t){return this.timeScale(new Date(t))}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9yY2hlc3RyYS9wcm9qZWN0X21hbmFnZW1lbnQvanMvYXhpcy5qcyJdLCJuYW1lcyI6WyJzZXJ2aWNlTW9kdWxlIiwiYW5ndWxhciIsIm1vZHVsZSIsImZhY3RvcnkiLCJkYXRhU2VydmljZSIsInZpc1V0aWxzIiwiZHJhdyIsInBhcmVudENvbnRhaW5lciIsInNlbGVjdCIsInN0eWxlIiwidGltZVNvcnRlZFNsdWdzIiwibGVuZ3RoIiwiZmlyc3RUYXNrIiwiZGF0YSIsInRhc2tzIiwibWluRGF0ZXRpbWUiLCJEYXRlIiwic3RhcnRfZGF0ZXRpbWUiLCJ0YXNrRW5kVGltZXMiLCJtYXAiLCJzbHVnIiwidGFza0VuZCIsInRhc2tGcm9tS2V5IiwibWF4RGF0ZXRpbWUiLCJmb3JFYWNoIiwiZGF0ZXRpbWVfc3RyaW5nIiwibmV4dERhdGV0aW1lIiwiaG91ckluTWlsbGlzZWNvbmRzIiwibnVtSG91cnMiLCJNYXRoIiwiY2VpbCIsImdldFRpbWUiLCJob3VyVGlja3MiLCJkMyIsInJhbmdlIiwiaG91ckluZGV4IiwidGhpcyIsInRpbWVTY2FsZSIsInRpbWUiLCJzY2FsZSIsImRvbWFpbiIsInBhcmFtcyIsInNjYWxlV2lkdGgiLCJ4TGFiZWxUZXh0IiwieEF4aXMiLCJzdmciLCJheGlzIiwidGlja1NpemUiLCJ0aWNrU3ByZWFkIiwicmVsYXRpdmVUaW1lIiwidGlja1ZhbHVlcyIsInRpY2tGb3JtYXQiLCJkIiwiaSIsInRpY2tzIiwiaG91ciIsImRlZmF1bHRGb3JtYXQiLCJ0ZXh0IiwiZ2V0U3ZnV2lkdGgiLCJ0cmFuc2l0aW9uIiwiY2FsbCIsImF0dHIiLCJnZXRPZmZzZXQiLCJkYXRldGltZSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDRSxZQUVBLElBQUlBLEdBQWlCQyxRQUFRQyxPQUFPLHdDQUVwQ0YsR0FBY0csUUFBUSxRQUFBLGNBQUEsV0FBUSxTQUFTQyxFQUFhQyxHQUlsRCxPQUNFQyxLQUFNLFdBS0osR0FEQUQsRUFBU0UsZ0JBQWdCQyxPQUFPLFdBQVdDLE1BQU0sVUFBVyxHQUN2REwsRUFBWU0sZ0JBQWdCQyxPQUFqQyxDQUdBLEdBQUlDLEdBQVlSLEVBQVlTLEtBQUtDLE1BQU1WLEVBQVlNLGdCQUFnQixJQUMvREssRUFBYyxHQUFJQyxNQUFLSixFQUFVSyxnQkFDakNDLEVBQWVkLEVBQVlNLGdCQUFnQlMsSUFBSSxTQUFTQyxHQUMxRCxNQUFPaEIsR0FBWWlCLFFBQVFqQixFQUFZa0IsWUFBWUYsTUFHakRHLEVBQWNSLENBQ2xCRyxHQUFhTSxRQUFRLFNBQVNDLEdBQzVCLEdBQUlDLEdBQWUsR0FBSVYsTUFBS1MsRUFDeEJDLEdBQWVYLElBQ2pCUSxFQUFjRyxJQUlsQixJQUFJQyxHQUFxQixLQUNyQkMsRUFBV0MsS0FBS0MsTUFBTVAsRUFBY1IsR0FBZVksRUFDdkRKLEdBQWMsR0FBSVAsTUFBS0QsRUFBWWdCLFVBQVlILEVBQVdELEVBRTFELElBQUlLLEdBQVlDLEdBQUdDLE1BQU0sRUFBR04sRUFBVyxHQUFHVCxJQUFJLFNBQVNnQixHQUNyRCxNQUFPLElBQUluQixNQUFLRCxFQUFZZ0IsVUFBWUksRUFBWVIsSUFHdERTLE1BQUtDLFVBQVlKLEdBQUdLLEtBQUtDLFFBQ3RCQyxRQUFRekIsRUFBYVEsSUFDckJXLE9BQU8sRUFBRzdCLEVBQVNvQyxPQUFPQyxZQUU3QixJQUtJQyxHQUxBQyxFQUFRWCxHQUFHWSxJQUFJQyxPQUNoQlAsTUFBTUgsS0FBS0MsV0FDWFUsU0FBUyxJQUVSQyxFQUFhLENBRWpCLElBQUlaLEtBQUthLGFBQ1BMLEVBQU1NLFdBQVdsQixHQUNoQm1CLFdBQVcsU0FBU0MsRUFBR0MsR0FDdEIsTUFBSXJCLEdBQVVyQixPQUFTcUMsR0FBY0ssRUFBSUwsR0FBYyxHQUM3Q0ksRUFBSXJDLEdBQWVZLEVBRDdCLFNBSUZnQixFQUFhLG1CQUVWLENBQ0hDLEVBQU1VLE1BQU1yQixHQUFHSyxLQUFLaUIsS0FBTSxFQUMxQixJQUFJQyxHQUFnQnBCLEtBQUtDLFVBQVVjLFlBQ25DUCxHQUFNTyxXQUFXLFNBQVNDLEVBQUdDLEdBQ3pCLE1BQU9BLEdBQUlMLEdBQWMsRUFBSVEsRUFBY0osR0FBSyxLQUVwRFQsRUFBYSxlQUdmdEMsRUFBU0UsZ0JBQWdCQyxPQUFPLFlBQzdCaUQsS0FBS2QsR0FDTGxDLE1BQU0sUUFBU0osRUFBU3FELGNBQWdCLEVBQUksTUFFL0NyRCxFQUFTRSxnQkFBZ0JDLE9BQU8sV0FBV21ELGFBQWFDLEtBQUtoQixHQUM3RHZDLEVBQVNFLGdCQUFnQkMsT0FBTyxXQUM3QkMsTUFBTSxVQUFXLEdBQ2pCb0QsS0FBSyxRQUFTeEQsRUFBU3FELGlCQUU1QkksVUFBVyxTQUFTQyxHQUlsQixNQUFPM0IsTUFBS0MsVUFBVSxHQUFJckIsTUFBSytDIiwiZmlsZSI6Im9yY2hlc3RyYS9wcm9qZWN0X21hbmFnZW1lbnQvanMvYXhpcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIHNlcnZpY2VNb2R1bGUgPSAgYW5ndWxhci5tb2R1bGUoJ29yY2hlc3RyYS5wcm9qZWN0X21hbmFnZW1lbnQuc2VydmljZXMnKTtcblxuICBzZXJ2aWNlTW9kdWxlLmZhY3RvcnkoJ2F4aXMnLCBmdW5jdGlvbihkYXRhU2VydmljZSwgdmlzVXRpbHMpIHtcbiAgICAvKipcbiAgICAgKiBTZXJ2aWNlIHRvIGhhbmRsZSBhbGlnbmluZyB2aXN1YWxpemF0aW9uIGVsZW1lbnRzIHRvIGEgY29tbW9uIHRpbWUgYXhpcy5cbiAgICAgKi9cbiAgICByZXR1cm4ge1xuICAgICAgZHJhdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEcmF3cy91cGRhdGVzIGF4aXMgd2l0aCBib3RoIHJlbGF0aXZlIGFuZCBsb2NhbCB0aW1lIHNjYWxlcy5cbiAgICAgICAgICovXG4gICAgICAgIHZpc1V0aWxzLnBhcmVudENvbnRhaW5lci5zZWxlY3QoJy54LmF4aXMnKS5zdHlsZSgnb3BhY2l0eScsIDApO1xuICAgICAgICBpZiAoIWRhdGFTZXJ2aWNlLnRpbWVTb3J0ZWRTbHVncy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpcnN0VGFzayA9IGRhdGFTZXJ2aWNlLmRhdGEudGFza3NbZGF0YVNlcnZpY2UudGltZVNvcnRlZFNsdWdzWzBdXTtcbiAgICAgICAgdmFyIG1pbkRhdGV0aW1lID0gbmV3IERhdGUoZmlyc3RUYXNrLnN0YXJ0X2RhdGV0aW1lKTtcbiAgICAgICAgdmFyIHRhc2tFbmRUaW1lcyA9IGRhdGFTZXJ2aWNlLnRpbWVTb3J0ZWRTbHVncy5tYXAoZnVuY3Rpb24oc2x1Zykge1xuICAgICAgICAgIHJldHVybiBkYXRhU2VydmljZS50YXNrRW5kKGRhdGFTZXJ2aWNlLnRhc2tGcm9tS2V5KHNsdWcpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIG1heERhdGV0aW1lID0gbWluRGF0ZXRpbWU7XG4gICAgICAgIHRhc2tFbmRUaW1lcy5mb3JFYWNoKGZ1bmN0aW9uKGRhdGV0aW1lX3N0cmluZykge1xuICAgICAgICAgIHZhciBuZXh0RGF0ZXRpbWUgPSBuZXcgRGF0ZShkYXRldGltZV9zdHJpbmcpO1xuICAgICAgICAgIGlmIChuZXh0RGF0ZXRpbWUgPiBtaW5EYXRldGltZSkge1xuICAgICAgICAgICAgbWF4RGF0ZXRpbWUgPSBuZXh0RGF0ZXRpbWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIHZhciBob3VySW5NaWxsaXNlY29uZHMgPSA2MCAqIDYwICogMTAwMDtcbiAgICAgICAgdmFyIG51bUhvdXJzID0gTWF0aC5jZWlsKChtYXhEYXRldGltZSAtIG1pbkRhdGV0aW1lKSAvIGhvdXJJbk1pbGxpc2Vjb25kcyk7XG4gICAgICAgIG1heERhdGV0aW1lID0gbmV3IERhdGUobWluRGF0ZXRpbWUuZ2V0VGltZSgpICsgbnVtSG91cnMgKiBob3VySW5NaWxsaXNlY29uZHMpO1xuXG4gICAgICAgIHZhciBob3VyVGlja3MgPSBkMy5yYW5nZSgwLCBudW1Ib3VycyArIDEpLm1hcChmdW5jdGlvbihob3VySW5kZXgpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IERhdGUobWluRGF0ZXRpbWUuZ2V0VGltZSgpICsgaG91ckluZGV4ICogaG91ckluTWlsbGlzZWNvbmRzKTtcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLnRpbWVTY2FsZSA9IGQzLnRpbWUuc2NhbGUoKVxuICAgICAgICAgIC5kb21haW4oW21pbkRhdGV0aW1lLCBtYXhEYXRldGltZV0pXG4gICAgICAgICAgLnJhbmdlKFswLCB2aXNVdGlscy5wYXJhbXMuc2NhbGVXaWR0aF0pO1xuXG4gICAgICAgIHZhciB4QXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAuc2NhbGUodGhpcy50aW1lU2NhbGUpXG4gICAgICAgICAgLnRpY2tTaXplKDEwKVxuXG4gICAgICAgIHZhciB0aWNrU3ByZWFkID0gNTtcbiAgICAgICAgdmFyIHhMYWJlbFRleHQ7XG4gICAgICAgIGlmICh0aGlzLnJlbGF0aXZlVGltZSkge1xuICAgICAgICAgIHhBeGlzLnRpY2tWYWx1ZXMoaG91clRpY2tzKVxuICAgICAgICAgIC50aWNrRm9ybWF0KGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgIGlmIChob3VyVGlja3MubGVuZ3RoIDwgdGlja1NwcmVhZCB8fCBpICUgdGlja1NwcmVhZCA9PSAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiAoZCAtIG1pbkRhdGV0aW1lKSAvIGhvdXJJbk1pbGxpc2Vjb25kcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICB4TGFiZWxUZXh0ID0gJ1RpbWUgKGhvdXJzKSdcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB4QXhpcy50aWNrcyhkMy50aW1lLmhvdXIsIDEpO1xuICAgICAgICAgIHZhciBkZWZhdWx0Rm9ybWF0ID0gdGhpcy50aW1lU2NhbGUudGlja0Zvcm1hdCgpO1xuICAgICAgICAgIHhBeGlzLnRpY2tGb3JtYXQoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICByZXR1cm4gaSAlIHRpY2tTcHJlYWQgPT0gMCA/IGRlZmF1bHRGb3JtYXQoZCkgOiAnJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIHhMYWJlbFRleHQgPSAnVGltZSAobG9jYWwpJ1xuICAgICAgICB9XG5cbiAgICAgICAgdmlzVXRpbHMucGFyZW50Q29udGFpbmVyLnNlbGVjdCgnLngubGFiZWwnKVxuICAgICAgICAgIC50ZXh0KHhMYWJlbFRleHQpXG4gICAgICAgICAgLnN0eWxlKCdyaWdodCcsIHZpc1V0aWxzLmdldFN2Z1dpZHRoKCkgKyA1ICsgJ3B4Jyk7XG5cbiAgICAgICAgdmlzVXRpbHMucGFyZW50Q29udGFpbmVyLnNlbGVjdCgnLnguYXhpcycpLnRyYW5zaXRpb24oKS5jYWxsKHhBeGlzKTtcbiAgICAgICAgdmlzVXRpbHMucGFyZW50Q29udGFpbmVyLnNlbGVjdCgnLnguYXhpcycpXG4gICAgICAgICAgLnN0eWxlKCdvcGFjaXR5JywgMSlcbiAgICAgICAgICAuYXR0cignd2lkdGgnLCB2aXNVdGlscy5nZXRTdmdXaWR0aCgpKTtcbiAgICAgIH0sXG4gICAgICBnZXRPZmZzZXQ6IGZ1bmN0aW9uKGRhdGV0aW1lKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxjdWxhdGVzIHRoZSBheGlzIG9mZnNldCBmb3IgYSBnaXZlbiBkYXRldGltZSBzdHJpbmcuXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lU2NhbGUobmV3IERhdGUoZGF0ZXRpbWUpKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
