

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tips and tricks &mdash; ZTPServer 1.3.2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="ZTPServer 1.3.2 documentation" href="index.html"/>
        <link rel="next" title="Internals" href="internals.html"/>
        <link rel="prev" title="ZTPServer VM on EOS in a L3WOM" href="cookbook/ztpsVMonEOS/l3wom.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> ZTPServer</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#ztp-intro">ZTP Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#server">Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#client">Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#ztp-client-server-message-flows">ZTP Client-Server Message Flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#topology-validation">Topology Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#operational-modes">Operational modes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#installation-options">Installation Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#upgrading">Upgrading</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#additional-services">Additional services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="startup.html">Startup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="startup.html#apache-mod-wsgi">Apache (mod_wsgi)</a></li>
<li class="toctree-l2"><a class="reference internal" href="startup.html#standalone-debug-server">Standalone debug server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#global-configuration-file">Global configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#bootstrap-configuration">Bootstrap configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#static-provisioning-overview">Static provisioning - overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#static-provisioning-startup-config">Static provisioning - startup_config</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#static-provisioning-definition">Static provisioning - definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#static-provisioning-attributes">Static provisioning - attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#static-provisioning-pattern">Static provisioning - pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#static-provisioning-config-handler">Static provisioning - config-handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#static-provisioning-log">Static provisioning - log</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#dynamic-provisioning-overview">Dynamic provisioning - overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#dynamic-provisioning-neighbordb">Dynamic provisioning - neighbordb</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#definitions">Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#actions">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#plugins-for-allocating-resources">Plugins for allocating resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#config-handlers">Config-handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#other-files">Other files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples.html#global-configuration-file">Global configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#dynamic-neighbordb-or-pattern-file">Dynamic neighbordb or pattern file</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#static-neighbordb-and-node-unique-id-pattern-file">Static neighbordb and /node/&lt;unique-id&gt;/pattern file</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#sample-dynamic-definition-file">Sample dynamic definition file</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#sample-templates">Sample templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#sample-resources">Sample resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#neighbordb-pattern-examples">Neighbordb pattern examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#more-examples">More examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">ZTPServer Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cookbook/install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/clientLogging.html">Client-Side Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/serverLogging.html">Server-Side Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/configuration.html">ZTPServer Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/runningZTPS.html">Running the ZTPServer</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/helloWorld.html">Hello World - A Simple Provisioning Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/staticNodes.html">Provision a Static Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/dynamicNodes.html">Provision a Dynamic Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/topologyValidation.html">Topology Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/definitions.html">Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/actions.html">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/resourcePools.html">Resource Pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/advanced.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/puppet.html">Puppet Agent - Bootstrap EOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/ansible.html">Ansible - Bootstrap EOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook/ztpsVMonEOS.html">Run ZTPServer as a VM on EOS</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Tips and tricks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-update-my-local-copy-of-ztpserver-from-github">How do I update my local copy of ZTPServer from GitHub?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#my-server-keeps-failing-to-load-my-resource-files-whats-going-on">My server keeps failing to load my resource files. What’s going on?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-validate-the-format-of-my-config-files">How do I validate the format of my config files?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-debug-the-ztp-server-provisioning-process">How do I debug the ZTP Server provisioning process?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-disable-enable-ztp-mode-on-a-switch">How do I disable / enable ZTP mode on a switch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-can-i-test-ztpserver-without-having-to-reboot-the-switch-every-time">How can I test ZTPServer without having to reboot the switch every time?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-is-the-recommended-test-environment-for-ztpserver">What is the recommended test environment for ZTPServer?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-override-the-default-system-mac-in-veos">How do I override the default system-mac in vEOS?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-override-the-default-serial-number-or-system-mac-in-veos">How do I override the default serial number or system-mac in vEOS?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Internals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="implementation.html">Implementation Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">Client - Server API</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html">Modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary of terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="support.html#contact">Contact</a></li>
<li class="toctree-l2"><a class="reference internal" href="support.html#known-caveats">Known caveats</a></li>
<li class="toctree-l2"><a class="reference internal" href="support.html#releases">Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="support.html#roadmap-highlights">Roadmap highlights</a></li>
<li class="toctree-l2"><a class="reference internal" href="support.html#tutorial">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="support.html#other-resources">Other Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#basics">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#before-requesting-support">Before Requesting Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="license.html#third-party">Third party</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">ZTPServer</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Tips and tricks</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/tips.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="tips-and-tricks">
<h1>Tips and tricks<a class="headerlink" href="#tips-and-tricks" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#how-do-i-update-my-local-copy-of-ztpserver-from-github" id="id1">How do I update my local copy of ZTPServer from GitHub?</a><ul>
<li><a class="reference internal" href="#automatically" id="id2">Automatically</a></li>
<li><a class="reference internal" href="#manually" id="id3">Manually</a></li>
</ul>
</li>
<li><a class="reference internal" href="#my-server-keeps-failing-to-load-my-resource-files-whats-going-on" id="id4">My server keeps failing to load my resource files. What’s going on?</a></li>
<li><a class="reference internal" href="#how-do-i-validate-the-format-of-my-config-files" id="id5">How do I validate the format of my config files?</a></li>
<li><a class="reference internal" href="#how-do-i-debug-the-ztp-server-provisioning-process" id="id6">How do I debug the ZTP Server provisioning process?</a></li>
<li><a class="reference internal" href="#how-do-i-disable-enable-ztp-mode-on-a-switch" id="id7">How do I disable / enable ZTP mode on a switch</a></li>
<li><a class="reference internal" href="#how-can-i-test-ztpserver-without-having-to-reboot-the-switch-every-time" id="id8">How can I test ZTPServer without having to reboot the switch every time?</a></li>
<li><a class="reference internal" href="#what-is-the-recommended-test-environment-for-ztpserver" id="id9">What is the recommended test environment for ZTPServer?</a></li>
<li><a class="reference internal" href="#how-do-i-override-the-default-system-mac-in-veos" id="id10">How do I override the default system-mac in vEOS?</a></li>
<li><a class="reference internal" href="#how-do-i-override-the-default-serial-number-or-system-mac-in-veos" id="id11">How do I override the default serial number or system-mac in vEOS?</a></li>
</ul>
</div>
<div class="section" id="how-do-i-update-my-local-copy-of-ztpserver-from-github">
<h2><a class="toc-backref" href="#id1">How do I update my local copy of ZTPServer from GitHub?</a><a class="headerlink" href="#how-do-i-update-my-local-copy-of-ztpserver-from-github" title="Permalink to this headline">¶</a></h2>
<div class="section" id="automatically">
<h3><a class="toc-backref" href="#id2">Automatically</a><a class="headerlink" href="#automatically" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Go to the ZTPServer directory where you previously cloned the GitHub repository and execute:</dt>
<dd><p class="first"><tt class="docutils literal"><span class="pre">./utils/refresh_ztps</span> <span class="pre">[-b</span> <span class="pre">&lt;branch&gt;]</span> <span class="pre">[-f</span> <span class="pre">&lt;path&gt;]</span></tt></p>
<ul class="last">
<li><p class="first">&lt;branch&gt; can be any branch name in the Git repo.   Typically this will be one of:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;master&#8221; - for the latest release version</li>
<li>&#8220;vX.Y.Z-rc&#8221; - for beta testing the next X.Y.Z release-candidate</li>
<li>&#8220;develop&#8221; (DEFAULT) - for the latest bleeding-edge development branch</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">&lt;path&gt; is the base directory of the ztpserver installation.</p>
<blockquote>
<div><ul class="simple">
<li>/usr/share/ztpserver (DEFAULT)</li>
</ul>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="manually">
<h3><a class="toc-backref" href="#id3">Manually</a><a class="headerlink" href="#manually" title="Permalink to this headline">¶</a></h3>
<p>Remove the existing ZTPServer files:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">rm -rf /usr/share/ztpserver/actions/*</span>
<span class="go">rm -rf /usr/share/ztpserver/bootstrap/*</span>
<span class="go">rm -rf /usr/lib/python2.7/site-packages/ztpserver*</span>
<span class="go">rm -rf /bin/ztps*</span>
<span class="go">rm -rf /home/ztpuser/ztpserver/ztpserver.egg-info/</span>
<span class="go">rm -rf /home/ztpuser/ztpserver/build/*</span>
</pre></div>
</div>
<p>Go to the ZTPServer directory where you previously cloned the GitHub repository, update it, then build and install the server:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">bash-3.2$ git pull</span>
<span class="go">bash-3.2$ python setup.py build</span>
<span class="go">bash-3.2$ python setup.py install</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="my-server-keeps-failing-to-load-my-resource-files-whats-going-on">
<h2><a class="toc-backref" href="#id4">My server keeps failing to load my resource files. What’s going on?</a><a class="headerlink" href="#my-server-keeps-failing-to-load-my-resource-files-whats-going-on" title="Permalink to this headline">¶</a></h2>
<p>Did you know?</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">a:b is INVALID YAML</span>
<span class="l-Scalar-Plain">a</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">b is VALID YAML syntax</span>
</pre></div>
</div>
<p>Check out <a class="reference external" href="http://yamllint.com/">YAML syntax checker</a> for more.</p>
</div>
<div class="section" id="how-do-i-validate-the-format-of-my-config-files">
<h2><a class="toc-backref" href="#id5">How do I validate the format of my config files?</a><a class="headerlink" href="#how-do-i-validate-the-format-of-my-config-files" title="Permalink to this headline">¶</a></h2>
<p>To validate config files use <tt class="docutils literal"><span class="pre">ztps</span> <span class="pre">--validate</span></tt>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">[ztpsadmin@ztps ~]$ ztps --validate</span>
<span class="go">Validating neighbordb (&#39;/usr/share/ztpserver/neighbordb&#39;)... Ok!</span>

<span class="go">Validating definitions...</span>
<span class="go">Validating /usr/share/ztpserver/definitions/torb-withImageUpgrade... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/definitions/torb... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/definitions/tora-withImageUpgrade... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/definitions/tora... Ok!</span>

<span class="go">Validating resources...</span>
<span class="go">Validating /usr/share/ztpserver/resources/tor_hostnames... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/resources/ip_loopback... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/resources/ip_vlan100... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/resources/mgmt_subnet... Ok!</span>

<span class="go">Validating nodes...</span>
<span class="go">Validating /usr/share/ztpserver/nodes/001122334456/pattern... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/nodes/001122334456/definition... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/nodes/001122334455/pattern... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/nodes/001122334455/definition... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/nodes/001122334457/pattern... Ok!</span>
<span class="go">Validating /usr/share/ztpserver/nodes/001122334457/definition... Ok!</span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-debug-the-ztp-server-provisioning-process">
<h2><a class="toc-backref" href="#id6">How do I debug the ZTP Server provisioning process?</a><a class="headerlink" href="#how-do-i-debug-the-ztp-server-provisioning-process" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">If ZTP Server is running via wsgi, Check the Apache log files.  Separate log files can be designated for ZTP Server&#8217;s wsgi with the following:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;VirtualHost *:8080&gt;
    CustomLog logs/ztpserver-access_log common
    ErrorLog logs/ztpserver-error_log
    ...
&lt;/VirtualHost&gt;
</pre></div>
</div>
</li>
<li><p class="first">Run the standalone ZTP Server binary in debug mode and log the output to a file:
<tt class="docutils literal"><span class="pre">ztps</span> <span class="pre">--debug</span> <span class="pre">2&gt;&amp;1</span> <span class="pre">|</span> <span class="pre">tee</span> <span class="pre">ztps.log</span></tt></p>
</li>
<li><p class="first">After changing configuration directives in neighbordb, a definition, etc, you may need to remove the node directory of the node-under-test before retrying ZTP on the node.   This will ensure that ZTP Server matches the node against neighbordb instead of <tt class="docutils literal"><span class="pre">nodes/&lt;serialnum&gt;/pattern</span></tt>.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">bootstrap</span></tt> script may be manually run from a switch instead of going through an entire reload/ZTP cycle.  To do this, download the script to the switch, then run it locally:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">switch</span><span class="c"># bash wget http://ztpserver:8080/bootstrap</span>
<span class="n">switch</span><span class="c"># bash chmod +x bootstrap</span>
<span class="n">switch</span><span class="c"># bash sudo ./bootstrap</span>
</pre></div>
</div>
</li>
<li><p class="first">On the client side, make sure you use XMPP (best) or remove syslog (second best) logging - you can configure that in <em>bootstrap.conf</em>.</p>
</li>
<li><p class="first">When requesting support, please include the output from the server (running in debug mode) and the console/log output from the switch.</p>
</li>
</ul>
</div>
<div class="section" id="how-do-i-disable-enable-ztp-mode-on-a-switch">
<h2><a class="toc-backref" href="#id7">How do I disable / enable ZTP mode on a switch</a><a class="headerlink" href="#how-do-i-disable-enable-ztp-mode-on-a-switch" title="Permalink to this headline">¶</a></h2>
<p>By default, any switch that does not have a <tt class="docutils literal"><span class="pre">startup-config</span></tt> will enter ZTP mode to attempt to retrieve one. This feature was introduced in EOS 3.7 for fixed devices and EOS 4.10 for modular ones. In ZTP mode, the switch sends out DHCP requests on all interfaces and <strong>will not forward traffic</strong> until it reboots with a config.</p>
<p>To cancel ZTP mode, login as admin and type <tt class="docutils literal"><span class="pre">zerotouch</span> <span class="pre">cancel</span></tt>.  <strong>This will trigger an immediate reload</strong> of the switch, after which the switch will be ready to configure manually. At this point, if you ever erase the startup-config and reload, the switch will edn up ZTP mode again.</p>
<p>To completely disable ZTP mode, login as admin and type <tt class="docutils literal"><span class="pre">zerotouch</span> <span class="pre">disable</span></tt>.  <strong>This will trigger an immediate reload</strong> of the switch after which the switch will will be ready to configure manually. If you wish to re-enable ZTP, go to configure mode and run <tt class="docutils literal"><span class="pre">zerotouch</span> <span class="pre">enable</span></tt>.  The next time you erase the startup-config and reload the switch, the switch will end up ZTP mode again.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">vEOS instances come with a minimal startup-config so they do not boot in to ZTP mode by default.   In order to use vEOS to test ZTP, enter <tt class="docutils literal"><span class="pre">erase</span> <span class="pre">startup-config</span></tt> and reload.</p>
</div>
</div>
<div class="section" id="how-can-i-test-ztpserver-without-having-to-reboot-the-switch-every-time">
<h2><a class="toc-backref" href="#id8">How can I test ZTPServer without having to reboot the switch every time?</a><a class="headerlink" href="#how-can-i-test-ztpserver-without-having-to-reboot-the-switch-every-time" title="Permalink to this headline">¶</a></h2>
<p>From a bash shell on the switch:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">#</span> retrieve the bootstrap file from server
<span class="go">wget http://&lt;ZTP_SERVER&gt;:&lt;PORT&gt;/bootstrap</span>
<span class="gp">#</span> make file executable
<span class="go">sudo chmod 777 bootstrap</span>
<span class="gp">#</span> execute file
<span class="go">sudo ./bootstrap</span>
</pre></div>
</div>
</div>
<div class="section" id="what-is-the-recommended-test-environment-for-ztpserver">
<h2><a class="toc-backref" href="#id9">What is the recommended test environment for ZTPServer?</a><a class="headerlink" href="#what-is-the-recommended-test-environment-for-ztpserver" title="Permalink to this headline">¶</a></h2>
<p>The best way to learn about and test a ZTPServer environment is to build the server and virtual (vEOS) nodes with Packer.  See <a class="reference external" href="https://github.com/arista-eosplus/packer-ztpserver">https://github.com/arista-eosplus/packer-ztpserver</a> for directions.</p>
<p>If you setup your own environment, the following recommendations should assist greatly in visualizing the workflow and troubleshooting any issues which may arise.  The development team strongly encourages these steps as Best Practices for testing your environment, and, most of these recommendations are also Best Practices for a full deployment.</p>
<ul>
<li><p class="first">During testing, only - run the standalone server in debug mode: <tt class="docutils literal"><span class="pre">ztps</span> <span class="pre">--debug</span></tt> in a buffered shell.   NOTE: do NOT use this standalone server in production, however, except in the smallest environments ( Approx 10 nodes or less, consecutively).</p>
</li>
<li><p class="first">Do not attempt any detailed debugging from a virtual or serial console.  Due to the quantity of information and frequent lack of copy/paste access, this if often painful.  Both suggested logging methods, below, can be configured in the <a class="reference internal" href="config.html#bootstrap-config"><em>Bootstrap configuration</em></a>.</p>
<ul>
<li><p class="first">(BEST) Setup XMPP logging. There are many XMPP services available, including <a class="reference external" href="https://www.ejabberd.im/">ejabberd</a>, and even more clients, such as <a class="reference external" href="https://adium.im/">Adium</a>.  This will give you a single pane view of what is happening on all of your test switches.  Our demo includes ejabberd with the following configuration:</p>
<blockquote>
<div><ul class="simple">
<li>Server: im.ztps-test.com (or your ZTPServer IP)</li>
<li>XMPP admin user: <a class="reference external" href="mailto:ztpsadmin&#37;&#52;&#48;im&#46;ztps-test&#46;com">ztpsadmin<span>&#64;</span>im<span>&#46;</span>ztps-test<span>&#46;</span>com</a>, passwd eosplus</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">(Second) In place of XMPP, splecify a central syslog server in the bootstrap config.</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="how-do-i-override-the-default-system-mac-in-veos">
<h2><a class="toc-backref" href="#id10">How do I override the default system-mac in vEOS?</a><a class="headerlink" href="#how-do-i-override-the-default-system-mac-in-veos" title="Permalink to this headline">¶</a></h2>
<p>Add the desired MAC address to the first line of the file /mnt/flash/system_mac_address, then reboot (Feature added in 3.13.0F)</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">[admin@localhost ~]$ echo 1122.3344.5566 &gt; /mnt/flash/system_mac_address</span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-override-the-default-serial-number-or-system-mac-in-veos">
<h2><a class="toc-backref" href="#id11">How do I override the default serial number or system-mac in vEOS?</a><a class="headerlink" href="#how-do-i-override-the-default-serial-number-or-system-mac-in-veos" title="Permalink to this headline">¶</a></h2>
<p>As of vEOS 4.14.0, the serial number and system mac address can be configured with a file in /mnt/flash/veos-config.  After modifying SERIALNUMBER or SYSTEMMACADDR, a reboot is required for the changes to take effect.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">SERIALNUMBER=ABC12345678</span>
<span class="go">SYSTEMMACADDR=1122.3344.5566</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="internals.html" class="btn btn-neutral float-right" title="Internals"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cookbook/ztpsVMonEOS/l3wom.html" class="btn btn-neutral" title="ZTPServer VM on EOS in a L3WOM"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Arista Networks.
      Last updated on Oct 13, 2015.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.3.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>