

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Definitions &mdash; ZTPServer 1.3.2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="ZTPServer 1.3.2 documentation" href="../index.html"/>
        <link rel="up" title="ZTPServer Cookbook" href="../cookbook.html"/>
        <link rel="next" title="Actions" href="actions.html"/>
        <link rel="prev" title="Topology Validation" href="topologyValidation.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> ZTPServer</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#ztp-intro">ZTP Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#server">Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#client">Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#ztp-client-server-message-flows">ZTP Client-Server Message Flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#topology-validation">Topology Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#operational-modes">Operational modes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#installation-options">Installation Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#upgrading">Upgrading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#additional-services">Additional services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../startup.html">Startup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../startup.html#apache-mod-wsgi">Apache (mod_wsgi)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../startup.html#standalone-debug-server">Standalone debug server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../config.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#global-configuration-file">Global configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#bootstrap-configuration">Bootstrap configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#static-provisioning-overview">Static provisioning - overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#static-provisioning-startup-config">Static provisioning - startup_config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#static-provisioning-definition">Static provisioning - definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#static-provisioning-attributes">Static provisioning - attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#static-provisioning-pattern">Static provisioning - pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#static-provisioning-config-handler">Static provisioning - config-handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#static-provisioning-log">Static provisioning - log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#dynamic-provisioning-overview">Dynamic provisioning - overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#dynamic-provisioning-neighbordb">Dynamic provisioning - neighbordb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#definitions">Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#actions">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#plugins-for-allocating-resources">Plugins for allocating resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#config-handlers">Config-handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#other-files">Other files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#global-configuration-file">Global configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#dynamic-neighbordb-or-pattern-file">Dynamic neighbordb or pattern file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#static-neighbordb-and-node-unique-id-pattern-file">Static neighbordb and /node/&lt;unique-id&gt;/pattern file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#sample-dynamic-definition-file">Sample dynamic definition file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#sample-templates">Sample templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#sample-resources">Sample resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#neighbordb-pattern-examples">Neighbordb pattern examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#more-examples">More examples</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../cookbook.html">ZTPServer Cookbook</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="clientLogging.html">Client-Side Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="serverLogging.html">Server-Side Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">ZTPServer Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="runningZTPS.html">Running the ZTPServer</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloWorld.html">Hello World - A Simple Provisioning Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="staticNodes.html">Provision a Static Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamicNodes.html">Provision a Dynamic Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="topologyValidation.html">Topology Validation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="resourcePools.html">Resource Pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="puppet.html">Puppet Agent - Bootstrap EOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansible.html">Ansible - Bootstrap EOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="ztpsVMonEOS.html">Run ZTPServer as a VM on EOS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tips.html">Tips and tricks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#how-do-i-update-my-local-copy-of-ztpserver-from-github">How do I update my local copy of ZTPServer from GitHub?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#my-server-keeps-failing-to-load-my-resource-files-whats-going-on">My server keeps failing to load my resource files. Whatâ€™s going on?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#how-do-i-validate-the-format-of-my-config-files">How do I validate the format of my config files?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#how-do-i-debug-the-ztp-server-provisioning-process">How do I debug the ZTP Server provisioning process?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#how-do-i-disable-enable-ztp-mode-on-a-switch">How do I disable / enable ZTP mode on a switch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#how-can-i-test-ztpserver-without-having-to-reboot-the-switch-every-time">How can I test ZTPServer without having to reboot the switch every time?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#what-is-the-recommended-test-environment-for-ztpserver">What is the recommended test environment for ZTPServer?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#how-do-i-override-the-default-system-mac-in-veos">How do I override the default system-mac in vEOS?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#how-do-i-override-the-default-serial-number-or-system-mac-in-veos">How do I override the default serial number or system-mac in vEOS?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../internals.html">Internals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../implementation.html">Implementation Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html">Client - Server API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html">Modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary of terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../support.html#contact">Contact</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support.html#known-caveats">Known caveats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support.html#releases">Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support.html#roadmap-highlights">Roadmap highlights</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support.html#tutorial">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support.html#other-resources">Other Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#basics">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#before-requesting-support">Before Requesting Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../license.html#third-party">Third party</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ZTPServer</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../cookbook.html">ZTPServer Cookbook</a> &raquo;</li>
      
    <li>Definitions</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/cookbook/definitions.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="definitions">
<h1>Definitions<a class="headerlink" href="#definitions" title="Permalink to this headline">Â¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#add-an-action-to-a-definition" id="id8">Add an Action to a Definition</a></li>
<li><a class="reference internal" href="#add-global-variables-to-definition" id="id9">Add Global Variables to Definition</a></li>
<li><a class="reference internal" href="#add-custom-log-statements-as-action-executes" id="id10">Add Custom Log Statements as Action Executes</a></li>
</ul>
</div>
<div class="section" id="add-an-action-to-a-definition">
<h2><a class="toc-backref" href="#id8">Add an Action to a Definition</a><a class="headerlink" href="#add-an-action-to-a-definition" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="objective">
<h3>Objective<a class="headerlink" href="#objective" title="Permalink to this headline">Â¶</a></h3>
<p>I want to use one of the built-in actions in my definition file.</p>
</div>
<div class="section" id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">Â¶</a></h3>
<p>You can choose any of the pre-built actions to include in your definition.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Learn more about <a class="reference external" href="http://ztpserver.readthedocs.org/en/master/config.html#actions">Actions</a>.</p>
</div>
<p>In this example we&#8217;ll copy a python script to the node and set its permissions.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="l-Scalar-Plain">actions</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span>
    <span class="l-Scalar-Plain">action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">copy_file</span>
    <span class="l-Scalar-Plain">always_execute</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
    <span class="l-Scalar-Plain">attributes</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">dst_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/mnt/flash/</span>
      <span class="l-Scalar-Plain">mode</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">777</span>
      <span class="l-Scalar-Plain">overwrite</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">if-missing</span>
      <span class="l-Scalar-Plain">src_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">files/automate/bgpautoinf.py</span>
    <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="s">&quot;automate</span><span class="nv"> </span><span class="s">BGP</span><span class="nv"> </span><span class="s">peer</span><span class="nv"> </span><span class="s">interface</span><span class="nv"> </span><span class="s">config&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="explanation">
<h3>Explanation<a class="headerlink" href="#explanation" title="Permalink to this headline">Â¶</a></h3>
<p>Here we add the <tt class="docutils literal"><span class="pre">copy_file</span></tt> action to our definition. The attributes listed in
the action will be passed to the node so that it is able to retrieve the script
from <tt class="docutils literal"><span class="pre">[SERVER_URL]/files/automate/bgpautoinf.py</span></tt>. Since we are using <tt class="docutils literal"><span class="pre">overwrite:</span> <span class="pre">if-missing</span></tt>,
the action will only copy the file to the node if it does not already exist.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For more Action recipes see the Actions section.</p>
</div>
</div>
</div>
<div class="section" id="add-global-variables-to-definition">
<h2><a class="toc-backref" href="#id9">Add Global Variables to Definition</a><a class="headerlink" href="#add-global-variables-to-definition" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="id1">
<h3>Objective<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h3>
<p>I want to use a variable throughout my definition without having to define it
more than once.</p>
</div>
<div class="section" id="id2">
<h3>Solution<a class="headerlink" href="#id2" title="Permalink to this headline">Â¶</a></h3>
<p>You can accomplish this by adding an <tt class="docutils literal"><span class="pre">attributes</span></tt> section at the root level of
your definition file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Learn more about <a class="reference external" href="http://ztpserver.readthedocs.org/en/master/config.html#actions">Actions</a>.</p>
</div>
<p>In this example, we have two different actions that reference the same <tt class="docutils literal"><span class="pre">$mode</span></tt>
and <tt class="docutils literal"><span class="pre">$dst</span></tt> variables.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="l-Scalar-Plain">actions</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span>
    <span class="l-Scalar-Plain">action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">copy_file</span>
    <span class="l-Scalar-Plain">always_execute</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
    <span class="l-Scalar-Plain">attributes</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">dst_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">$dst</span>
      <span class="l-Scalar-Plain">mode</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">$mode</span>
      <span class="l-Scalar-Plain">overwrite</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">if-missing</span>
      <span class="l-Scalar-Plain">src_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">files/automate/bgpautoinf.py</span>
    <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="s">&quot;Copy</span><span class="nv"> </span><span class="s">automate</span><span class="nv"> </span><span class="s">BGP</span><span class="nv"> </span><span class="s">script</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">node&quot;</span>
  <span class="p-Indicator">-</span>
    <span class="l-Scalar-Plain">action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">copy_file</span>
    <span class="l-Scalar-Plain">always_execute</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
    <span class="l-Scalar-Plain">attributes</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">dst_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">$dst</span>
      <span class="l-Scalar-Plain">mode</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">$mode</span>
      <span class="l-Scalar-Plain">overwrite</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">if-missing</span>
      <span class="l-Scalar-Plain">src_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">files/automate/superautomate.py</span>
    <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="s">&quot;Copy</span><span class="nv"> </span><span class="s">awesome</span><span class="nv"> </span><span class="s">script</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">my</span><span class="nv"> </span><span class="s">node&quot;</span>
  <span class="p-Indicator">-</span>
    <span class="l-Scalar-Plain">action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">add_config</span>
    <span class="l-Scalar-Plain">attributes</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">files/templates/ma1.template</span>
      <span class="l-Scalar-Plain">variables</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">ipaddress</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">$ip</span>
    <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="s">&quot;configure</span><span class="nv"> </span><span class="s">ma1&quot;</span>
  <span class="p-Indicator">-</span>
    <span class="l-Scalar-Plain">action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">add_config</span>
    <span class="l-Scalar-Plain">attributes</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">files/templates/xmpp.template</span>
      <span class="l-Scalar-Plain">variables</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">$variables</span>
    <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="s">&quot;configure</span><span class="nv"> </span><span class="s">ma1&quot;</span>

<span class="l-Scalar-Plain">attributes</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">dst</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/mnt/flash</span>
  <span class="l-Scalar-Plain">mode</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">777</span>
  <span class="l-Scalar-Plain">ip</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">192.168.0.50</span>
  <span class="l-Scalar-Plain">variables</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">domain</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">im.example.com</span>
    <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">myXmmpUser</span>
    <span class="l-Scalar-Plain">passwd</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">secret</span>
    <span class="l-Scalar-Plain">room</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">myAwesomeRoom</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>Explanation<a class="headerlink" href="#id4" title="Permalink to this headline">Â¶</a></h3>
<p>This example shows how to use global variables within the definition. It&#8217;s
important to see the difference between using variables to define attributes
of the action versus variables that get used within the template in an
<tt class="docutils literal"><span class="pre">add_config</span></tt> action.  See how the <tt class="docutils literal"><span class="pre">ipaddress</span></tt> variable is nested within
a <tt class="docutils literal"><span class="pre">variables</span></tt> key?  Also, you can create a list in the <tt class="docutils literal"><span class="pre">attributes</span></tt> section
and pass the entire list into the action as shown in the XMPP config action.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For more Action recipes see the Actions section.</p>
</div>
</div>
</div>
<div class="section" id="add-custom-log-statements-as-action-executes">
<h2><a class="toc-backref" href="#id10">Add Custom Log Statements as Action Executes</a><a class="headerlink" href="#add-custom-log-statements-as-action-executes" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="id5">
<h3>Objective<a class="headerlink" href="#id5" title="Permalink to this headline">Â¶</a></h3>
<p>I want to send specific messages to my syslog and/or XMPP servers while an action
is executing. Especially, if something goes wrong, I&#8217;d like to add a helpful message
so the engineer knows who to contact.</p>
</div>
<div class="section" id="id6">
<h3>Solution<a class="headerlink" href="#id6" title="Permalink to this headline">Â¶</a></h3>
<p>The node being provisioned will send predefined logs to the endpoints defined in
<tt class="docutils literal"><span class="pre">[data_root]/bootstrap/bootstrap.conf</span></tt>, but you can send additional client-side
logs by adding a few attributes to your definition.</p>
<p>Let&#8217;s add some specific status messages to the definition below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This could be a static node definition in <tt class="docutils literal"><span class="pre">[data_root]/nodes/&lt;SYSTEM_ID&gt;/definition</span></tt>
or a global definition in <tt class="docutils literal"><span class="pre">[data_root]/definitions/definition_name</span></tt>.</p>
</div>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="l-Scalar-Plain">actions</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span>
    <span class="l-Scalar-Plain">action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">copy_file</span>
    <span class="l-Scalar-Plain">always_execute</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
    <span class="l-Scalar-Plain">attributes</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">dst_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">$dst</span>
      <span class="l-Scalar-Plain">mode</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">$mode</span>
      <span class="l-Scalar-Plain">overwrite</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">if-missing</span>
      <span class="l-Scalar-Plain">src_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">files/automate/bgpautoinf.py</span>
    <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="s">&quot;Copy</span><span class="nv"> </span><span class="s">automate</span><span class="nv"> </span><span class="s">BGP</span><span class="nv"> </span><span class="s">script</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">node&quot;</span>
    <span class="l-Scalar-Plain">onstart</span><span class="p-Indicator">:</span> <span class="s">&quot;Starting</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">action</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">copy</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">BGP</span><span class="nv"> </span><span class="s">script&quot;</span>
    <span class="l-Scalar-Plain">onsuccess</span><span class="p-Indicator">:</span> <span class="s">&quot;SUCCESS:</span><span class="nv"> </span><span class="s">The</span><span class="nv"> </span><span class="s">BGP</span><span class="nv"> </span><span class="s">script</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">been</span><span class="nv"> </span><span class="s">copied&quot;</span>
    <span class="l-Scalar-Plain">onfailure</span><span class="p-Indicator">:</span> <span class="s">&quot;ERROR:</span><span class="nv"> </span><span class="s">Failed</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">copy</span><span class="nv"> </span><span class="s">script</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">contact</span><span class="nv"> </span><span class="s">admin@example.com&quot;</span>
<span class="l-Scalar-Plain">attributes</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">dst</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/mnt/flash</span>
  <span class="l-Scalar-Plain">mode</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">777</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3>Explanation<a class="headerlink" href="#id7" title="Permalink to this headline">Â¶</a></h3>
<p>Here we make use of three specific keywords: <tt class="docutils literal"><span class="pre">onstart</span></tt>, <tt class="docutils literal"><span class="pre">onsuccess</span></tt> and
<tt class="docutils literal"><span class="pre">onfailure</span></tt>. By adding these keys to your definition, the node will generate
this message while it is being provisioned. As mentioned above, this message will
be sent to all of the logging destinations defined in <tt class="docutils literal"><span class="pre">[data_root]/bootstrap/bootstrap.conf</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For help defining an XMPP or syslog endpoint, see <a class="reference internal" href="clientLogging.html#client-logging-label"><em>Client-Side Logging</em></a></p>
</div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="actions.html" class="btn btn-neutral float-right" title="Actions"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="topologyValidation.html" class="btn btn-neutral" title="Topology Validation"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Arista Networks.
      Last updated on Oct 13, 2015.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>