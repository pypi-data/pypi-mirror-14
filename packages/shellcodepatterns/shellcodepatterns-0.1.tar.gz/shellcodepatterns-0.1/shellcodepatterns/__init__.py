import binascii
import re
import os


patterns = {
	"""Shellsploit
		-> Windows
			-> WinExec
		""":"31c9b957696e45eb0431c9eb0031c031db31d231ff31f6648b7b308b7f0c8b7f1c8b47088b77208b3f807e0c3375f289c703783c8b577801c28b7a2001c789dd81f957696e45753b8b34af01c645390e75f68b7a2401c7668b2c6f8b7a1c01c78b7caffc01c789d9b1ff53e2fd\S+89e2415152ffd7e886ffffff8b34af01c645813e4578697475f2817e0450726f6375e98b7a2401c7668b2c6f8b7a1c01c78b7caffc01c731c951ffd",

	"""Shellsploit
		-> Windows 
			-> Messagebox

		""":"33c9648b49308b490c8b491c8b59088b41208b0980780c3375f28beb036d3c8b6d7803eb8b452003c333d28b349003f342813e4765745075f2817e04726f634175e98b752403f3668b14568b751c03f38b7496fc03f333ff576861727941684c696272684c6f61645453ffd633c95766b9333251687573657254ffd057686f784101fe4c24036861676542684d6573735450ffd657\S+8bcc57575157ffd0576865737301fe4c24036850726f6368457869745453ffd657ffd0",

	"""Veil-Ordnance Payload
	-> Windows
		-> X0R encoder
				""":"eb185e8d3e31c031db8a1c0680fb\S+740e80f3\S+881f4740ebefe8e3ffffff",
}

def searchShell( filename):
	if os.path.isfile( filename):
		return [x for x in patterns if re.findall(patterns[x], (binascii.hexlify(open(filename, 'rb').read())))] 


